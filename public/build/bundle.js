var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(e)}function r(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(e,n,i){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const i=e.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}(n,i))}function a(t,e,n){return t.set(n),e}function h(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function d(){return p(" ")}function f(){return p("")}function m(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function _(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t){return""===t?null:+t}function v(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function y(t,e){t.value=null==e?"":e}let T;function E(t){T=t}function b(){if(!T)throw new Error("Function called outside component initialization");return T}function x(t){b().$$.before_update.push(t)}function A(t){b().$$.on_mount.push(t)}const S=[],w=[],R=[],C=[],O=Promise.resolve();let I=!1;function P(t){R.push(t)}function N(t){C.push(t)}const M=new Set;let D=0;function L(){const t=T;do{for(;D<S.length;){const t=S[D];D++,E(t),F(t.$$)}for(E(null),S.length=0,D=0;w.length;)w.pop()();for(let t=0;t<R.length;t+=1){const e=R[t];M.has(e)||(M.add(e),e())}R.length=0}while(S.length);for(;C.length;)C.pop()();I=!1,M.clear(),E(t)}function F(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(P)}}const U=new Set;let G;function B(){G={r:0,c:[],p:G}}function k(){G.r||i(G.c),G=G.p}function V(t,e){t&&t.i&&(U.delete(t),t.i(e))}function X(t,e,n,i){if(t&&t.o){if(U.has(t))return;U.add(t),G.c.push((()=>{U.delete(t),i&&(n&&t.d(1),i())})),t.o(e)}}function j(t,e,n){const i=t.$$.props[e];void 0!==i&&(t.$$.bound[i]=n,n(t.$$.ctx[i]))}function H(t){t&&t.c()}function $(t,n,s,o){const{fragment:a,on_mount:h,on_destroy:u,after_update:l}=t.$$;a&&a.m(n,s),o||P((()=>{const n=h.map(e).filter(r);u?u.push(...n):i(n),t.$$.on_mount=[]})),l.forEach(P)}function Y(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function W(t,e){-1===t.$$.dirty[0]&&(S.push(t),I||(I=!0,O.then(L)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function z(e,r,s,o,a,h,u,c=[-1]){const p=T;E(e);const d=e.$$={fragment:null,ctx:null,props:h,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(p?p.$$.context:[])),callbacks:n(),dirty:c,skip_bound:!1,root:r.target||p.$$.root};u&&u(d.root);let f=!1;if(d.ctx=s?s(e,r.props||{},((t,n,...i)=>{const r=i.length?i[0]:n;return d.ctx&&a(d.ctx[t],d.ctx[t]=r)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](r),f&&W(e,t)),n})):[],d.update(),f=!0,i(d.before_update),d.fragment=!!o&&o(d.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);d.fragment&&d.fragment.l(t),t.forEach(l)}else d.fragment&&d.fragment.c();r.intro&&V(e.$$.fragment),$(e,r.target,r.anchor,r.customElement),L()}E(p)}class q{$destroy(){Y(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var Z,K;!function(t){t.NONE="NONE",t.CONNECT_CHAT="CONNECT_CHAT",t.MAIN_MENU="MAIN_MENU",t.INTRO="INTRO",t.SETTINGS="SETTINGS",t.ABOUT="ABOUT",t.CREDITS="CREDITS",t.GAME="GAME"}(Z||(Z={})),function(t){t.CONNECT_CHAT="CONNECT_CHAT",t.DISCONNECT_CHAT="DISCONNECT_CHAT",t.NEW_CLEAVAGE="NEW_CLEAVAGE",t.LAUNCH_CLEAVAGE="LAUNCH_CLEAVAGE",t.PLAYER_CLEAVE="PLAYER_CLEAVE",t.PLAYER_MESSAGE="PLAYER_MESSAGE",t.DRAW_CLEAVAGE="DRAW_CLEAVAGE",t.PLAYER_SUGGEST_CLEAVAGE="SUGGEST_CLEAVAGE",t.PLAYER_ASK_FOR_HELP="PLAYER_ASK_FOR_HELP",t.CANCEL_CLEAVAGE="CANCEL_CLEAVAGE",t.PLAYER_HYPERLIKE="PLAYER_HYPERLIKE",t.PLAYER_APPLAUSE="PLAYER_APPLAUSE",t.PLAYER_SHOOT="PLAYER_SHOOT",t.PLAYER_WHISTLE="PLAYER_WHISTLE",t.APPLICATION_START="APPLICATION_START",t.NAVIGATE="NAVIGATE",t.CHANGE_MUSIC_VOLUME="CHANGE_MUSIC_VOLUME",t.CHANGE_SOUND_VOLUME="CHANGE_SOUND_VOLUME",t.PLAYER_QUIT="PLAYER_QUIT",t.START_AUTOPLAY="START_AUTOPLAY",t.CHECK_AUTOPLAY="CHECK_AUTOPLAY",t.STOP_AUTOPLAY="STOP_AUTOPLAY",t.DRAW_GLOBAL_CLEAVAGE_DRAWPILE="DRAW_GLOBAL_CLEAVAGE_DRAWPILE",t.SAVE_CLEAVAGE_ON_GLOBAL_CLEAVAGE_DRAWPILE="SAVE_CLEAVAGE_ON_GLOBAL_CLEAVAGE_DRAWPILE",t.PLAYER_JOIN_BAR="PLAYER_JOIN_BAR",t.PLAYER_MOVE="PLAYER_MOVE",t.INSTALL_NEW_TABLE="INSTALL_NEW_TABLE",t.INSTALL_NEW_STOOLS_ON_TABLE="INSTALL_NEW_STOOLS_ON_TABLE",t.TABLE_STOOL_AVAILABLE="TABLE_STOOL_AVAILABLE",t.CREATE_BAR="CREATE_BAR",t.DRAW="DRAW",t.INSTALL_NEW_STOOLS_ON_BAR="INSTALL_NEW_STOOLS_ON_BAR",t.CHANGE_GAME_PHASE="CHANGE_GAME_PHASE",t.VIDEO_EXTRACT_START="VIDEO_EXTRACT_START",t.VIDEO_EXTRACT_STOP="VIDEO_EXTRACT_STOP",t.CHANGE_VIDEO_EXTRACT_VOLUME="CHANGE_VIDEO_EXTRACT_VOLUME"}(K||(K={}));class J{}class Q extends J{constructor(t,e,n){super(),this.username=t,this.token=e,this.channel=n,this.eventType=K.CONNECT_CHAT}}class tt extends J{constructor(t){super(),this.targetView=t,this.eventType=K.NAVIGATE}}function et(e){let n,i,s,o,a;return{c(){n=c("button"),i=p(e[1]),_(n,"class",s=("large"===e[2]?"text-2xl":"text")+" "+(e[3]?"w-full":"")+" p-2 m-2 "+(e[4]<33?"":e[4]<66?"rotate-3":"-rotate-3")+" bg-dark-background text-no-emphasis font-sans border-2 rounded-xl border-medium-emphasis active:border-low-emphasis focus:border-low-emphasis"),_(n,"type","button")},m(t,s){u(t,n,s),h(n,i),o||(a=m(n,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(t,[r]){e=t,2&r&&v(i,e[1]),12&r&&s!==(s=("large"===e[2]?"text-2xl":"text")+" "+(e[3]?"w-full":"")+" p-2 m-2 "+(e[4]<33?"":e[4]<66?"rotate-3":"-rotate-3")+" bg-dark-background text-no-emphasis font-sans border-2 rounded-xl border-medium-emphasis active:border-low-emphasis focus:border-low-emphasis")&&_(n,"class",s)},i:t,o:t,d(t){t&&l(n),o=!1,a()}}}function nt(t,e,n){let{onClick:i}=e,{text:r}=e,{size:s="medium"}=e,{wfull:o=!1}=e;const a=100*Math.random();return t.$$set=t=>{"onClick"in t&&n(0,i=t.onClick),"text"in t&&n(1,r=t.text),"size"in t&&n(2,s=t.size),"wfull"in t&&n(3,o=t.wfull)},[i,r,s,o,a]}class it extends q{constructor(t){super(),z(this,t,nt,et,s,{onClick:0,text:1,size:2,wfull:3})}}function rt(t){let e,n,i,r,s;return{c(){e=c("input"),_(e,"class",n="p-1 "+(t[5]?"m-5 text-2xl":"m-5 text-xl")+" "+(t[7]<33?"":t[7]<66?"rotate-3":"-rotate-3")+" rounded-xl border-low-emphasis focus:border-medium-emphasis focus:ring-1 focus:ring-medium-emphasis text-no-emphasis placeholder-no-emphasis border-2 bg-dark-background font-sans text-center"),_(e,"type","password"),_(e,"id",t[3]),_(e,"name",t[4]),e.required=!0,_(e,"placeholder",t[2]),_(e,"autocomplete",i="password"===t[1]?"new-password":null)},m(n,i){u(n,e,i),y(e,t[0]),r||(s=m(e,"input",t[10]),r=!0)},p(t,r){32&r&&n!==(n="p-1 "+(t[5]?"m-5 text-2xl":"m-5 text-xl")+" "+(t[7]<33?"":t[7]<66?"rotate-3":"-rotate-3")+" rounded-xl border-low-emphasis focus:border-medium-emphasis focus:ring-1 focus:ring-medium-emphasis text-no-emphasis placeholder-no-emphasis border-2 bg-dark-background font-sans text-center")&&_(e,"class",n),8&r&&_(e,"id",t[3]),16&r&&_(e,"name",t[4]),4&r&&_(e,"placeholder",t[2]),2&r&&i!==(i="password"===t[1]?"new-password":null)&&_(e,"autocomplete",i),1&r&&e.value!==t[0]&&y(e,t[0])},d(t){t&&l(e),r=!1,s()}}}function st(t){let e,n,i,r;return{c(){e=c("input"),_(e,"class",n="p-1 "+(t[5]?"m-5 text-2xl":"m-5 text-xl")+" "+(t[7]<33?"":t[7]<66?"rotate-3":"-rotate-3")+" rounded-xl border-low-emphasis focus:border-medium-emphasis focus:ring-1 focus:ring-medium-emphasis text-no-emphasis placeholder-no-emphasis border-2 bg-dark-background font-sans text-center"),_(e,"type","text"),_(e,"id",t[3]),_(e,"name",t[4]),e.required=!0,_(e,"placeholder",t[2])},m(n,s){u(n,e,s),y(e,t[0]),i||(r=m(e,"input",t[9]),i=!0)},p(t,i){32&i&&n!==(n="p-1 "+(t[5]?"m-5 text-2xl":"m-5 text-xl")+" "+(t[7]<33?"":t[7]<66?"rotate-3":"-rotate-3")+" rounded-xl border-low-emphasis focus:border-medium-emphasis focus:ring-1 focus:ring-medium-emphasis text-no-emphasis placeholder-no-emphasis border-2 bg-dark-background font-sans text-center")&&_(e,"class",n),8&i&&_(e,"id",t[3]),16&i&&_(e,"name",t[4]),4&i&&_(e,"placeholder",t[2]),1&i&&e.value!==t[0]&&y(e,t[0])},d(t){t&&l(e),i=!1,r()}}}function ot(t){let e,n,i,r;return{c(){e=c("textarea"),_(e,"class",n="p-1 "+(t[5]?"m-5 text-2xl":"m-5 text-xl")+" "+(t[7]<33?"":t[7]<66?"rotate-3":"-rotate-3")+" rounded-xl border-low-emphasis focus:border-medium-emphasis text-no-emphasis placeholder-no-emphasis border-2 bg-dark-background font-sans text-center"),_(e,"id",t[3]),_(e,"name",t[4]),_(e,"rows",t[6]),_(e,"cols",ht),e.required=!0,_(e,"placeholder",t[2]),_(e,"autocomplete","new-password")},m(n,s){u(n,e,s),y(e,t[0]),i||(r=m(e,"input",t[8]),i=!0)},p(t,i){32&i&&n!==(n="p-1 "+(t[5]?"m-5 text-2xl":"m-5 text-xl")+" "+(t[7]<33?"":t[7]<66?"rotate-3":"-rotate-3")+" rounded-xl border-low-emphasis focus:border-medium-emphasis text-no-emphasis placeholder-no-emphasis border-2 bg-dark-background font-sans text-center")&&_(e,"class",n),8&i&&_(e,"id",t[3]),16&i&&_(e,"name",t[4]),64&i&&_(e,"rows",t[6]),4&i&&_(e,"placeholder",t[2]),1&i&&y(e,t[0])},d(t){t&&l(e),i=!1,r()}}}function at(e){let n;function i(t,e){return"textarea"===t[1]?ot:"text"===t[1]?st:"password"===t[1]?rt:void 0}let r=i(e),s=r&&r(e);return{c(){s&&s.c(),n=f()},m(t,e){s&&s.m(t,e),u(t,n,e)},p(t,[e]){r===(r=i(t))&&s?s.p(t,e):(s&&s.d(1),s=r&&r(t),s&&(s.c(),s.m(n.parentNode,n)))},i:t,o:t,d(t){s&&s.d(t),t&&l(n)}}}const ht=30;function ut(t,e,n){let i,{inputValue:r}=e,{type:s="text"}=e,{placeholder:o}=e,{id:a}=e,{name:h}=e,{mainInput:u=!1}=e;const l=100*Math.random();return x((()=>{if("textarea"===s){let t=Math.round(r.length/ht);n(6,i=t<1?1:t)}})),t.$$set=t=>{"inputValue"in t&&n(0,r=t.inputValue),"type"in t&&n(1,s=t.type),"placeholder"in t&&n(2,o=t.placeholder),"id"in t&&n(3,a=t.id),"name"in t&&n(4,h=t.name),"mainInput"in t&&n(5,u=t.mainInput)},[r,s,o,a,h,u,i,l,function(){r=this.value,n(0,r)},function(){r=this.value,n(0,r)},function(){r=this.value,n(0,r)}]}class lt extends q{constructor(t){super(),z(this,t,ut,at,s,{inputValue:0,type:1,placeholder:2,id:3,name:4,mainInput:5})}}function ct(t){let e,n;return{c(){e=c("a"),n=p(t[0]),_(e,"class","text-center font-sans underline text-low-emphasis hover:text-medium-emphasis visited:text-low-emphasis "+(t[3]<33?"":t[3]<66?"rotate-3":"-rotate-3")),_(e,"href",t[1])},m(t,i){u(t,e,i),h(e,n)},p(t,i){1&i&&v(n,t[0]),2&i&&_(e,"href",t[1])},d(t){t&&l(e)}}}function pt(t){let e,n;return{c(){e=c("a"),n=p(t[0]),_(e,"class","text-center font-sans underline text-low-emphasis hover:text-medium-emphasis visited:text-low-emphasis "+(t[3]<33?"":t[3]<66?"rotate-3":"-rotate-3")),_(e,"href",t[1]),_(e,"target","_blank")},m(t,i){u(t,e,i),h(e,n)},p(t,i){1&i&&v(n,t[0]),2&i&&_(e,"href",t[1])},d(t){t&&l(e)}}}function dt(e){let n;function i(t,e){return t[2]?pt:ct}let r=i(e),s=r(e);return{c(){s.c(),n=f()},m(t,e){s.m(t,e),u(t,n,e)},p(t,[e]){r===(r=i(t))&&s?s.p(t,e):(s.d(1),s=r(t),s&&(s.c(),s.m(n.parentNode,n)))},i:t,o:t,d(t){s.d(t),t&&l(n)}}}function ft(t,e,n){let{text:i}=e,{href:r}=e,{newTab:s=!1}=e;const o=100*Math.random();return t.$$set=t=>{"text"in t&&n(0,i=t.text),"href"in t&&n(1,r=t.href),"newTab"in t&&n(2,s=t.newTab)},[i,r,s,o]}class mt extends q{constructor(t){super(),z(this,t,ft,dt,s,{text:0,href:1,newTab:2})}}function _t(e){let n,i=e[0].replaceAll("\n","<br>")+"";return{c(){n=c("h2"),_(n,"class","my-3 "+(e[1]<33?"":e[1]<66?"rotate-3":"-rotate-3")+" text-xl font-sans text-center text-medium-emphasis")},m(t,e){u(t,n,e),n.innerHTML=i},p(t,[e]){1&e&&i!==(i=t[0].replaceAll("\n","<br>")+"")&&(n.innerHTML=i)},i:t,o:t,d(t){t&&l(n)}}}function gt(t,e,n){let{subtitle:i=""}=e;const r=100*Math.random();return t.$$set=t=>{"subtitle"in t&&n(0,i=t.subtitle)},[i,r]}class vt extends q{constructor(t){super(),z(this,t,gt,_t,s,{subtitle:0})}}function yt(e){let n,i;return{c(){n=c("h1"),i=p(e[0]),_(n,"class","my-3 "+(e[1]<33?"":e[1]<66?"rotate-3":"-rotate-3")+" text-center text-6xl break-all font-sans font-bold text-high-emphasis")},m(t,e){u(t,n,e),h(n,i)},p(t,[e]){1&e&&v(i,t[0])},i:t,o:t,d(t){t&&l(n)}}}function Tt(t,e,n){let{title:i="Le jeu du clivage"}=e,{rotate:r=!0}=e;const s=r?100*Math.random():0;return t.$$set=t=>{"title"in t&&n(0,i=t.title),"rotate"in t&&n(2,r=t.rotate)},[i,s,r]}class Et extends q{constructor(t){super(),z(this,t,Tt,yt,s,{title:0,rotate:2})}}const bt=[];function xt(e,n=t){let i;const r=new Set;function o(t){if(s(e,t)&&(e=t,i)){const t=!bt.length;for(const t of r)t[1](),bt.push(t,e);if(t){for(let t=0;t<bt.length;t+=2)bt[t][0](bt[t+1]);bt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const h=[s,a];return r.add(h),1===r.size&&(i=n(o)||t),s(e),()=>{r.delete(h),0===r.size&&(i(),i=null)}}}}var At;!function(t){t.CLEAVING="CLEAVING",t.NEW_CLEAVAGE="NEW_CLEAVAGE",t.NONE="NONE",t.PLAY_VIDEO="PLAY_VIDEO"}(At||(At={}));const St=xt(void 0),wt=xt(void 0),Rt=xt(Z.NONE),Ct=xt(100),Ot=xt(100),It=xt(!1),Pt=xt(At.NONE),Nt=xt(void 0),Mt=xt(100);function Dt(t){let e,n;return e=new it({props:{text:"Connexion Twitch !",onClick:t[6]}}),{c(){H(e.$$.fragment)},m(t,i){$(e,t,i),n=!0},p(t,n){const i={};7&n&&(i.onClick=t[6]),e.$set(i)},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){X(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Lt(t){let e,n,i,r,s,o,a,p,f,m,g,v,y,T,E,b,x,A,S,R,C,O;function I(e){t[3](e)}i=new Et({}),s=new vt({props:{subtitle:"Connectes-toi sur ta chaine Twitch pour faire participer tes viewers !!!"}});let P={id:"user",name:"user",placeholder:"Utilisateur Twitch"};function M(e){t[4](e)}void 0!==t[0]&&(P.inputValue=t[0]),f=new lt({props:P}),w.push((()=>j(f,"inputValue",I)));let D={id:"password",name:"password",placeholder:"Token Twitch",type:"password"};function L(e){t[5](e)}void 0!==t[1]&&(D.inputValue=t[1]),v=new lt({props:D}),w.push((()=>j(v,"inputValue",M)));let F={id:"channel",name:"channel",placeholder:"Chaine Twitch"};void 0!==t[2]&&(F.inputValue=t[2]),E=new lt({props:F}),w.push((()=>j(E,"inputValue",L)));let U=t[0]&&t[1]&&t[2]&&Dt(t);return S=new it({props:{text:"Menu principal",onClick:t[7]}}),C=new mt({props:{text:"Twitch Token Generator",href:"https://twitchapps.com/tmi/",newTab:!0}}),{c(){e=c("main"),n=c("div"),H(i.$$.fragment),r=d(),H(s.$$.fragment),o=d(),a=c("div"),p=c("div"),H(f.$$.fragment),g=d(),H(v.$$.fragment),T=d(),H(E.$$.fragment),x=d(),U&&U.c(),A=d(),H(S.$$.fragment),R=d(),H(C.$$.fragment),_(n,"class","flex flex-col w-full items-center"),_(p,"class","flex flex-col items-center"),_(a,"class","flex flex-row w-full place-items-center justify-center"),_(e,"class","bg-dark-background h-full w-full flex flex-col justify-evenly")},m(t,l){u(t,e,l),h(e,n),$(i,n,null),h(n,r),$(s,n,null),h(e,o),h(e,a),h(a,p),$(f,p,null),h(p,g),$(v,p,null),h(p,T),$(E,p,null),h(p,x),U&&U.m(p,null),h(p,A),$(S,p,null),h(a,R),$(C,a,null),O=!0},p(t,[e]){const n={};!m&&1&e&&(m=!0,n.inputValue=t[0],N((()=>m=!1))),f.$set(n);const i={};!y&&2&e&&(y=!0,i.inputValue=t[1],N((()=>y=!1))),v.$set(i);const r={};!b&&4&e&&(b=!0,r.inputValue=t[2],N((()=>b=!1))),E.$set(r),t[0]&&t[1]&&t[2]?U?(U.p(t,e),7&e&&V(U,1)):(U=Dt(t),U.c(),V(U,1),U.m(p,A)):U&&(B(),X(U,1,1,(()=>{U=null})),k())},i(t){O||(V(i.$$.fragment,t),V(s.$$.fragment,t),V(f.$$.fragment,t),V(v.$$.fragment,t),V(E.$$.fragment,t),V(U),V(S.$$.fragment,t),V(C.$$.fragment,t),O=!0)},o(t){X(i.$$.fragment,t),X(s.$$.fragment,t),X(f.$$.fragment,t),X(v.$$.fragment,t),X(E.$$.fragment,t),X(U),X(S.$$.fragment,t),X(C.$$.fragment,t),O=!1},d(t){t&&l(e),Y(i),Y(s),Y(f),Y(v),Y(E),U&&U.d(),Y(S),Y(C)}}}function Ft(t,e,n){let i="",r="",s="";return[i,r,s,function(t){i=t,n(0,i)},function(t){r=t,n(1,r)},function(t){s=t,n(2,s)},()=>St.set(new Q(i,r,s)),()=>St.set(new tt(Z.MAIN_MENU))]}class Ut extends q{constructor(t){super(),z(this,t,Ft,Lt,s,{})}}function Gt(e){let n,i;return{c(){n=c("p"),_(n,"class",i="font-sans text-low-emphasis "+(e[1]?"text-center":"text-justify")+" w-full md:w-2/3 lg:w-1/2 "+(e[2]<33?"":e[2]<66?"rotate-1":"-rotate-1")+" p-3")},m(t,i){u(t,n,i),n.innerHTML=e[0]},p(t,[e]){1&e&&(n.innerHTML=t[0]),2&e&&i!==(i="font-sans text-low-emphasis "+(t[1]?"text-center":"text-justify")+" w-full md:w-2/3 lg:w-1/2 "+(t[2]<33?"":t[2]<66?"rotate-1":"-rotate-1")+" p-3")&&_(n,"class",i)},i:t,o:t,d(t){t&&l(n)}}}function Bt(t,e,n){let{text:i}=e,{center:r=!1}=e;const s=100*Math.random();return t.$$set=t=>{"text"in t&&n(0,i=t.text),"center"in t&&n(1,r=t.center)},[i,r,s]}class kt extends q{constructor(t){super(),z(this,t,Bt,Gt,s,{text:0,center:1})}}function Vt(e){let n,i,r,s,o,a,p,f,m,g,v,y,T,E,b,x,A,S,w,R,C,O;return r=new Et({}),o=new vt({props:{subtitle:"A propos"}}),f=new kt({props:{text:e[0]}}),g=new kt({props:{text:e[1],center:!0}}),y=new mt({props:{text:"GitHub",href:"https://github.com/Sometimes-Useful/the-cleavage-game",newTab:!0}}),E=new mt({props:{text:"Replay du dev",href:"https://youtube.com/playlist?list=PL4jAusJfrmMsRWjFhgjZXcPnEZdkUnLGc",newTab:!0}}),x=new mt({props:{text:"Chaine Twitch pour le live",href:"https://www.twitch.tv/benjaminbohec",newTab:!0}}),S=new kt({props:{text:e[2],center:!0}}),C=new it({props:{onClick:e[3],text:"Menu Principal!"}}),{c(){n=c("main"),i=c("div"),H(r.$$.fragment),s=d(),H(o.$$.fragment),a=d(),p=c("div"),H(f.$$.fragment),m=d(),H(g.$$.fragment),v=d(),H(y.$$.fragment),T=d(),H(E.$$.fragment),b=d(),H(x.$$.fragment),A=d(),H(S.$$.fragment),w=d(),R=c("div"),H(C.$$.fragment),_(i,"class","flex flex-col w-full items-center"),_(p,"class","flex flex-col w-full items-center"),_(R,"class","flex flex-col w-full items-center"),_(n,"class","bg-dark-background h-full w-full flex flex-col justify-evenly")},m(t,e){u(t,n,e),h(n,i),$(r,i,null),h(i,s),$(o,i,null),h(n,a),h(n,p),$(f,p,null),h(p,m),$(g,p,null),h(p,v),$(y,p,null),h(p,T),$(E,p,null),h(p,b),$(x,p,null),h(p,A),$(S,p,null),h(n,w),h(n,R),$(C,R,null),O=!0},p:t,i(t){O||(V(r.$$.fragment,t),V(o.$$.fragment,t),V(f.$$.fragment,t),V(g.$$.fragment,t),V(y.$$.fragment,t),V(E.$$.fragment,t),V(x.$$.fragment,t),V(S.$$.fragment,t),V(C.$$.fragment,t),O=!0)},o(t){X(r.$$.fragment,t),X(o.$$.fragment,t),X(f.$$.fragment,t),X(g.$$.fragment,t),X(y.$$.fragment,t),X(E.$$.fragment,t),X(x.$$.fragment,t),X(S.$$.fragment,t),X(C.$$.fragment,t),O=!1},d(t){t&&l(n),Y(r),Y(o),Y(f),Y(g),Y(y),Y(E),Y(x),Y(S),Y(C)}}}function Xt(t){return["Le jeu du clivage est un jeu qui permet aux joueurs de cliver sur un sujet choisi par le maitre du jeu.\n    Le joueur doit choisir si le sujet est de gauche ou de droite.\n    Le joueur peut aussi proposer au maitre du jeu de nouveaux clivages et participer dans le débat (applaudir, huer,...)","Le jeu du clivage est un projet open source et gratuit.","Nous avons besoin de votre soutient pour pouvoir passer plus de temps au développement du jeu. Hésitez pas à nous contacter à l'addresse bbohec.pro[AT]gmail.com si vous souhaitez nous aider.",()=>St.set(new tt(Z.MAIN_MENU))]}class jt extends q{constructor(t){super(),z(this,t,Xt,Vt,s,{})}}class Ht extends J{constructor(){super(...arguments),this.eventType=K.DISCONNECT_CHAT}}class $t extends J{constructor(){super(...arguments),this.eventType=K.NEW_CLEAVAGE}}function Yt(e){let n,i,r,s,o,a,p,f,m,g,v,y,T,E,b;return r=new Et({}),o=new vt({props:{subtitle:"El famoso!\n        Le jeu du clivage où on décide ENFIN si quelque chose est finalement de gauche ou de droite.\n        Un super jeu politique pour fight entre amis ou en famille. Attention, mamie c'est le boss final...\n        Version streamer!\n        Tellement digital! Tellement handspinner! Le plaisir.\n        Parfait pour préparer l'élection présidentielle de 2022 ou quand on s'emmerde...\n        94.99$ seulement! Wouah!"}}),f=new it({props:{text:"Jouer !",size:"large",onClick:e[0]}}),g=new it({props:{text:"Options !",size:"large",onClick:e[1]}}),y=new it({props:{text:"Credits !",size:"large",onClick:e[2]}}),E=new it({props:{text:"A propos !",size:"large",onClick:e[3]}}),{c(){n=c("main"),i=c("div"),H(r.$$.fragment),s=d(),H(o.$$.fragment),a=d(),p=c("div"),H(f.$$.fragment),m=d(),H(g.$$.fragment),v=d(),H(y.$$.fragment),T=d(),H(E.$$.fragment),_(i,"class","flex flex-col items-center"),_(p,"class","flex flex-col items-center"),_(n,"class","bg-dark-background h-full w-full flex flex-col justify-evenly")},m(t,e){u(t,n,e),h(n,i),$(r,i,null),h(i,s),$(o,i,null),h(n,a),h(n,p),$(f,p,null),h(p,m),$(g,p,null),h(p,v),$(y,p,null),h(p,T),$(E,p,null),b=!0},p:t,i(t){b||(V(r.$$.fragment,t),V(o.$$.fragment,t),V(f.$$.fragment,t),V(g.$$.fragment,t),V(y.$$.fragment,t),V(E.$$.fragment,t),b=!0)},o(t){X(r.$$.fragment,t),X(o.$$.fragment,t),X(f.$$.fragment,t),X(g.$$.fragment,t),X(y.$$.fragment,t),X(E.$$.fragment,t),b=!1},d(t){t&&l(n),Y(r),Y(o),Y(f),Y(g),Y(y),Y(E)}}}function Wt(t){return[()=>St.set(new $t),()=>St.set(new tt(Z.SETTINGS)),()=>St.set(new tt(Z.CREDITS)),()=>St.set(new tt(Z.ABOUT))]}class zt extends q{constructor(t){super(),z(this,t,Wt,Yt,s,{})}}class qt extends J{constructor(t){super(),this.volume=t,this.eventType=K.CHANGE_MUSIC_VOLUME}}class Zt extends J{constructor(t){super(),this.volume=t,this.eventType=K.CHANGE_SOUND_VOLUME}}class Kt extends J{constructor(t){super(),this.volume=t,this.eventType=K.CHANGE_VIDEO_EXTRACT_VOLUME}}function Jt(e){let n,i,s,o,a,f,g,y,T;return{c(){n=c("div"),i=c("label"),s=p(e[1]),o=p(" - "),a=p(e[6]),f=d(),g=c("input"),_(i,"for",e[0]),_(i,"class","form-label text-low-emphasis font-sans mb-2"),_(g,"type","range"),_(g,"class","form-range appearance-none border-2 rounded-md w-full md:w-1/2 xl:w-1/3 h-1 border-low-emphasis accent-high-emphasis "+(e[7]<33?"":e[7]<66?"rotate-1":"-rotate-1")),g.value=e[6],_(g,"min",e[2]),_(g,"max",e[3]),_(g,"step",e[4]),_(g,"id",e[0]),_(n,"class","flex flex-col w-full items-center p-3")},m(t,l){u(t,n,l),h(n,i),h(i,s),h(i,o),h(i,a),h(n,f),h(n,g),y||(T=m(g,"input",(function(){r(e[5])&&e[5].apply(this,arguments)})),y=!0)},p(t,[n]){e=t,2&n&&v(s,e[1]),64&n&&v(a,e[6]),1&n&&_(i,"for",e[0]),64&n&&(g.value=e[6]),4&n&&_(g,"min",e[2]),8&n&&_(g,"max",e[3]),16&n&&_(g,"step",e[4]),1&n&&_(g,"id",e[0])},i:t,o:t,d(t){t&&l(n),y=!1,T()}}}function Qt(t,e,n){let{id:i}=e,{text:r}=e,{min:s=0}=e,{max:o=100}=e,{step:a=1}=e,{onInput:h}=e,{value:u}=e;const l=100*Math.random();return t.$$set=t=>{"id"in t&&n(0,i=t.id),"text"in t&&n(1,r=t.text),"min"in t&&n(2,s=t.min),"max"in t&&n(3,o=t.max),"step"in t&&n(4,a=t.step),"onInput"in t&&n(5,h=t.onInput),"value"in t&&n(6,u=t.value)},[i,r,s,o,a,h,u,l]}class te extends q{constructor(t){super(),z(this,t,Qt,Jt,s,{id:0,text:1,min:2,max:3,step:4,onInput:5,value:6})}}function ee(t){let e,n,i,r,s,o,a,p,f,m,g,v,y,T,E,b;return i=new Et({}),s=new vt({props:{subtitle:"Options"}}),p=new te({props:{id:"musicVolume",text:"Volume - Musique",onInput:t[3],value:t[1]}}),m=new te({props:{id:"videoExtractVolume",text:"Volume - Extraits Vidéos",onInput:t[5],value:t[2]}}),v=new te({props:{id:"soundVolume",text:"Volume - Sons",onInput:t[4],value:t[0]}}),E=new it({props:{onClick:t[6],text:"Menu Principal!"}}),{c(){e=c("main"),n=c("div"),H(i.$$.fragment),r=d(),H(s.$$.fragment),o=d(),a=c("div"),H(p.$$.fragment),f=d(),H(m.$$.fragment),g=d(),H(v.$$.fragment),y=d(),T=c("div"),H(E.$$.fragment),_(n,"class","flex flex-col w-full items-center"),_(a,"class","flex flex-col w-full items-center"),_(T,"class","flex flex-col w-full items-center"),_(e,"class","bg-dark-background h-full w-full flex flex-col justify-evenly")},m(t,l){u(t,e,l),h(e,n),$(i,n,null),h(n,r),$(s,n,null),h(e,o),h(e,a),$(p,a,null),h(a,f),$(m,a,null),h(a,g),$(v,a,null),h(e,y),h(e,T),$(E,T,null),b=!0},p(t,[e]){const n={};2&e&&(n.value=t[1]),p.$set(n);const i={};4&e&&(i.value=t[2]),m.$set(i);const r={};1&e&&(r.value=t[0]),v.$set(r)},i(t){b||(V(i.$$.fragment,t),V(s.$$.fragment,t),V(p.$$.fragment,t),V(m.$$.fragment,t),V(v.$$.fragment,t),V(E.$$.fragment,t),b=!0)},o(t){X(i.$$.fragment,t),X(s.$$.fragment,t),X(p.$$.fragment,t),X(m.$$.fragment,t),X(v.$$.fragment,t),X(E.$$.fragment,t),b=!1},d(t){t&&l(e),Y(i),Y(s),Y(p),Y(m),Y(v),Y(E)}}}function ne(t,e,n){let i,r,s;Ot.subscribe((t=>n(0,i=t))),Ct.subscribe((t=>n(1,r=t))),Mt.subscribe((t=>n(2,s=t)));return[i,r,s,t=>St.set(new qt(parseInt(t.currentTarget.value))),t=>St.set(new Zt(parseInt(t.currentTarget.value))),t=>St.set(new Kt(parseInt(t.currentTarget.value))),()=>St.set(new tt(Z.MAIN_MENU))]}class ie extends q{constructor(t){super(),z(this,t,ne,ee,s,{})}}const re="14.7.77";var se="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function oe(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})})),e}var ae,he={exports:{}},ue={exports:{}},le={exports:{}};(ae=le).exports=function(t){if(Array.isArray(t))return t},ae.exports.__esModule=!0,ae.exports.default=ae.exports;var ce={exports:{}};!function(t){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s=[],o=!0,a=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(s.push(i.value),!e||s.length!==e);o=!0);}catch(t){a=!0,r=t}finally{try{o||null==n.return||n.return()}finally{if(a)throw r}}return s}},t.exports.__esModule=!0,t.exports.default=t.exports}(ce);var pe={exports:{}},de={exports:{}};!function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports}(de),function(t){var e=de.exports;t.exports=function(t,n){if(t){if("string"==typeof t)return e(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}(pe);var fe={exports:{}};!function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports}(fe),function(t){var e=le.exports,n=ce.exports,i=pe.exports,r=fe.exports;t.exports=function(t,s){return e(t)||n(t,s)||i(t,s)||r()},t.exports.__esModule=!0,t.exports.default=t.exports}(ue);var me={exports:{}};!function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports}(me);var _e={exports:{}};!function(t){function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports}(_e),function(t,e,n,i){function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var s=r(e),o=r(n),a=r(i),h=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},u=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},l=function(t,e){return{startTime:e,type:"setValue",value:t}},c=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},p=function(t,e,n){var i=n.startTime,r=n.target,s=n.timeConstant;return r+(e-r)*Math.exp((i-t)/s)},d=function(t){return"exponentialRampToValue"===t.type},f=function(t){return"linearRampToValue"===t.type},m=function(t){return d(t)||f(t)},_=function(t){return"setValue"===t.type},g=function(t){return"setValueCurve"===t.type},v=function t(e,n,i,r){var s=e[n];return void 0===s?r:m(s)||_(s)?s.value:g(s)?s.values[s.values.length-1]:p(i,t(e,n-1,s.startTime,r),s)},y=function(t,e,n,i,r){return void 0===n?[i.insertTime,r]:m(n)?[n.endTime,n.value]:_(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,v(t,e-1,n.startTime,r)]},T=function(t){return"cancelAndHold"===t.type},E=function(t){return"cancelScheduledValues"===t.type},b=function(t){return T(t)||E(t)?t.cancelTime:d(t)||f(t)?t.endTime:t.startTime},x=function(t,e,n,i){var r=i.endTime,s=i.value;return n===s?s:0<n&&0<s||n<0&&s<0?n*Math.pow(s/n,(t-e)/(r-e)):0},A=function(t,e,n,i){return n+(t-e)/(i.endTime-e)*(i.value-n)},S=function(t,e){var n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]},w=function(t,e){var n=e.duration,i=e.startTime,r=e.values,s=(t-i)/n*(r.length-1);return S(r,s)},R=function(t){return"setTarget"===t.type},C=function(t){function e(t){o.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return a.default(e,[{key:t,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=b(t);if(T(t)||E(t)){var n=this._automationEvents.findIndex((function(n){return E(t)&&g(n)?n.startTime+n.duration>=e:b(n)>=e})),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),T(t)){var r=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&m(i)){if(R(r))throw new Error("The internal list is malformed.");var s=g(r)?r.startTime+r.duration:b(r),o=g(r)?r.values[r.values.length-1]:r.value,a=d(i)?x(e,s,o,i):A(e,s,o,i),p=d(i)?h(a,e,this._currenTime):u(a,e,this._currenTime);this._automationEvents.push(p)}void 0!==r&&R(r)&&this._automationEvents.push(l(this.getValue(e),e)),void 0!==r&&g(r)&&r.startTime+r.duration>e&&(this._automationEvents[this._automationEvents.length-1]=c(new Float32Array([6,7]),r.startTime,e-r.startTime))}}else{var _=this._automationEvents.findIndex((function(t){return b(t)>e})),v=-1===_?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[_-1];if(void 0!==v&&g(v)&&b(v)+v.duration>e)return!1;var y=d(t)?h(t.value,t.endTime,this._currenTime):f(t)?u(t.value,e,this._currenTime):t;if(-1===_)this._automationEvents.push(y);else{if(g(t)&&e+t.duration>b(this._automationEvents[_]))return!1;this._automationEvents.splice(_,0,y)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return b(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),i=n[0];R(i)&&n.unshift(l(v(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents.findIndex((function(e){return b(e)>t})),n=this._automationEvents[e],i=(-1===e?this._automationEvents.length:e)-1,r=this._automationEvents[i];if(void 0!==r&&R(r)&&(void 0===n||!m(n)||n.insertTime>t))return p(t,v(this._automationEvents,i-1,r.startTime,this._defaultValue),r);if(void 0!==r&&_(r)&&(void 0===n||!m(n)))return r.value;if(void 0!==r&&g(r)&&(void 0===n||!m(n)||r.startTime+r.duration>t))return t<r.startTime+r.duration?w(t,r):r.values[r.values.length-1];if(void 0!==r&&m(r)&&(void 0===n||!m(n)))return r.value;if(void 0!==n&&d(n)){var o=y(this._automationEvents,i,r,n,this._defaultValue),a=s.default(o,2),h=a[0],u=a[1];return x(t,h,u,n)}if(void 0!==n&&f(n)){var l=y(this._automationEvents,i,r,n,this._defaultValue),c=s.default(l,2),T=c[0],E=c[1];return A(t,T,E,n)}return this._defaultValue}}]),e}(Symbol.iterator),O=function(t){return{cancelTime:t,type:"cancelAndHold"}},I=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},P=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},N=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},M=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}};t.AutomationEventList=C,t.createCancelAndHoldAutomationEvent=O,t.createCancelScheduledValuesAutomationEvent=I,t.createExponentialRampToValueAutomationEvent=P,t.createLinearRampToValueAutomationEvent=N,t.createSetTargetAutomationEvent=M,t.createSetValueAutomationEvent=l,t.createSetValueCurveAutomationEvent=c,Object.defineProperty(t,"__esModule",{value:!0})}(he.exports,ue.exports,me.exports,_e.exports);const ge=new WeakSet,ve=new WeakMap,ye=new WeakMap,Te=new WeakMap,Ee=new WeakMap,be=new WeakMap,xe=new WeakMap,Ae=new WeakMap,Se=new WeakMap,we=new WeakMap,Re={construct:()=>Re},Ce=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Oe=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),r=i.match(Ce);for(;null!==r;){const t=r[1].slice(1,-1),s=r[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(s),i=i.slice(r[0].length).replace(/^[\s]+/,""),r=i.match(Ce)}return[n.join(";"),i]},Ie=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Pe=t=>{if(!(t=>{try{new new Proxy(t,Re)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},Ne=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},Me=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[i]=n;return t.delete(i),i},De=(t,e,n,i)=>{const r=Ne(t,e),s=Me(r,(t=>t[0]===n&&t[1]===i));return 0===r.size&&t.delete(e),s},Le=t=>Ne(xe,t),Fe=t=>{if(ge.has(t))throw new Error("The AudioNode is already stored.");ge.add(t),Le(t).forEach((t=>t(!0)))},Ue=t=>"port"in t,Ge=t=>{if(!ge.has(t))throw new Error("The AudioNode is not stored.");ge.delete(t),Le(t).forEach((t=>t(!1)))},Be=(t,e)=>{!Ue(t)&&e.every((t=>0===t.size))&&Ge(t)},ke={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Ve=(t,e)=>t.context===e,Xe=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},je=()=>new DOMException("","IndexSizeError"),He=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(t){if(12===t.code)throw je();throw t}})},$e={numberOfChannels:1},Ye=-34028234663852886e22,We=-Ye,ze=t=>ge.has(t),qe={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Ze=t=>Ne(ve,t),Ke=t=>Ne(Te,t),Je=(t,e)=>{const{activeInputs:n}=Ze(t);n.forEach((n=>n.forEach((([n])=>{e.includes(t)||Je(n,[...e,t])}))));const i=(t=>"playbackRate"in t)(t)?[t.playbackRate]:Ue(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of i){const n=Ke(t);void 0!==n&&n.activeInputs.forEach((([t])=>Je(t,e)))}ze(t)&&Ge(t)},Qe=t=>{Je(t.destination,[])},tn=t=>"context"in t,en=t=>tn(t[0]),nn=(t,e,n,i)=>{for(const e of t)if(n(e)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},rn=(t,e,[n,i],r)=>{nn(t,[e,n,i],(t=>t[0]===e&&t[1]===n),r)},sn=(t,[e,n,i],r)=>{const s=t.get(e);void 0===s?t.set(e,new Set([[n,i]])):nn(s,[n,i],(t=>t[0]===n),r)},on=t=>"inputs"in t,an=(t,e,n,i)=>{if(on(e)){const r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]},hn=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},un=(t,e)=>{if(!Le(t).delete(e))throw new Error("Missing the expected event listener.")},ln=(t,e,n)=>{const i=Ne(t,e),r=Me(i,(t=>t[0]===n));return 0===i.size&&t.delete(e),r},cn=(t,e,n,i)=>{on(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},pn=t=>Ne(ye,t),dn=t=>Ne(Ee,t),fn=t=>Ae.has(t),mn=t=>!ge.has(t),_n=(t,e)=>new Promise((n=>{if(null!==e)n(!0);else{const e=t.createScriptProcessor(256,1,1),i=t.createGain(),r=t.createBuffer(1,2,44100),s=r.getChannelData(0);s[0]=1,s[1]=1;const o=t.createBufferSource();o.buffer=r,o.loop=!0,o.connect(e).connect(t.destination),o.connect(i),o.disconnect(i),e.onaudioprocess=i=>{const r=i.inputBuffer.getChannelData(0);Array.prototype.some.call(r,(t=>1===t))?n(!0):n(!1),o.stop(),e.onaudioprocess=null,o.disconnect(e),e.disconnect(t.destination)},o.start()}})),gn=(t,e)=>{const n=new Map;for(const e of t)for(const t of e){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach(((t,n)=>e(n,t)))},vn=t=>"context"in t,yn=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=Ke(e),{outputs:o}=Ze(t),a=Le(t),h=o=>{const a=pn(t),h=dn(e);if(o){const e=ln(s,t,n);rn(r,t,e,!1),i||fn(t)||a.connect(h,n)}else{const e=((t,e,n)=>Me(t,(t=>t[0]===e&&t[1]===n)))(r,t,n);sn(s,e,!1),i||fn(t)||a.disconnect(h,n)}};return!!nn(o,[e,n],(t=>t[0]===e&&t[1]===n),!0)&&(a.add(h),ze(t)?rn(r,t,[n,h],!0):sn(s,[t,n,h],!0),!0)},Tn=(t,e,n,i,r)=>{const[s,o]=((t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=Ze(e),o=hn(r[i],t,n);if(null===o)return[De(s,t,n,i)[2],!1];return[o[2],!0]})(t,n,i,r);if(null!==s&&(un(t,s),!o||e||fn(t)||cn(pn(t),pn(n),i,r)),ze(n)){const{activeInputs:t}=Ze(n);Be(n,t)}},En=(t,e,n,i)=>{const[r,s]=((t,e,n)=>{const{activeInputs:i,passiveInputs:r}=Ke(e),s=hn(i,t,n);if(null===s)return[ln(r,t,n)[1],!1];return[s[2],!0]})(t,n,i);null!==r&&(un(t,r),!s||e||fn(t)||pn(t).disconnect(dn(n),i))};class bn{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach(((n,i)=>t.call(e,n,i,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const xn={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function An(t,e,n,i,r){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{const s=t.getChannelData(i);if(0===e[n].byteLength)e[n]=s.slice(r,r+128);else{const t=new Float32Array(s.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const Sn=(t,e,n,i,r)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,r):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],r)},wn=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const t=[],r="number"==typeof e?e:e[i];for(let e=0;e<r;e+=1)t.push(new Float32Array(128));n.push(t)}return n},Rn=async(t,e,n,i,r,s,o)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,h=i.channelCount*i.numberOfInputs,u=r.reduce(((t,e)=>t+e),0),l=0===u?null:n.createBuffer(u,a,n.sampleRate);if(void 0===s)throw new Error("Missing the processor constructor.");const c=Ze(t),p=await((t,e)=>{const n=Ne(we,t),i=pn(e);return Ne(n,i)})(n,t),d=wn(i.numberOfInputs,i.channelCount),f=wn(i.numberOfOutputs,r),m=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let u=0;u<a;u+=128){if(i.numberOfInputs>0&&null!==e)for(let t=0;t<i.numberOfInputs;t+=1)for(let n=0;n<i.channelCount;n+=1)An(e,d[t],n,n,u);void 0!==s.parameterDescriptors&&null!==e&&s.parameterDescriptors.forEach((({name:t},n)=>{An(e,m,t,h+n,u)}));for(let t=0;t<i.numberOfInputs;t+=1)for(let e=0;e<r[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{const t=d.map(((t,e)=>0===c.activeInputs[e].size?[]:t)),e=o(u/n.sampleRate,n.sampleRate,(()=>p.process(t,f,m)));if(null!==l)for(let t=0,e=0;t<i.numberOfOutputs;t+=1){for(let n=0;n<r[t];n+=1)Sn(l,f[t],n,e+n,u);e+=r[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return l},Cn={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},On={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},In={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Pn={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Nn={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Mn=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise((i=>{const r=()=>{n.onmessage=null,e.close(),n.close(),i()};n.onmessage=()=>r();try{e.postMessage(t,[t])}finally{r()}}))},Dn={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Ln=(t,e,n)=>{const i=e[n];if(void 0===i)throw t();return i},Fn={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Un={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Gn=()=>new DOMException("","InvalidStateError"),Bn=()=>new DOMException("","InvalidAccessError"),kn={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Vn=(t,e,n,i,r,s,o,a,h,u,l)=>{const c=u.length;let p=a;for(let a=0;a<c;a+=1){let c=n[0]*u[a];for(let e=1;e<r;e+=1){const i=p-e&h-1;c+=n[e]*s[i],c-=t[e]*o[i]}for(let t=r;t<i;t+=1)c+=n[t]*s[p-t&h-1];for(let n=r;n<e;n+=1)c-=t[n]*o[p-n&h-1];s[p]=u[a],o[p]=c,p=p+1&h-1,l[a]=c}return p},Xn={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},jn=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},Hn=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},$n=(t,e)=>{Hn(t,e,"channelCount"),Hn(t,e,"channelCountMode"),Hn(t,e,"channelInterpretation")},Yn=t=>"function"==typeof t.getFloatTimeDomainData,Wn=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},zn=t=>{t.start=(e=>(n=0,i=0,r)=>{if("number"==typeof r&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r)})(t.start)},qn=t=>{var e;t.stop=(e=t.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},Zn=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),Kn=async(t,e)=>{const n=await(t=>new Promise(((e,n)=>{const{port1:i,port2:r}=new MessageChannel;i.onmessage=({data:t})=>{i.close(),r.close(),e(t)},i.onmessageerror=({data:t})=>{i.close(),r.close(),n(t)},r.postMessage(t)})))(e);return new t(n)},Jn=(t,e)=>{const n=t.createBiquadFilter();return $n(n,e),Wn(n,e,"Q"),Wn(n,e,"detune"),Wn(n,e,"frequency"),Wn(n,e,"gain"),Hn(n,e,"type"),n},Qn=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return $n(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Gn()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw Gn()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw Gn()}})})(n),n},ti=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),ei=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return $n(n,e),Wn(n,e,"delayTime"),n},ni=(t,e)=>{const n=t.createGain();return $n(n,e),Wn(n,e,"gain"),n};function ii(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function ri(t,e){let n=[0,0];for(let s=t.length-1;s>=0;s-=1)r=e,n=[(i=n)[0]*r[0]-i[1]*r[1],i[0]*r[1]+i[1]*r[0]],n[0]+=t[s];var i,r;return n}const si=(t,e,n,i)=>t.createScriptProcessor(e,n,i),oi=()=>new DOMException("","NotSupportedError"),ai={numberOfChannels:1},hi={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},ui={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},li={disableNormalization:!1},ci={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},pi={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},di=(t,e,n)=>void 0===t.copyFromChannel?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),fi=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},mi=(t,e,n,i)=>{let r=t;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:s,set:o}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(t,e,{get:n(s),set:i(o)})},_i=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(9!==i.code)throw i;_i(t,e,n+1e-7)}},gi=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},vi=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},yi=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},Ti=(t,e)=>{const n=e.createGain();t.connect(n);const i=(e=>()=>{e.call(t,n),t.removeEventListener("ended",i)})(t.disconnect);t.addEventListener("ended",i),ti(t,n),t.stop=(e=>{let i=!1;return(r=0)=>{if(i)try{e.call(t,r)}catch{n.gain.setValueAtTime(0,r)}else e.call(t,r),i=!0}})(t.stop)},Ei=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)},bi=(t=>(e,n,[i,r,s],o)=>{t(e[r],[n,i,s],(t=>t[0]===n&&t[1]===i),o)})(nn),xi=(t=>(e,n,[i,r,s],o)=>{const a=e.get(i);void 0===a?e.set(i,new Set([[r,n,s]])):t(a,[r,n,s],(t=>t[0]===r&&t[1]===n),o)})(nn),Ai=(t=>(e,n,i,r)=>t(e[r],(t=>t[0]===n&&t[1]===i)))(Me),Si=new WeakMap,wi=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0})(Si),Ri=(Ci=new Map,Oi=new WeakMap,(t,e)=>{const n=Oi.get(t);if(void 0!==n)return n;const i=Ci.get(t);if(void 0!==i)return i;try{const n=e();return n instanceof Promise?(Ci.set(t,n),n.catch((()=>!1)).then((e=>(Ci.delete(t),Oi.set(t,e),e)))):(Oi.set(t,n),n)}catch{return Oi.set(t,!1),!1}});var Ci,Oi;const Ii="undefined"==typeof window?null:window,Pi=((t,e)=>(n,i)=>{const r=n.createAnalyser();if($n(r,i),!(i.maxDecibels>i.minDecibels))throw e();return Hn(r,i,"fftSize"),Hn(r,i,"maxDecibels"),Hn(r,i,"minDecibels"),Hn(r,i,"smoothingTimeConstant"),t(Yn,(()=>Yn(r)))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let t=0;t<i;t+=1)e[t]=.0078125*(n[t]-128);return e}})(r),r})(Ri,je),Ni=(t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(Ze),Mi=((t,e,n)=>async(i,r,s)=>{const o=t(i);await Promise.all(o.activeInputs.map(((t,o)=>Array.from(t).map((async([t,a])=>{const h=e(t),u=await h.render(t,r),l=i.context.destination;n(t)||i===l&&n(i)||u.connect(s,a,o)})))).reduce(((t,e)=>[...t,...e]),[]))})(Ze,Ni,fn),Di=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!Ve(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=t(s,e)}return i.set(s,o),await n(r,s,o),o})(r,s)}}})(Pi,pn,Mi),Li=(Fi=be,t=>{const e=Fi.get(t);if(void 0===e)throw Gn();return e});var Fi;const Ui=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(Ii),Gi=(t=>e=>null!==t&&e instanceof t)(Ui),Bi=new WeakMap,ki=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(e,n,i){if(null!==n){let r=this._listeners.get(n);void 0===r&&(r=t(this,n),"function"==typeof n&&this._listeners.set(n,r)),this._nativeEventTarget.addEventListener(e,r,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}})(Ei),Vi=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(Ii),Xi=(t=>e=>null!==t&&e instanceof t)(Vi),ji=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(Ii),Hi=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(Ii),$i=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(Ii),Yi=((t,e,n,i,r,s,o,a,h,u,l,c,p,d,f,m)=>class extends u{constructor(e,i,r,s){super(r),this._context=e,this._nativeAudioNode=r;const o=l(e);c(o)&&!0!==n(_n,(()=>_n(o,m)))&&(t=>{const e=new Map;t.connect=(t=>(n,i=0,r=0)=>{const s=vn(n)?t(n,i,r):t(n,i),o=e.get(n);return void 0===o?e.set(n,[{input:r,output:i}]):o.every((t=>t.input!==r||t.output!==i))&&o.push({input:r,output:i}),s})(t.connect.bind(t)),t.disconnect=(n=>(i,r,s)=>{if(n.apply(t),void 0===i)e.clear();else if("number"==typeof i)for(const[t,n]of e){const r=n.filter((t=>t.output!==i));0===r.length?e.delete(t):e.set(t,r)}else if(e.has(i))if(void 0===r)e.delete(i);else{const t=e.get(i);if(void 0!==t){const n=t.filter((t=>t.output!==r&&(t.input!==s||void 0===s)));0===n.length?e.delete(i):e.set(i,n)}}for(const[n,i]of e)i.forEach((e=>{vn(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))})(t.disconnect)})(r),ye.set(this,r),xe.set(this,new Set),"closed"!==e.state&&i&&Fe(this),t(this,s,r)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,a=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw r();const u=l(this._context),c=f(u);if(p(t)||d(t))throw s();if(tn(t)){const r=pn(t);try{const e=an(this._nativeAudioNode,r,n,a),i=mn(this);(c||i)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!i&&mn(t)&&Fe(t)}catch(t){if(12===t.code)throw s();throw t}if(e(this,t,n,a,c)){const e=h([this],t);gn(e,i(c))}return t}const m=dn(t);if("playbackRate"===m.name&&1024===m.maxValue)throw o();try{this._nativeAudioNode.connect(m,n),(c||mn(this))&&this._nativeAudioNode.disconnect(m,n)}catch(t){if(12===t.code)throw s();throw t}if(yn(this,t,n,c)){const e=h([this],t);gn(e,i(c))}}disconnect(t,e,n){let i;const o=l(this._context),u=f(o);if(void 0===t)i=((t,e)=>{const n=Ze(t),i=[];for(const r of n.outputs)en(r)?Tn(t,e,...r):En(t,e,...r),i.push(r[0]);return n.outputs.clear(),i})(this,u);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw r();i=((t,e,n)=>{const i=Ze(t),r=[];for(const s of i.outputs)s[1]===n&&(en(s)?Tn(t,e,...s):En(t,e,...s),r.push(s[0]),i.outputs.delete(s));return r})(this,u,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw r();if(tn(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw r();if(i=((t,e,n,i,r)=>{const s=Ze(t);return Array.from(s.outputs).filter((t=>!(t[0]!==n||void 0!==i&&t[1]!==i||void 0!==r&&t[2]!==r))).map((n=>(en(n)?Tn(t,e,...n):En(t,e,...n),s.outputs.delete(n),n[0])))})(this,u,t,e,n),0===i.length)throw s()}for(const t of i){const e=h([this],t);gn(e,a)}}})((Wi=ve,(t,e,n)=>{const i=[];for(let t=0;t<n.numberOfInputs;t+=1)i.push(new Set);Wi.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,i,r,s,o,a,h,u,l,c,p)=>{const d=new WeakMap;return(f,m,_,g,v)=>{const{activeInputs:y,passiveInputs:T}=s(m),{outputs:E}=s(f),b=a(f),x=s=>{const a=h(m),u=h(f);if(s){const e=De(T,f,_,g);t(y,f,e,!1),v||c(f)||n(u,a,_,g),p(m)&&Fe(m)}else{const t=i(y,f,_,g);e(T,g,t,!1),v||c(f)||r(u,a,_,g);const n=o(m);if(0===n)l(m)&&Be(m,y);else{const t=d.get(m);void 0!==t&&clearTimeout(t),d.set(m,setTimeout((()=>{l(m)&&Be(m,y)}),1e3*n))}}};return!!u(E,[m,_,g],(t=>t[0]===m&&t[1]===_&&t[2]===g),!0)&&(b.add(x),l(f)?t(y,f,[_,g,x],!0):e(T,g,[f,_,x],!0),!0)}})(bi,xi,an,Ai,cn,Ze,wi,Le,pn,nn,ze,fn,mn),Ri,((t,e,n,i,r,s)=>o=>(a,h)=>{const u=t.get(a);if(void 0===u){if(!o&&s(a)){const t=i(a),{outputs:s}=n(a);for(const n of s)if(en(n)){const r=i(n[0]);e(t,r,n[1],n[2])}else{const e=r(n[0]);t.disconnect(e,n[1])}}t.set(a,h)}else t.set(a,u+h)})(Ae,cn,Ze,pn,dn,ze),je,Bn,oi,((t,e,n,i,r,s,o,a)=>(h,u)=>{const l=e.get(h);if(void 0===l)throw new Error("Missing the expected cycle count.");const c=s(h.context),p=a(c);if(l===u){if(e.delete(h),!p&&o(h)){const e=i(h),{outputs:s}=n(h);for(const n of s)if(en(n)){const r=i(n[0]);t(e,r,n[1],n[2])}else{const t=r(n[0]);e.connect(t,n[1])}}}else e.set(h,l-u)})(an,Ae,Ze,pn,dn,Li,ze,Gi),((t,e,n)=>function i(r,s){const o=tn(s)?s:n(t,s);if((t=>"delayTime"in t)(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map((t=>i([...r,o],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(Bi,Ze,Ne),ki,Li,Xi,ji,Hi,Gi,$i);var Wi;const zi=((t,e,n,i,r,s)=>class extends t{constructor(t,n){const o=r(t),a={...ke,...n},h=i(o,a);super(t,!1,h,s(o)?e():null),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(Yi,Di,je,Pi,Li,Gi),qi=new WeakSet,Zi=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(Ii),Ki=(Ji=new Uint32Array(1),t=>(Ji[0]=t,Ji[0]));var Ji;const Qi=((t,e)=>n=>{n.copyFromChannel=(i,r,s=0)=>{const o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();const h=n.length,u=n.getChannelData(a),l=i.length;for(let t=o<0?-o:0;t+o<h&&t<l;t+=1)i[t]=u[t+o]},n.copyToChannel=(i,r,s=0)=>{const o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();const h=n.length,u=n.getChannelData(a),l=i.length;for(let t=o<0?-o:0;t+o<h&&t<l;t+=1)u[t+o]=i[t]}})(Ki,je),tr=(t=>e=>{e.copyFromChannel=(n=>(i,r,s=0)=>{const o=t(s),a=t(r);if(o<e.length)return n.call(e,i,a,o)})(e.copyFromChannel),e.copyToChannel=(n=>(i,r,s=0)=>{const o=t(s),a=t(r);if(o<e.length)return n.call(e,i,a,o)})(e.copyToChannel)})(Ki),er=((t,e,n,i,r,s,o,a)=>{let h=null;return class u{constructor(u){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:l,numberOfChannels:c,sampleRate:p}={...$e,...u};null===h&&(h=new r(1,1,44100));const d=null!==i&&e(s,s)?new i({length:l,numberOfChannels:c,sampleRate:p}):h.createBuffer(c,l,p);if(0===d.numberOfChannels)throw n();return"function"!=typeof d.copyFromChannel?(o(d),He(d)):e(Xe,(()=>Xe(d)))||a(d),t.add(d),d}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===u.prototype||t.has(e)}}})(qi,Ri,oi,Zi,Ui,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(Zi),Qi,tr),nr=(t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const r=()=>{n.removeEventListener("ended",r),n.disconnect(i),i.disconnect()};n.addEventListener("ended",r)})(ni),ir=((t,e,n)=>async(i,r,s)=>{const o=e(i);await Promise.all(Array.from(o.activeInputs).map((async([e,i])=>{const o=t(e),a=await o.render(e,r);n(e)||a.connect(s,i)})))})(Ni,Ke,fn),rr=(t=>(e,n,i)=>t(n,e,i))(ir),sr=((t,e,n,i,r,s,o,a,h,u,l)=>(c,p)=>{const d=c.createBufferSource();return $n(d,p),Wn(d,p,"playbackRate"),Hn(d,p,"buffer"),Hn(d,p,"loop"),Hn(d,p,"loopEnd"),Hn(d,p,"loopStart"),e(n,(()=>n(c)))||(t=>{t.start=(e=>{let n=!1;return(i=0,r=0,s)=>{if(n)throw Gn();e.call(t,i,r,s),n=!0}})(t.start)})(d),e(i,(()=>i(c)))||h(d),e(r,(()=>r(c)))||u(d,c),e(s,(()=>s(c)))||zn(d),e(o,(()=>o(c)))||l(d,c),e(a,(()=>a(c)))||qn(d),t(c,d),d})(nr,Ri,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),gi,vi,yi,(t=>{t.start=(e=>(n=0,i=0,r)=>{const s=t.buffer,o=null===s?i:Math.min(s.duration,i);null!==s&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,r)})(t.start)}),(t=>(e,n)=>{const i=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=i),t(e,"buffer",(t=>()=>{const n=t.call(e);return n===i?null:n}),(t=>n=>t.call(e,null===n?i:n)))})(mi),Ti),or=((t,e)=>(n,i,r)=>(t(i).replay(r),e(i,n,r)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(Ke),ir),ar=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(h,u){const l=s.get(u);return void 0!==l?Promise.resolve(l):(async(h,u)=>{let l=n(h);const c=Ve(l,u);if(!c){const t={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,loop:l.loop,loopEnd:l.loopEnd,loopStart:l.loopStart,playbackRate:l.playbackRate.value};l=e(u,t),null!==o&&l.start(...o),null!==a&&l.stop(a)}return s.set(u,l),c?await t(u,h.playbackRate,l.playbackRate):await i(u,h.playbackRate,l.playbackRate),await r(h,u,l),l})(h,u)}}})(rr,sr,pn,or,Mi),hr=((t,e,n,i,r,s,o,a,h,u,l,c,p)=>(d,f,m,_=null,g=null)=>{const v=new he.exports.AutomationEventList(m.defaultValue),y=f?i(v):null,T={get defaultValue(){return m.defaultValue},get maxValue(){return null===_?m.maxValue:_},get minValue(){return null===g?m.minValue:g},get value(){return m.value},set value(t){m.value=t,T.setValueAtTime(t,d.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof m.cancelAndHoldAtTime)null===y&&v.flush(d.context.currentTime),v.add(r(t)),m.cancelAndHoldAtTime(t);else{const e=Array.from(v).pop();null===y&&v.flush(d.context.currentTime),v.add(r(t));const n=Array.from(v).pop();m.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return T},cancelScheduledValues:t=>(null===y&&v.flush(d.context.currentTime),v.add(s(t)),m.cancelScheduledValues(t),T),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===y&&v.flush(d.context.currentTime),v.add(o(t,e)),m.exponentialRampToValueAtTime(t,e),T},linearRampToValueAtTime:(t,e)=>(null===y&&v.flush(d.context.currentTime),v.add(a(t,e)),m.linearRampToValueAtTime(t,e),T),setTargetAtTime:(t,e,n)=>(null===y&&v.flush(d.context.currentTime),v.add(h(t,e,n)),m.setTargetAtTime(t,e,n),T),setValueAtTime:(t,e)=>(null===y&&v.flush(d.context.currentTime),v.add(u(t,e)),m.setValueAtTime(t,e),T),setValueCurveAtTime(t,e,n){const i=t instanceof Float32Array?t:new Float32Array(t);if(null!==c&&"webkitAudioContext"===c.name){const t=e+n,r=d.context.sampleRate,s=Math.ceil(e*r),o=Math.floor(t*r),a=o-s,h=new Float32Array(a);for(let t=0;t<a;t+=1){const o=(i.length-1)/n*((s+t)/r-e),a=Math.floor(o),u=Math.ceil(o);h[t]=a===u?i[a]:(1-(o-a))*i[a]+(1-(u-o))*i[u]}null===y&&v.flush(d.context.currentTime),v.add(l(h,e,n)),m.setValueCurveAtTime(h,e,n);const u=o/r;u<t&&p(T,h[h.length-1],u),p(T,i[i.length-1],t)}else null===y&&v.flush(d.context.currentTime),v.add(l(i,e,n)),m.setValueCurveAtTime(i,e,n);return T}};return n.set(T,m),e.set(T,d),t(T,y),T})((ur=Te,(t,e)=>{ur.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),Bi,Ee,(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:i}=n;e.exponentialRampToValueAtTime(i,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:i}=n;e.linearRampToValueAtTime(i,t)}else if("setTarget"===n.type){const{startTime:t,target:i,timeConstant:r}=n;e.setTargetAtTime(i,t,r)}else if("setValue"===n.type){const{startTime:t,value:i}=n;e.setValueAtTime(i,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:i,values:r}=n;e.setValueCurveAtTime(r,i,t)}}}})),he.exports.createCancelAndHoldAutomationEvent,he.exports.createCancelScheduledValuesAutomationEvent,he.exports.createExponentialRampToValueAutomationEvent,he.exports.createLinearRampToValueAutomationEvent,he.exports.createSetTargetAutomationEvent,he.exports.createSetValueAutomationEvent,he.exports.createSetValueCurveAutomationEvent,Vi,_i);var ur;const lr=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,i){const a=s(t),h={...qe,...i},u=r(a,h),l=o(a),c=l?e():null;super(t,!1,u,c),this._audioBufferSourceNodeRenderer=c,this._isBufferNullified=!1,this._isBufferSet=null!==h.buffer,this._nativeAudioBufferSourceNode=u,this._onended=null,this._playbackRate=n(this,l,u.playbackRate,We,Ye)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){Fe(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),ze(this)&&Ge(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(Yi,ar,hr,Gn,sr,Li,Gi,Ei),cr=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,n){const i=s(t),h=o(i),u=r(i,n,h);super(t,!1,u,h?e(a):null),this._isNodeOfNativeOfflineAudioContext=h,this._nativeAudioDestinationNode=u}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(Yi,(t=>{const e=new WeakMap;return{render(n,i){const r=e.get(i);return void 0!==r?Promise.resolve(r):(async(n,i)=>{const r=i.destination;return e.set(i,r),await t(n,i,r),r})(n,i)}}}),je,Gn,((t,e)=>(n,i,r)=>{const s=n.destination;if(s.channelCount!==i)try{s.channelCount=i}catch{}r&&"explicit"!==s.channelCountMode&&(s.channelCountMode="explicit"),0===s.maxChannelCount&&Object.defineProperty(s,"maxChannelCount",{value:i});const o=t(n,{channelCount:i,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e);try{s.channelCount=e}catch(t){if(e>s.maxChannelCount)throw t}})),e(o,"channelCountMode",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),s.channelCountMode=e})),e(o,"channelInterpretation",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),s.channelInterpretation=e})),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o})(ni,mi),Li,Gi,Mi),pr=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a)=>{let h=n(o);const u=Ve(h,a);if(!u){const t={Q:h.Q.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,gain:h.gain.value,type:h.type};h=e(a,t)}return s.set(a,h),u?(await t(a,o.Q,h.Q),await t(a,o.detune,h.detune),await t(a,o.frequency,h.frequency),await t(a,o.gain,h.gain)):(await i(a,o.Q,h.Q),await i(a,o.detune,h.detune),await i(a,o.frequency,h.frequency),await i(a,o.gain,h.gain)),await r(o,a,h),h})(o,a)}}})(rr,Jn,pn,or,Mi),dr=(t=>(e,n)=>t.set(e,n))(Si),fr=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,i){const h=s(t),u={...Cn,...i},l=r(h,u),c=o(h);super(t,!1,l,c?n():null),this._Q=e(this,c,l.Q,We,Ye),this._detune=e(this,c,l.detune,1200*Math.log2(We),-1200*Math.log2(We)),this._frequency=e(this,c,l.frequency,t.sampleRate/2,0),this._gain=e(this,c,l.gain,40*Math.log10(We),Ye),this._nativeBiquadFilterNode=l,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n)}catch(t){if(11===t.code)throw i();throw t}if(t.length!==e.length||e.length!==n.length)throw i()}})(Yi,hr,pr,Bn,Jn,Li,Gi,dr),mr=((t,e)=>(n,i,r)=>{const s=new Set;return n.connect=(r=>(o,a=0,h=0)=>{const u=0===s.size;if(e(o))return r.call(n,o,a,h),t(s,[o,a,h],(t=>t[0]===o&&t[1]===a&&t[2]===h),!0),u&&i(),o;r.call(n,o,a),t(s,[o,a],(t=>t[0]===o&&t[1]===a),!0),u&&i()})(n.connect),n.disconnect=(t=>(i,o,a)=>{const h=s.size>0;if(void 0===i)t.apply(n),s.clear();else if("number"==typeof i){t.call(n,i);for(const t of s)t[1]===i&&s.delete(t)}else{e(i)?t.call(n,i,o,a):t.call(n,i,o);for(const t of s)t[0]!==i||void 0!==o&&t[1]!==o||void 0!==a&&t[2]!==a||s.delete(t)}const u=0===s.size;h&&u&&r()})(n.disconnect),n})(nn,ji),_r=((t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const r=n.createBufferSource();e(i,(()=>{const t=i.numberOfInputs;for(let e=0;e<t;e+=1)r.connect(i,0,e)}),(()=>r.disconnect(i)))})(Gn,mr),gr=((t,e)=>(n,i)=>{const r=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,r),$n(r,i),r})(Vi,_r),vr=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!Ve(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=t(s,e)}return i.set(s,o),await n(r,s,o),o})(r,s)}}})(gr,pn,Mi),yr=((t,e,n,i,r)=>class extends t{constructor(t,s){const o=i(t),a={...On,...s};super(t,!1,n(o,a),r(o)?e():null)}})(Yi,vr,gr,Li,Gi),Tr=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!Ve(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=t(s,e)}return i.set(s,o),await n(r,s,o),o})(r,s)}}})(Qn,pn,Mi),Er=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),h=s({...In,...o});super(t,!1,n(a,h),r(a)?e():null)}})(Yi,Tr,Qn,Li,Gi,(t=>({...t,channelCount:t.numberOfOutputs}))),br=((t,e,n,i)=>(r,{offset:s,...o})=>{const a=r.createBuffer(1,2,44100),h=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=n(r,{...o,gain:s}),l=a.getChannelData(0);l[0]=1,l[1]=1,h.buffer=a,h.loop=!0;const c={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){u.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){u.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return h.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return h.onended},set onended(t){h.onended=t},addEventListener:(...t)=>h.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>h.dispatchEvent(t[0]),removeEventListener:(...t)=>h.removeEventListener(t[0],t[1],t[2]),start(t=0){h.start.call(h,t)},stop(t=0){h.stop.call(h,t)}};return t(r,h),i(ti(c,u),(()=>h.connect(u)),(()=>h.disconnect(u)))})(nr,sr,ni,mr),xr=((t,e,n,i,r)=>(s,o)=>{if(void 0===s.createConstantSource)return n(s,o);const a=s.createConstantSource();return $n(a,o),Wn(a,o,"offset"),e(i,(()=>i(s)))||zn(a),e(r,(()=>r(s)))||qn(a),t(s,a),a})(nr,Ri,br,gi,yi),Ar=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(h,u){const l=s.get(u);return void 0!==l?Promise.resolve(l):(async(h,u)=>{let l=n(h);const c=Ve(l,u);if(!c){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,offset:l.offset.value};l=e(u,t),null!==o&&l.start(o),null!==a&&l.stop(a)}return s.set(u,l),c?await t(u,h.offset,l.offset):await i(u,h.offset,l.offset),await r(h,u,l),l})(h,u)}}})(rr,xr,pn,or,Mi),Sr=((t,e,n,i,r,s,o)=>class extends t{constructor(t,o){const a=r(t),h={...Pn,...o},u=i(a,h),l=s(a),c=l?n():null;super(t,!1,u,c),this._constantSourceNodeRenderer=c,this._nativeConstantSourceNode=u,this._offset=e(this,l,u.offset,We,Ye),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){Fe(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),ze(this)&&Ge(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(Yi,hr,Ar,xr,Li,Gi,Ei),wr=((t,e)=>(n,i)=>{const r=n.createConvolver();if($n(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),Hn(r,i,"buffer"),i.channelCount>2)throw t();if(e(r,"channelCount",(t=>()=>t.call(r)),(e=>n=>{if(n>2)throw t();return e.call(r,n)})),"max"===i.channelCountMode)throw t();return e(r,"channelCountMode",(t=>()=>t.call(r)),(e=>n=>{if("max"===n)throw t();return e.call(r,n)})),r})(oi,mi),Rr=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!Ve(o,s)){const e={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=t(s,e)}return i.set(s,o),on(o)?await n(r,s,o.inputs[0]):await n(r,s,o),o})(r,s)}}})(wr,pn,Mi),Cr=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),h={...Nn,...o},u=n(a,h);super(t,!1,u,r(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=u,null!==h.buffer&&s(this,h.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(Yi,Rr,wr,Li,Gi,dr),Or=((t,e,n,i,r)=>s=>{const o=new WeakMap;return{render(a,h){const u=o.get(h);return void 0!==u?Promise.resolve(u):(async(a,h)=>{let u=n(a);const l=Ve(u,h);if(!l){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=e(h,t)}return o.set(h,u),l?await t(h,a.delayTime,u.delayTime):await i(h,a.delayTime,u.delayTime),await r(a,h,u),u})(a,h)}}})(rr,ei,pn,or,Mi),Ir=((t,e,n,i,r,s,o)=>class extends t{constructor(t,a){const h=r(t),u={...Dn,...a},l=i(h,u),c=s(h);super(t,!1,l,c?n(u.maxDelayTime):null),this._delayTime=e(this,c,l.delayTime),o(this,u.maxDelayTime)}get delayTime(){return this._delayTime}})(Yi,hr,Or,ei,Li,Gi,dr),Pr=(t=>(e,n)=>{const i=e.createDynamicsCompressor();if($n(i,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return Wn(i,n,"attack"),Wn(i,n,"knee"),Wn(i,n,"ratio"),Wn(i,n,"release"),Wn(i,n,"threshold"),i})(oi),Nr=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a)=>{let h=n(o);const u=Ve(h,a);if(!u){const t={attack:h.attack.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,knee:h.knee.value,ratio:h.ratio.value,release:h.release.value,threshold:h.threshold.value};h=e(a,t)}return s.set(a,h),u?(await t(a,o.attack,h.attack),await t(a,o.knee,h.knee),await t(a,o.ratio,h.ratio),await t(a,o.release,h.release),await t(a,o.threshold,h.threshold)):(await i(a,o.attack,h.attack),await i(a,o.knee,h.knee),await i(a,o.ratio,h.ratio),await i(a,o.release,h.release),await i(a,o.threshold,h.threshold)),await r(o,a,h),h})(o,a)}}})(rr,Pr,pn,or,Mi),Mr=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,r){const h=s(t),u={...Fn,...r},l=i(h,u),c=o(h);super(t,!1,l,c?n():null),this._attack=e(this,c,l.attack),this._knee=e(this,c,l.knee),this._nativeDynamicsCompressorNode=l,this._ratio=e(this,c,l.ratio),this._release=e(this,c,l.release),this._threshold=e(this,c,l.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(Yi,hr,Nr,Pr,oi,Li,Gi,dr),Dr=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a)=>{let h=n(o);const u=Ve(h,a);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,gain:h.gain.value};h=e(a,t)}return s.set(a,h),u?await t(a,o.gain,h.gain):await i(a,o.gain,h.gain),await r(o,a,h),h})(o,a)}}})(rr,ni,pn,or,Mi),Lr=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=r(t),h={...Un,...o},u=i(a,h),l=s(a);super(t,!1,u,l?n():null),this._gain=e(this,l,u.gain,We,Ye)}get gain(){return this._gain}})(Yi,hr,Dr,ni,Li,Gi),Fr=((t,e,n,i)=>(r,s,{channelCount:o,channelCountMode:a,channelInterpretation:h,feedback:u,feedforward:l})=>{const c=Zn(s,r.sampleRate),p=u instanceof Float64Array?u:new Float64Array(u),d=l instanceof Float64Array?l:new Float64Array(l),f=p.length,m=d.length,_=Math.min(f,m);if(0===f||f>20)throw i();if(0===p[0])throw e();if(0===m||m>20)throw i();if(0===d[0])throw e();if(1!==p[0]){for(let t=0;t<m;t+=1)d[t]/=p[0];for(let t=1;t<f;t+=1)p[t]/=p[0]}const g=n(r,c,o,o);g.channelCount=o,g.channelCountMode=a,g.channelInterpretation=h;const v=[],y=[],T=[];for(let t=0;t<o;t+=1){v.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),y.push(t),T.push(e)}g.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels;for(let t=0;t<i;t+=1){const i=e.getChannelData(t),r=n.getChannelData(t);v[t]=Vn(p,f,d,m,_,y[t],T[t],v[t],32,i,r)}};const E=r.sampleRate/2,b={get bufferSize(){return c},get channelCount(){return g.channelCount},set channelCount(t){g.channelCount=t},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){g.channelCountMode=t},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(t){g.channelInterpretation=t},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener:(...t)=>g.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>g.dispatchEvent(t[0]),getFrequencyResponse(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();const r=e.length;for(let t=0;t<r;t+=1){const r=-Math.PI*(e[t]/E),s=[Math.cos(r),Math.sin(r)],o=ii(ri(d,s),ri(p,s));n[t]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),i[t]=Math.atan2(o[1],o[0])}},removeEventListener:(...t)=>g.removeEventListener(t[0],t[1],t[2])};return ti(b,g)})(Bn,Gn,si,oi),Ur=((t,e,n,i)=>r=>t(jn,(()=>jn(r)))?Promise.resolve(t(i,i)).then((t=>{if(!t){const t=n(r,512,0,1);r.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>r.currentTime,t.connect(r.destination)}return r.startRendering()})):new Promise((t=>{const n=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(r.destination),r.startRendering()})))(Ri,ni,si,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{n.oncomplete=()=>{i.disconnect(),t(0!==n.currentTime)},n.startRendering()}))})(ni,Ui)),Gr=((t,e,n,i,r)=>(s,o)=>{const a=new WeakMap;let h=null;const u=async(u,l)=>{let c=null,p=e(u);const d=Ve(p,l);if(void 0===l.createIIRFilter?c=t(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):d||(p=l.createIIRFilter(o,s)),a.set(l,null===c?p:c),null!==c){if(null===h){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(u.context.destination.channelCount,u.context.length,l.sampleRate);h=(async()=>{await i(u,t,t.destination);return((t,e,n,i)=>{const r=n instanceof Float64Array?n:new Float64Array(n),s=i instanceof Float64Array?i:new Float64Array(i),o=r.length,a=s.length,h=Math.min(o,a);if(1!==r[0]){for(let t=0;t<o;t+=1)s[t]/=r[0];for(let t=1;t<a;t+=1)r[t]/=r[0]}const u=new Float32Array(32),l=new Float32Array(32),c=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),p=t.numberOfChannels;for(let e=0;e<p;e+=1){const n=t.getChannelData(e),i=c.getChannelData(e);u.fill(0),l.fill(0),Vn(r,o,s,a,h,u,l,0,32,n,i)}return c})(await r(t),l,s,o)})()}const t=await h;return c.buffer=t,c.start(0),c}return await i(u,l,p),p};return{render(t,e){const n=a.get(e);return void 0!==n?Promise.resolve(n):u(t,e)}}})(sr,pn,Ui,Mi,Ur),Br=(t=>(e,n,i)=>{if(void 0===e.createIIRFilter)return t(e,n,i);const r=e.createIIRFilter(i.feedforward,i.feedback);return $n(r,i),r})(Fr),kr=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),h=r(a),u={...kn,...o},l=e(a,h?null:t.baseLatency,u);super(t,!1,l,h?n(u.feedback,u.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,i,r)=>{if(n.length!==i.length||i.length!==r.length)throw Bn();return e.call(t,n,i,r)})})(l),this._nativeIIRFilterNode=l,s(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(Yi,Br,Gr,Li,Gi,dr),Vr=((t,e,n,i,r,s,o,a)=>(h,u)=>{const l=u.listener,{forwardX:c,forwardY:p,forwardZ:d,positionX:f,positionY:m,positionZ:_,upX:g,upY:v,upZ:y}=void 0===l.forwardX?(()=>{const c=new Float32Array(1),p=e(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),d=o(u);let f=!1,m=[0,0,-1,0,1,0],_=[0,0,0];const g=()=>{if(f)return;f=!0;const t=i(u,256,9,0);t.onaudioprocess=({inputBuffer:t})=>{const e=[s(t,c,0),s(t,c,1),s(t,c,2),s(t,c,3),s(t,c,4),s(t,c,5)];e.some(((t,e)=>t!==m[e]))&&(l.setOrientation(...e),m=e);const n=[s(t,c,6),s(t,c,7),s(t,c,8)];n.some(((t,e)=>t!==_[e]))&&(l.setPosition(...n),_=n)},p.connect(t)},v=t=>e=>{e!==m[t]&&(m[t]=e,l.setOrientation(...m))},y=t=>e=>{e!==_[t]&&(_[t]=e,l.setPosition(..._))},T=(e,i,s)=>{const o=n(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});o.connect(p,0,e),o.start(),Object.defineProperty(o.offset,"defaultValue",{get:()=>i});const l=t({context:h},d,o.offset,We,Ye);var c,f,m,_,v,y,T;return a(l,"value",(t=>()=>t.call(l)),(t=>e=>{try{t.call(l,e)}catch(t){if(9!==t.code)throw t}g(),d&&s(e)})),l.cancelAndHoldAtTime=(c=l.cancelAndHoldAtTime,d?()=>{throw r()}:(...t)=>{const e=c.apply(l,t);return g(),e}),l.cancelScheduledValues=(f=l.cancelScheduledValues,d?()=>{throw r()}:(...t)=>{const e=f.apply(l,t);return g(),e}),l.exponentialRampToValueAtTime=(m=l.exponentialRampToValueAtTime,d?()=>{throw r()}:(...t)=>{const e=m.apply(l,t);return g(),e}),l.linearRampToValueAtTime=(_=l.linearRampToValueAtTime,d?()=>{throw r()}:(...t)=>{const e=_.apply(l,t);return g(),e}),l.setTargetAtTime=(v=l.setTargetAtTime,d?()=>{throw r()}:(...t)=>{const e=v.apply(l,t);return g(),e}),l.setValueAtTime=(y=l.setValueAtTime,d?()=>{throw r()}:(...t)=>{const e=y.apply(l,t);return g(),e}),l.setValueCurveAtTime=(T=l.setValueCurveAtTime,d?()=>{throw r()}:(...t)=>{const e=T.apply(l,t);return g(),e}),l};return{forwardX:T(0,0,v(0)),forwardY:T(1,0,v(1)),forwardZ:T(2,-1,v(2)),positionX:T(6,0,y(0)),positionY:T(7,0,y(1)),positionZ:T(8,0,y(2)),upX:T(3,0,v(3)),upY:T(4,1,v(4)),upZ:T(5,0,v(5))}})():l;return{get forwardX(){return c},get forwardY(){return p},get forwardZ(){return d},get positionX(){return f},get positionY(){return m},get positionZ(){return _},get upX(){return g},get upY(){return v},get upZ(){return y}}})(hr,gr,xr,si,oi,di,Gi,mi),Xr=new WeakMap,jr=((t,e,n,i,r,s)=>class extends n{constructor(n,s){super(n),this._nativeContext=n,be.set(this,n),i(n)&&r.set(n,new Set),this._destination=new t(this,s),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?s(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(cr,Vr,ki,Gi,Xr,Ei),Hr=((t,e,n,i,r,s)=>(o,a)=>{const h=o.createOscillator();return $n(h,a),Wn(h,a,"detune"),Wn(h,a,"frequency"),void 0!==a.periodicWave?h.setPeriodicWave(a.periodicWave):Hn(h,a,"type"),e(n,(()=>n(o)))||zn(h),e(i,(()=>i(o)))||s(h,o),e(r,(()=>r(o)))||qn(h),t(o,h),h})(nr,Ri,gi,vi,yi,Ti),$r=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null,h=null;return{set periodicWave(t){o=t},set start(t){a=t},set stop(t){h=t},render(u,l){const c=s.get(l);return void 0!==c?Promise.resolve(c):(async(u,l)=>{let c=n(u);const p=Ve(c,l);if(!p){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,periodicWave:null===o?void 0:o,type:c.type};c=e(l,t),null!==a&&c.start(a),null!==h&&c.stop(h)}return s.set(l,c),p?(await t(l,u.detune,c.detune),await t(l,u.frequency,c.frequency)):(await i(l,u.detune,c.detune),await i(l,u.frequency,c.frequency)),await r(u,l,c),c})(u,l)}}})(rr,Hr,pn,or,Mi),Yr=((t,e,n,i,r,s,o)=>class extends t{constructor(t,o){const a=r(t),h={...hi,...o},u=n(a,h),l=s(a),c=l?i():null,p=t.sampleRate/2;super(t,!1,u,c),this._detune=e(this,l,u.detune,153600,-153600),this._frequency=e(this,l,u.frequency,p,-p),this._nativeOscillatorNode=u,this._onended=null,this._oscillatorNodeRenderer=c,null!==this._oscillatorNodeRenderer&&void 0!==h.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){Fe(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),ze(this)&&Ge(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(Yi,hr,Hr,$r,Li,Gi,Ei),Wr=(t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return i.buffer=r,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n)}})(sr),zr=((t,e,n,i,r)=>(s,{curve:o,oversample:a,...h})=>{const u=s.createWaveShaper(),l=s.createWaveShaper();$n(u,h),$n(l,h);const c=n(s,{...h,gain:1}),p=n(s,{...h,gain:-1}),d=n(s,{...h,gain:1}),f=n(s,{...h,gain:-1});let m=null,_=!1,g=null;const v={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){c.channelCount=t,p.channelCount=t,u.channelCount=t,d.channelCount=t,l.channelCount=t,f.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){c.channelCountMode=t,p.channelCountMode=t,u.channelCountMode=t,d.channelCountMode=t,l.channelCountMode=t,f.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){c.channelInterpretation=t,p.channelInterpretation=t,u.channelInterpretation=t,d.channelInterpretation=t,l.channelInterpretation=t,f.channelInterpretation=t},get context(){return u.context},get curve(){return g},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)u.curve=n,l.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),i=new Float32Array(t+2-t%2);e[0]=n[0],i[0]=-n[t-1];const r=Math.ceil((t+1)/2),s=(t+1)/2-1;for(let o=1;o<r;o+=1){const a=o/r*s,h=Math.floor(a),u=Math.ceil(a);e[o]=h===u?n[h]:(1-(a-h))*n[h]+(1-(u-a))*n[u],i[o]=h===u?-n[t-1-h]:-(1-(a-h))*n[t-1-h]-(1-(u-a))*n[t-1-u]}e[r]=t%2==1?n[r-1]:(n[r-2]+n[r-1])/2,u.curve=e,l.curve=i}g=n,_&&(i(g)&&null===m?m=t(s,c):null!==m&&(m(),m=null))},get inputs(){return[c]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get oversample(){return u.oversample},set oversample(t){u.oversample=t,l.oversample=t},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2])};null!==o&&(v.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==v.oversample&&(v.oversample=a);return r(ti(v,d),(()=>{c.connect(u).connect(d),c.connect(p).connect(l).connect(f).connect(d),_=!0,i(g)&&(m=t(s,c))}),(()=>{c.disconnect(u),u.disconnect(d),c.disconnect(p),p.disconnect(l),l.disconnect(f),f.disconnect(d),_=!1,null!==m&&(m(),m=null)}))})(Wr,Gn,ni,fi,mr),qr=((t,e,n,i,r,s,o)=>(a,h)=>{const u=a.createWaveShaper();if(null!==s&&"webkitAudioContext"===s.name&&void 0===a.createGain().gain.automationRate)return n(a,h);$n(u,h);const l=null===h.curve||h.curve instanceof Float32Array?h.curve:new Float32Array(h.curve);if(null!==l&&l.length<2)throw e();Hn(u,{curve:l},"curve"),Hn(u,h,"oversample");let c=null,p=!1;o(u,"curve",(t=>()=>t.call(u)),(e=>n=>(e.call(u,n),p&&(i(n)&&null===c?c=t(a,u):i(n)||null===c||(c(),c=null)),n)));return r(u,(()=>{p=!0,i(u.curve)&&(c=t(a,u))}),(()=>{p=!1,null!==c&&(c(),c=null)}))})(Wr,Gn,zr,fi,mr,Vi,mi),Zr=((t,e,n,i,r,s,o,a,h,u)=>(l,{coneInnerAngle:c,coneOuterAngle:p,coneOuterGain:d,distanceModel:f,maxDistance:m,orientationX:_,orientationY:g,orientationZ:v,panningModel:y,positionX:T,positionY:E,positionZ:b,refDistance:x,rolloffFactor:A,...S})=>{const w=l.createPanner();if(S.channelCount>2)throw o();if("max"===S.channelCountMode)throw o();$n(w,S);const R={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},C=n(l,{...R,channelInterpretation:"speakers",numberOfInputs:6}),O=i(l,{...S,gain:1}),I=i(l,{...R,gain:1}),P=i(l,{...R,gain:0}),N=i(l,{...R,gain:0}),M=i(l,{...R,gain:0}),D=i(l,{...R,gain:0}),L=i(l,{...R,gain:0}),F=r(l,256,6,1),U=s(l,{...R,curve:new Float32Array([1,1]),oversample:"none"});let G=[_,g,v],B=[T,E,b];const k=new Float32Array(1);F.onaudioprocess=({inputBuffer:t})=>{const e=[h(t,k,0),h(t,k,1),h(t,k,2)];e.some(((t,e)=>t!==G[e]))&&(w.setOrientation(...e),G=e);const n=[h(t,k,3),h(t,k,4),h(t,k,5)];n.some(((t,e)=>t!==B[e]))&&(w.setPosition(...n),B=n)},Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(L.gain,"defaultValue",{get:()=>0});const V={get bufferSize(){},get channelCount(){return w.channelCount},set channelCount(t){if(t>2)throw o();O.channelCount=t,w.channelCount=t},get channelCountMode(){return w.channelCountMode},set channelCountMode(t){if("max"===t)throw o();O.channelCountMode=t,w.channelCountMode=t},get channelInterpretation(){return w.channelInterpretation},set channelInterpretation(t){O.channelInterpretation=t,w.channelInterpretation=t},get coneInnerAngle(){return w.coneInnerAngle},set coneInnerAngle(t){w.coneInnerAngle=t},get coneOuterAngle(){return w.coneOuterAngle},set coneOuterAngle(t){w.coneOuterAngle=t},get coneOuterGain(){return w.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();w.coneOuterGain=t},get context(){return w.context},get distanceModel(){return w.distanceModel},set distanceModel(t){w.distanceModel=t},get inputs(){return[O]},get maxDistance(){return w.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;w.maxDistance=t},get numberOfInputs(){return w.numberOfInputs},get numberOfOutputs(){return w.numberOfOutputs},get orientationX(){return I.gain},get orientationY(){return P.gain},get orientationZ(){return N.gain},get panningModel(){return w.panningModel},set panningModel(t){w.panningModel=t},get positionX(){return M.gain},get positionY(){return D.gain},get positionZ(){return L.gain},get refDistance(){return w.refDistance},set refDistance(t){if(t<0)throw new RangeError;w.refDistance=t},get rolloffFactor(){return w.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;w.rolloffFactor=t},addEventListener:(...t)=>O.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>O.dispatchEvent(t[0]),removeEventListener:(...t)=>O.removeEventListener(t[0],t[1],t[2])};c!==V.coneInnerAngle&&(V.coneInnerAngle=c),p!==V.coneOuterAngle&&(V.coneOuterAngle=p),d!==V.coneOuterGain&&(V.coneOuterGain=d),f!==V.distanceModel&&(V.distanceModel=f),m!==V.maxDistance&&(V.maxDistance=m),_!==V.orientationX.value&&(V.orientationX.value=_),g!==V.orientationY.value&&(V.orientationY.value=g),v!==V.orientationZ.value&&(V.orientationZ.value=v),y!==V.panningModel&&(V.panningModel=y),T!==V.positionX.value&&(V.positionX.value=T),E!==V.positionY.value&&(V.positionY.value=E),b!==V.positionZ.value&&(V.positionZ.value=b),x!==V.refDistance&&(V.refDistance=x),A!==V.rolloffFactor&&(V.rolloffFactor=A),1===G[0]&&0===G[1]&&0===G[2]||w.setOrientation(...G),0===B[0]&&0===B[1]&&0===B[2]||w.setPosition(...B);return u(ti(V,w),(()=>{O.connect(w),t(O,U,0,0),U.connect(I).connect(C,0,0),U.connect(P).connect(C,0,1),U.connect(N).connect(C,0,2),U.connect(M).connect(C,0,3),U.connect(D).connect(C,0,4),U.connect(L).connect(C,0,5),C.connect(F).connect(l.destination)}),(()=>{O.disconnect(w),a(O,U,0,0),U.disconnect(I),I.disconnect(C),U.disconnect(P),P.disconnect(C),U.disconnect(N),N.disconnect(C),U.disconnect(M),M.disconnect(C),U.disconnect(D),D.disconnect(C),U.disconnect(L),L.disconnect(C),C.disconnect(F),F.disconnect(l.destination)}))})(an,Gn,gr,ni,si,qr,oi,cn,di,mr),Kr=(t=>(e,n)=>{const i=e.createPanner();return void 0===i.orientationX?t(e,n):($n(i,n),Wn(i,n,"orientationX"),Wn(i,n,"orientationY"),Wn(i,n,"orientationZ"),Wn(i,n,"positionX"),Wn(i,n,"positionY"),Wn(i,n,"positionZ"),Hn(i,n,"coneInnerAngle"),Hn(i,n,"coneOuterAngle"),Hn(i,n,"coneOuterGain"),Hn(i,n,"distanceModel"),Hn(i,n,"maxDistance"),Hn(i,n,"panningModel"),Hn(i,n,"refDistance"),Hn(i,n,"rolloffFactor"),i)})(Zr),Jr=((t,e,n,i,r,s,o,a,h,u)=>()=>{const l=new WeakMap;let c=null;return{render(p,d){const f=l.get(d);return void 0!==f?Promise.resolve(f):(async(p,d)=>{let f=null,m=s(p);const _={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},g={..._,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},v=Ve(m,d);if("bufferSize"in m)f=i(d,{..._,gain:1});else if(!v){const t={...g,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=r(d,t)}if(l.set(d,null===f?m:f),null!==f){if(null===c){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new o(6,p.context.length,d.sampleRate),i=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});i.connect(t.destination),c=(async()=>{const e=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map((async(e,i)=>{const r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===i?1:0});return await a(t,e,r.offset),r})));for(let t=0;t<6;t+=1)e[t].connect(i,0,t),e[t].start(0);return u(t)})()}const t=await c,s=i(d,{..._,gain:1});await h(p,d,s);const l=[];for(let e=0;e<t.numberOfChannels;e+=1)l.push(t.getChannelData(e));let m=[l[0][0],l[1][0],l[2][0]],v=[l[3][0],l[4][0],l[5][0]],y=i(d,{..._,gain:1}),T=r(d,{...g,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:v[0],positionY:v[1],positionZ:v[2]});s.connect(y).connect(T.inputs[0]),T.connect(f);for(let e=128;e<t.length;e+=128){const t=[l[0][e],l[1][e],l[2][e]],n=[l[3][e],l[4][e],l[5][e]];if(t.some(((t,e)=>t!==m[e]))||n.some(((t,e)=>t!==v[e]))){m=t,v=n;const o=e/d.sampleRate;y.gain.setValueAtTime(0,o),y=i(d,{..._,gain:0}),T=r(d,{...g,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:v[0],positionY:v[1],positionZ:v[2]}),y.gain.setValueAtTime(1,o),s.connect(y).connect(T.inputs[0]),T.connect(f)}}return f}return v?(await t(d,p.orientationX,m.orientationX),await t(d,p.orientationY,m.orientationY),await t(d,p.orientationZ,m.orientationZ),await t(d,p.positionX,m.positionX),await t(d,p.positionY,m.positionY),await t(d,p.positionZ,m.positionZ)):(await a(d,p.orientationX,m.orientationX),await a(d,p.orientationY,m.orientationY),await a(d,p.orientationZ,m.orientationZ),await a(d,p.positionX,m.positionX),await a(d,p.positionY,m.positionY),await a(d,p.positionZ,m.positionZ)),on(m)?await h(p,d,m.inputs[0]):await h(p,d,m),m})(p,d)}}})(rr,gr,xr,ni,Kr,pn,Ui,or,Mi,Ur),Qr=((t,e,n,i,r,s,o)=>class extends t{constructor(t,a){const h=r(t),u={...ui,...a},l=n(h,u),c=s(h);super(t,!1,l,c?i():null),this._nativePannerNode=l,this._orientationX=e(this,c,l.orientationX,We,Ye),this._orientationY=e(this,c,l.orientationY,We,Ye),this._orientationZ=e(this,c,l.orientationZ,We,Ye),this._positionX=e(this,c,l.positionX,We,Ye),this._positionY=e(this,c,l.positionY,We,Ye),this._positionZ=e(this,c,l.positionZ,We,Ye),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(Yi,hr,Kr,Jr,Li,Gi,dr),ts=(t=>(e,{disableNormalization:n,imag:i,real:r})=>{const s=i instanceof Float32Array?i:new Float32Array(i),o=r instanceof Float32Array?r:new Float32Array(r),a=e.createPeriodicWave(o,s,{disableNormalization:n});if(Array.from(i).length<2)throw t();return a})(je),es=((t,e,n,i)=>class r{constructor(r,s){const o=e(r),a=i({...li,...s}),h=t(o,a);return n.add(h),h}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===r.prototype||n.has(t)}})(ts,Li,new WeakSet,(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:n}})),ns=((t,e,n,i,r,s)=>{const o=16385,a=new Float32Array([1,1]),h=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...u,oversample:"none"},c=(t,s,c,p,d)=>{if(1===s)return((t,e,r,s)=>{const c=new Float32Array(o),p=new Float32Array(o);for(let t=0;t<o;t+=1){const e=t/16384*h;c[t]=Math.cos(e),p[t]=Math.sin(e)}const d=n(t,{...u,gain:0}),f=i(t,{...l,curve:c}),m=i(t,{...l,curve:a}),_=n(t,{...u,gain:0}),g=i(t,{...l,curve:p});return{connectGraph(){e.connect(d),e.connect(void 0===m.inputs?m:m.inputs[0]),e.connect(_),m.connect(r),r.connect(void 0===f.inputs?f:f.inputs[0]),r.connect(void 0===g.inputs?g:g.inputs[0]),f.connect(d.gain),g.connect(_.gain),d.connect(s,0,0),_.connect(s,0,1)},disconnectGraph(){e.disconnect(d),e.disconnect(void 0===m.inputs?m:m.inputs[0]),e.disconnect(_),m.disconnect(r),r.disconnect(void 0===f.inputs?f:f.inputs[0]),r.disconnect(void 0===g.inputs?g:g.inputs[0]),f.disconnect(d.gain),g.disconnect(_.gain),d.disconnect(s,0,0),_.disconnect(s,0,1)}}})(t,c,p,d);if(2===s)return((t,r,s,c)=>{const p=new Float32Array(o),d=new Float32Array(o),f=new Float32Array(o),m=new Float32Array(o),_=Math.floor(8192.5);for(let t=0;t<o;t+=1)if(t>_){const e=(t-_)/(16384-_)*h;p[t]=Math.cos(e),d[t]=Math.sin(e),f[t]=0,m[t]=1}else{const e=t/(16384-_)*h;p[t]=1,d[t]=0,f[t]=Math.cos(e),m[t]=Math.sin(e)}const g=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=n(t,{...u,gain:0}),y=i(t,{...l,curve:p}),T=n(t,{...u,gain:0}),E=i(t,{...l,curve:d}),b=i(t,{...l,curve:a}),x=n(t,{...u,gain:0}),A=i(t,{...l,curve:f}),S=n(t,{...u,gain:0}),w=i(t,{...l,curve:m});return{connectGraph(){r.connect(g),r.connect(void 0===b.inputs?b:b.inputs[0]),g.connect(v,0),g.connect(T,0),g.connect(x,1),g.connect(S,1),b.connect(s),s.connect(void 0===y.inputs?y:y.inputs[0]),s.connect(void 0===E.inputs?E:E.inputs[0]),s.connect(void 0===A.inputs?A:A.inputs[0]),s.connect(void 0===w.inputs?w:w.inputs[0]),y.connect(v.gain),E.connect(T.gain),A.connect(x.gain),w.connect(S.gain),v.connect(c,0,0),x.connect(c,0,0),T.connect(c,0,1),S.connect(c,0,1)},disconnectGraph(){r.disconnect(g),r.disconnect(void 0===b.inputs?b:b.inputs[0]),g.disconnect(v,0),g.disconnect(T,0),g.disconnect(x,1),g.disconnect(S,1),b.disconnect(s),s.disconnect(void 0===y.inputs?y:y.inputs[0]),s.disconnect(void 0===E.inputs?E:E.inputs[0]),s.disconnect(void 0===A.inputs?A:A.inputs[0]),s.disconnect(void 0===w.inputs?w:w.inputs[0]),y.disconnect(v.gain),E.disconnect(T.gain),A.disconnect(x.gain),w.disconnect(S.gain),v.disconnect(c,0,0),x.disconnect(c,0,0),T.disconnect(c,0,1),S.disconnect(c,0,1)}}})(t,c,p,d);throw r()};return(e,{channelCount:i,channelCountMode:o,pan:a,...h})=>{if("max"===o)throw r();const u=t(e,{...h,channelCount:1,channelCountMode:o,numberOfInputs:2}),l=n(e,{...h,channelCount:i,channelCountMode:o,gain:1}),p=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:d,disconnectGraph:f}=c(e,i,l,p,u);Object.defineProperty(p.gain,"defaultValue",{get:()=>0}),Object.defineProperty(p.gain,"maxValue",{get:()=>1}),Object.defineProperty(p.gain,"minValue",{get:()=>-1});const m={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount!==t&&(_&&f(),({connectGraph:d,disconnectGraph:f}=c(e,t,l,p,u)),_&&d()),l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw r();l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return p.gain},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};let _=!1;return s(ti(m,u),(()=>{d(),_=!0}),(()=>{f(),_=!1}))}})(gr,Qn,ni,qr,oi,mr),is=((t,e)=>(n,i)=>{const r=i.channelCountMode;if("clamped-max"===r)throw e();if(void 0===n.createStereoPanner)return t(n,i);const s=n.createStereoPanner();return $n(s,i),Wn(s,i,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>r,set:t=>{if(t!==r)throw e()}}),s})(ns,oi),rs=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a)=>{let h=n(o);const u=Ve(h,a);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,pan:h.pan.value};h=e(a,t)}return s.set(a,h),u?await t(a,o.pan,h.pan):await i(a,o.pan,h.pan),on(h)?await r(o,a,h.inputs[0]):await r(o,a,h),h})(o,a)}}})(rr,is,pn,or,Mi),ss=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=r(t),h={...ci,...o},u=n(a,h),l=s(a);super(t,!1,u,l?i():null),this._pan=e(this,l,u.pan)}get pan(){return this._pan}})(Yi,hr,is,rs,Li,Gi),os=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!Ve(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=t(s,e)}return i.set(s,o),on(o)?await n(r,s,o.inputs[0]):await n(r,s,o),o})(r,s)}}})(qr,pn,Mi),as=((t,e,n,i,r,s,o)=>class extends t{constructor(t,e){const a=r(t),h={...pi,...e},u=n(a,h);super(t,!0,u,s(a)?i():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=u,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(Yi,Gn,qr,os,Li,Gi,dr),hs=(t=>null!==t&&t.isSecureContext)(Ii),us=(t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(Ii),ls=new WeakMap,cs=((t,e)=>n=>{let i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i})(ls,Ui),ps=hs?((t,e,n,i,r,s,o,a,h,u,l,c,p)=>{let d=0;return(f,m,_={credentials:"omit"})=>{const g=l.get(f);if(void 0!==g&&g.has(m))return Promise.resolve();const v=u.get(f);if(void 0!==v){const t=v.get(m);if(void 0!==t)return t}const y=s(f),T=void 0===y.audioWorklet?r(m).then((([t,e])=>{const[i,r]=Oe(t,e);return n(`${i};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${r}\n})})(window,'_AWGS')`)})).then((()=>{const t=p._AWGS.pop();if(void 0===t)throw new SyntaxError;i(y.currentTime,y.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const i=Se.get(y);if(void 0!==i){if(i.has(t))throw e();Pe(n),Ie(n.parameterDescriptors),i.set(t,n)}else Pe(n),Ie(n.parameterDescriptors),Se.set(y,new Map([[t,n]]))}),y.sampleRate,void 0,void 0)))})):Promise.all([r(m),Promise.resolve(t(c,c))]).then((([[t,e],n])=>{const i=d+1;d=i;const[r,s]=Oe(t,e),u=new Blob([`${r};((AudioWorkletProcessor,registerProcessor)=>{${s}\n})(${n?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${n?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${n?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${i}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),l=URL.createObjectURL(u);return y.audioWorklet.addModule(l,_).then((()=>{if(a(y))return y;const t=o(y);return t.audioWorklet.addModule(l,_).then((()=>t))})).then((t=>{if(null===h)throw new SyntaxError;try{new h(t,`__sac${i}`)}catch{throw new SyntaxError}})).finally((()=>URL.revokeObjectURL(l)))}));return void 0===v?u.set(f,new Map([[m,T]])):v.set(m,T),T.then((()=>{const t=l.get(f);void 0===t?l.set(f,new Set([m])):t.add(m)})).finally((()=>{const t=u.get(f);void 0!==t&&t.delete(m)})),T}})(Ri,oi,(t=>e=>new Promise(((n,i)=>{if(null===t)return void i(new SyntaxError);const r=t.document.head;if(null===r)i(new SyntaxError);else{const s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),h=t.onerror,u=()=>{t.onerror=h,URL.revokeObjectURL(a)};t.onerror=(e,n,r,s,o)=>n===a||n===t.location.href&&1===r&&1===s?(u(),i(o),!1):null!==h?h(e,n,r,s,o):void 0,s.onerror=()=>{u(),i(new SyntaxError)},s.onload=()=>{u(),n()},s.src=a,s.type="module",r.appendChild(s)}})))(Ii),us,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw t()})((()=>new DOMException("","AbortError"))),Li,cs,Gi,$i,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),r=URL.createObjectURL(n);let s=!1,o=!1;try{await i.audioWorklet.addModule(r);const e=new t(i,"a",{numberOfOutputs:0}),n=i.createOscillator();e.port.onmessage=()=>s=!0,e.onprocessorerror=()=>o=!0,n.connect(e),n.start(0),await i.startRendering()}catch{}finally{URL.revokeObjectURL(r)}return s&&!o})($i,Ui),Ii):void 0,ds=((t,e)=>n=>t(n)||e(n))(Xi,Gi),fs=((t,e,n,i,r,s,o,a,h,u,l)=>(c,p)=>{const d=o(c)?c:s(c);if(r.has(p)){const t=n();return Promise.reject(t)}try{r.add(p)}catch{}return e(h,(()=>h(d)))?d.decodeAudioData(p).then((n=>(Mn(p).catch((()=>{})),e(a,(()=>a(n)))||l(n),t.add(n),n))):new Promise(((e,n)=>{const r=async()=>{try{await Mn(p)}catch{}},s=t=>{n(t),r()};try{d.decodeAudioData(p,(n=>{"function"!=typeof n.copyFromChannel&&(u(n),He(n)),t.add(n),r().then((()=>e(n)))}),(t=>{s(null===t?i():t)}))}catch(t){s(t)}}))})(qi,Ri,(()=>new DOMException("","DataCloneError")),(()=>new DOMException("","EncodingError")),new WeakSet,Li,ds,Xe,jn,Qi,tr),ms=((t,e,n,i,r,s,o,a,h,u,l,c,p,d,f,m,_,g,v,y)=>class extends f{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(t,e,i){return new n({length:e,numberOfChannels:t,sampleRate:i})}createBufferSource(){return new i(this)}createChannelMerger(t=6){return new s(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new o(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new h(this)}createDelay(t=1){return new l(this,{maxDelayTime:t})}createDynamicsCompressor(){return new c(this)}createGain(){return new p(this)}createIIRFilter(t,e){return new d(this,{feedback:e,feedforward:t})}createOscillator(){return new m(this)}createPanner(){return new _(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new g(this,{...n,imag:e,real:t})}createStereoPanner(){return new v(this)}createWaveShaper(){return new y(this)}decodeAudioData(t,e,n){return u(this._nativeContext,t).then((t=>("function"==typeof e&&e(t),t)),(t=>{throw"function"==typeof n&&n(t),t}))}})(ps,zi,er,lr,fr,yr,Er,Sr,Cr,fs,Ir,Mr,Lr,kr,jr,Yr,Qr,es,ss,as),_s=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t),o=e(s,r);if(i(s))throw TypeError();super(t,!0,o,null),this._nativeMediaElementAudioSourceNode=o}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(Yi,((t,e)=>t.createMediaElementSource(e.mediaElement)),Li,Gi),gs=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t);if(i(s))throw new TypeError;const o={...Xn,...r},a=e(s,o);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(Yi,((t,e)=>{const n=t.createMediaStreamDestination();return $n(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n}),Li,Gi),vs=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t),o=e(s,r);if(i(s))throw new TypeError;super(t,!0,o,null),this._nativeMediaStreamAudioSourceNode=o}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(Yi,((t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const i=n.slice(0,1),r=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(r,"mediaStream",{value:e}),r}),Li,Gi),ys=((t,e)=>(n,{mediaStreamTrack:i})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(i);const r=new MediaStream([i]),s=n.createMediaStreamSource(r);if("audio"!==i.kind)throw t();if(e(n))throw new TypeError;return s})(Gn,Gi),Ts=((t,e,n)=>class extends t{constructor(t,i){const r=n(t);super(t,!0,e(r,i),null)}})(Yi,ys,Li),Es=((t,e,n,i,r,s,o,a,h)=>class extends t{constructor(t={}){if(null===h)throw new Error("Missing the native AudioContext constructor.");let e;try{e=new h(t)}catch(t){if(12===t.code&&"sampleRate is not in range"===t.message)throw n();throw t}if(null===e)throw i();if(!(t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t))(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:r}=t,{sampleRate:s}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===r?512/s:"interactive"===r||void 0===r?256/s:"playback"===r?1024/s:128*Math.max(2,Math.min(128,Math.round(r*s/128)))/s,this._nativeAudioContext=e,"webkitAudioContext"===h.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Qe(this)})))}createMediaElementSource(t){return new r(this,{mediaElement:t})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(t){return new o(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(ms,Gn,oi,(()=>new DOMException("","UnknownError")),_s,gs,vs,Ts,Vi),bs=(t=>e=>{const n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(Xr),xs=(t=>(e,n)=>{t(e).add(n)})(bs),As=(t=>(e,n,i=0,r=0)=>{const s=e[i];if(void 0===s)throw t();return vn(n)?s.connect(n,0,r):s.connect(n,0)})(je),Ss=(t=>(e,n)=>{t(e).delete(n)})(bs),ws=(t=>(e,n,i,r=0)=>void 0===n?e.forEach((t=>t.disconnect())):"number"==typeof n?Ln(t,e,n).disconnect():vn(n)?void 0===i?e.forEach((t=>t.disconnect(n))):void 0===r?Ln(t,e,i).disconnect(n,0):Ln(t,e,i).disconnect(n,0,r):void 0===i?e.forEach((t=>t.disconnect(n))):Ln(t,e,i).disconnect(n,0))(je),Rs=new WeakMap,Cs=((t,e)=>n=>e(t,n))(Rs,Ne),Os=((t,e,n,i,r,s,o,a,h,u,l,c,p)=>(d,f,m,_)=>{if(0===_.numberOfInputs&&0===_.numberOfOutputs)throw h();const g=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(g.some((t=>t<1)))throw h();if(g.length!==_.numberOfOutputs)throw e();if("explicit"!==_.channelCountMode)throw h();const v=_.channelCount*_.numberOfInputs,y=g.reduce(((t,e)=>t+e),0),T=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(v+T>6||y>6)throw h();const E=new MessageChannel,b=[],x=[];for(let t=0;t<_.numberOfInputs;t+=1)b.push(o(d,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),x.push(r(d,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const A=[];if(void 0!==m.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:i}of m.parameterDescriptors){const r=s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==_.parameterData[i]?_.parameterData[i]:void 0===t?0:t});Object.defineProperties(r.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?We:e},minValue:{get:()=>void 0===n?Ye:n}}),A.push(r)}const S=i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+T)}),w=Zn(f,d.sampleRate),R=a(d,w,v+T,Math.max(1,y)),C=r(d,{channelCount:Math.max(1,y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,y)}),O=[];for(let t=0;t<_.numberOfOutputs;t+=1)O.push(i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[t]}));for(let t=0;t<_.numberOfInputs;t+=1){b[t].connect(x[t]);for(let e=0;e<_.channelCount;e+=1)x[t].connect(S,e,t*_.channelCount+e)}const I=new bn(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((({name:t},e)=>{const n=A[e];return n.connect(S,0,v+e),n.start(0),[t,n.offset]})));S.connect(R);let P=_.channelInterpretation,N=null;const M=0===_.numberOfOutputs?[R]:O,D={get bufferSize(){return w},get channelCount(){return _.channelCount},set channelCount(t){throw n()},get channelCountMode(){return _.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return P},set channelInterpretation(t){for(const e of b)e.channelInterpretation=t;P=t},get context(){return R.context},get inputs(){return b},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get onprocessorerror(){return N},set onprocessorerror(t){"function"==typeof N&&D.removeEventListener("processorerror",N),N="function"==typeof t?t:null,"function"==typeof N&&D.addEventListener("processorerror",N)},get parameters(){return I},get port(){return E.port2},addEventListener:(...t)=>R.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,M),disconnect:u.bind(null,M),dispatchEvent:(...t)=>R.dispatchEvent(t[0]),removeEventListener:(...t)=>R.removeEventListener(t[0],t[1],t[2])},L=new Map;var F,U;E.port1.addEventListener=(F=E.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=L.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{l(d.currentTime,d.sampleRate,(()=>e(t)))},L.set(e,t[1]))}}return F.call(E.port1,t[0],t[1],t[2])}),E.port1.removeEventListener=(U=E.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=L.get(t[1]);void 0!==e&&(L.delete(t[1]),t[1]=e)}return U.call(E.port1,t[0],t[1],t[2])});let G=null;Object.defineProperty(E.port1,"onmessage",{get:()=>G,set:t=>{"function"==typeof G&&E.port1.removeEventListener("message",G),G="function"==typeof t?t:null,"function"==typeof G&&(E.port1.addEventListener("message",G),E.port1.start())}}),m.prototype.port=E.port1;let B=null;const k=((t,e,n,i)=>{let r=we.get(t);void 0===r&&(r=new WeakMap,we.set(t,r));const s=Kn(n,i);return r.set(e,s),s})(d,D,m,_);k.then((t=>B=t));const V=wn(_.numberOfInputs,_.channelCount),X=wn(_.numberOfOutputs,g),j=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce(((t,{name:e})=>({...t,[e]:new Float32Array(128)})),{});let H=!0;const $=()=>{_.numberOfOutputs>0&&R.disconnect(C);for(let t=0,e=0;t<_.numberOfOutputs;t+=1){const n=O[t];for(let i=0;i<g[t];i+=1)C.disconnect(n,e+i,i);e+=g[t]}},Y=new Map;R.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==B){const n=c(D);for(let i=0;i<w;i+=128){for(let e=0;e<_.numberOfInputs;e+=1)for(let n=0;n<_.channelCount;n+=1)An(t,V[e],n,n,i);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((({name:e},n)=>{An(t,j,e,v+n,i)}));for(let t=0;t<_.numberOfInputs;t+=1)for(let e=0;e<g[t];e+=1)0===X[t][e].byteLength&&(X[t][e]=new Float32Array(128));try{const t=V.map(((t,e)=>{if(n[e].size>0)return Y.set(e,w/128),t;const i=Y.get(e);return void 0===i?[]:(t.every((t=>t.every((t=>0===t))))&&(1===i?Y.delete(e):Y.set(e,i-1)),t)})),r=l(d.currentTime+i/d.sampleRate,d.sampleRate,(()=>B.process(t,X,j)));H=r;for(let t=0,n=0;t<_.numberOfOutputs;t+=1){for(let r=0;r<g[t];r+=1)Sn(e,X[t],r,n+r,i);n+=g[t]}}catch(t){H=!1,D.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!H){for(let t=0;t<_.numberOfInputs;t+=1){b[t].disconnect(x[t]);for(let e=0;e<_.channelCount;e+=1)x[i].disconnect(S,e,t*_.channelCount+e)}if(void 0!==m.parameterDescriptors){const t=m.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=A[e];t.disconnect(S,0,v+e),t.stop()}}S.disconnect(R),R.onaudioprocess=null,W?$():Z();break}}}};let W=!1;const z=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),q=()=>R.connect(z).connect(d.destination),Z=()=>{R.disconnect(z),z.disconnect()};return q(),p(D,(()=>{if(H){Z(),_.numberOfOutputs>0&&R.connect(C);for(let t=0,e=0;t<_.numberOfOutputs;t+=1){const n=O[t];for(let i=0;i<g[t];i+=1)C.connect(n,e+i,i);e+=g[t]}}W=!0}),(()=>{H&&(q(),$()),W=!1}))})(As,je,Gn,gr,Qn,xr,ni,si,oi,ws,us,Cs,mr),Is=((t,e,n,i,r)=>(s,o,a,h,u,l)=>{if(null!==a)try{const e=new a(s,h,l),i=new Map;let o=null;if(Object.defineProperties(e,{channelCount:{get:()=>l.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>o,set:t=>{"function"==typeof o&&e.removeEventListener("processorerror",o),o="function"==typeof t?t:null,"function"==typeof o&&e.addEventListener("processorerror",o)}}}),e.addEventListener=(p=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=i.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}))},i.set(e,t[1]))}}return p.call(e,"error",t[1],t[2]),p.call(e,...t)}),e.removeEventListener=(c=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=i.get(t[1]);void 0!==e&&(i.delete(t[1]),t[1]=e)}return c.call(e,"error",t[1],t[2]),c.call(e,t[0],t[1],t[2])}),0!==l.numberOfOutputs){const t=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(s.destination);return r(e,(()=>t.disconnect()),(()=>t.connect(s.destination)))}return e}catch(t){if(11===t.code)throw i();throw t}var c,p;if(void 0===u)throw i();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(l),e(s,o,u,l)})(Gn,Os,ni,oi,mr),Ps=((t,e,n,i,r,s,o,a,h,u,l,c,p,d,f,m)=>(_,g,v)=>{const y=new WeakMap;let T=null;return{render(E,b){a(b,E);const x=y.get(b);return void 0!==x?Promise.resolve(x):(async(a,E)=>{let b=l(a),x=null;const A=Ve(b,E),S=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===c){const t=S.reduce(((t,e)=>t+e),0),n=r(E,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),s=[];for(let t=0;t<a.numberOfOutputs;t+=1)s.push(i(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:S[t]}));const u=o(E,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});u.connect=e.bind(null,s),u.disconnect=h.bind(null,s),x=[n,s,u]}else A||(b=new c(E,_));if(y.set(E,null===x?b:x[2]),null!==x){if(null===T){if(void 0===v)throw new Error("Missing the processor constructor.");if(null===p)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===v.parameterDescriptors?0:v.parameterDescriptors.length,n=t+e,h=async()=>{const h=new p(n,128*Math.ceil(a.context.length/128),E.sampleRate),u=[],l=[];for(let t=0;t<g.numberOfInputs;t+=1)u.push(o(h,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),l.push(r(h,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const c=await Promise.all(Array.from(a.parameters.values()).map((async t=>{const e=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await d(h,t,e.offset),e}))),_=i(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<g.numberOfInputs;t+=1){u[t].connect(l[t]);for(let e=0;e<g.channelCount;e+=1)l[t].connect(_,e,t*g.channelCount+e)}for(const[e,n]of c.entries())n.connect(_,0,t+e),n.start(0);return _.connect(h.destination),await Promise.all(u.map((t=>f(a,h,t)))),m(h)};T=Rn(a,0===n?null:await h(),E,g,S,v,u)}const t=await T,e=n(E,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[h,l,c]=x;null!==t&&(e.buffer=t,e.start(0)),e.connect(h);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const n=l[t];for(let i=0;i<S[t];i+=1)h.connect(n,e+i,i);e+=S[t]}return c}if(A)for(const[e,n]of a.parameters.entries())await t(E,n,b.parameters.get(e));else for(const[t,e]of a.parameters.entries())await d(E,e,b.parameters.get(t));return await f(a,E,b),b})(E,b)}}})(rr,As,sr,gr,Qn,xr,ni,Ss,ws,us,pn,$i,Ui,or,Mi,Ur),Ns=(t=>e=>t.get(e))(ls),Ms=(t=>(e,n)=>{t.set(e,n)})(Rs),Ds=hs?((t,e,n,i,r,s,o,a,h,u,l,c,p,d)=>class extends e{constructor(e,d,f){var m;const _=a(e),g=h(_),v=l({...xn,...f});p(v);const y=Se.get(_),T=null==y?void 0:y.get(d),E=g||"closed"!==_.state?_:null!==(m=o(_))&&void 0!==m?m:_,b=r(E,g?null:e.baseLatency,u,d,T,v);super(e,!0,b,g?i(d,v,T):null);const x=[];b.parameters.forEach(((t,e)=>{const i=n(this,g,t);x.push([e,i])})),this._nativeAudioWorkletNode=b,this._onprocessorerror=null,this._parameters=new bn(x),g&&t(_,this);const{activeInputs:A}=s(this);c(b,A)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?d(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(xs,Yi,hr,Ps,Is,Ze,Ns,Li,Gi,$i,(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))})),Ms,(t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}}),Ei):void 0,Ls=((t,e)=>(n,i,r)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(oi,Ui),Fs=((t,e,n,i,r,s,o,a)=>(h,u)=>n(h).render(h,u).then((()=>Promise.all(Array.from(i(u)).map((t=>n(t).render(t,u)))))).then((()=>r(u))).then((n=>("function"!=typeof n.copyFromChannel?(o(n),He(n)):e(s,(()=>s(n)))||a(n),t.add(n),n))))(qi,Ri,Ni,bs,Ur,Xe,Qi,tr),Us=((t,e,n,i,r)=>class extends t{constructor(t,n,r){let s;if("number"==typeof t&&void 0!==n&&void 0!==r)s={length:n,numberOfChannels:t,sampleRate:r};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");s=t}const{length:o,numberOfChannels:a,sampleRate:h}={...ai,...s},u=i(a,o,h);e(jn,(()=>jn(u)))||u.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(u.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(u,a),this._length=o,this._nativeOfflineAudioContext=u,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,Qe(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(ms,Ri,Gn,Ls,Fs),Gs=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(be,Xi),Bs=((t,e)=>n=>t.has(n)||e(n))(ye,ji),ks=((t,e)=>n=>t.has(n)||e(n))(Ee,Hi),Vs=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(be,Gi);function Xs(t,e){if(!t)throw new Error(e)}function js(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function Hs(t){t.isOffline||"running"===t.state||Ys('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let $s=console;function Ys(...t){$s.warn(...t)}function Ws(t){return void 0===t}function zs(t){return!Ws(t)}function qs(t){return"number"==typeof t}function Zs(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function Ks(t){return Array.isArray(t)}function Js(t){return"string"==typeof t}function Qs(t){return Js(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}const to="object"==typeof self?self:null,eo=to&&(to.hasOwnProperty("AudioContext")||to.hasOwnProperty("webkitAudioContext"));
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
function no(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o}function io(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((i=i.apply(t,e||[])).next())}))}class ro{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function so(t){return ks(t)}function oo(t){return Bs(t)}function ao(t){return Vs(t)}function ho(t){return Gs(t)}function uo(t){return t instanceof AudioBuffer}function lo(t,e){return"value"===t||so(e)||oo(e)||uo(e)}function co(t,...e){if(!e.length)return t;const n=e.shift();if(Zs(t)&&Zs(n))for(const e in n)lo(e,n[e])?t[e]=n[e]:Zs(n[e])?(t[e]||Object.assign(t,{[e]:{}}),co(t[e],n[e])):Object.assign(t,{[e]:n[e]});return co(t,...e)}function po(t,e,n=[],i){const r={},s=Array.from(e);if(Zs(s[0])&&i&&!Reflect.has(s[0],i)){Object.keys(s[0]).some((e=>Reflect.has(t,e)))||(co(r,{[i]:s[0]}),n.splice(n.indexOf(i),1),s.shift())}if(1===s.length&&Zs(s[0]))co(r,s[0]);else for(let t=0;t<n.length;t++)zs(s[t])&&(r[n[t]]=s[t]);return co(t,r)}function fo(t,e){return Ws(t)?e:t}function mo(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}
/**
     * Tone.js
     * @author Yotam Mann
     * @license http://opensource.org/licenses/MIT MIT License
     * @copyright 2014-2019 Yotam Mann
     */class _o{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||to&&this.toString()===to.TONE_DEBUG_CLASS)&&function(...t){$s.log(...t)}(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}_o.version=re;const go=1e-6;function vo(t,e){return t>e+go}function yo(t,e){return vo(t,e)||Eo(t,e)}function To(t,e){return t+go<e}function Eo(t,e){return Math.abs(t-e)<go}class bo extends _o{constructor(){super(),this.name="Timeline",this._timeline=[];const t=po(bo.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(Xs(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];Xs(yo(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Eo(this._timeline[e].time,t)){for(let n=e;n>=0&&Eo(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&yo(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const i=this._timeline.length;let r=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<r;){let i=Math.floor(n+(r-n)/2);const s=this._timeline[i],o=this._timeline[i+1];if(Eo(s[e],t)){for(let n=i;n<this._timeline.length;n++){if(!Eo(this._timeline[n][e],t))break;i=n}return i}if(To(s[e],t)&&vo(o[e],t))return i;vo(s[e],t)?r=i:n=i+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),r=this._search(e);return-1!==i&&-1!==r?(this._timeline[i].time!==t&&(i+=1),this._timeline[r].time===e&&(r-=1),this._iterate(n,i,r)):-1===i&&this._iterate(n,0,r),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&Eo(this._timeline[n].time,t)){let i=n;for(let e=n;e>=0&&Eo(this._timeline[e].time,t);e--)i=e;this._iterate((t=>{e(t)}),i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const xo=[];function Ao(t){xo.push(t)}const So=[];function wo(t){So.push(t)}class Ro extends _o{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{Ws(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){const n=(...i)=>{e(...i),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach((n=>{if(Ws(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(Ws(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}})),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,i=n.length;t<i;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const n=Object.getOwnPropertyDescriptor(Ro.prototype,e);Object.defineProperty(t.prototype,e,n)}))}dispose(){return super.dispose(),this._events=void 0,this}}class Co extends Ro{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Oo extends Co{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new bo,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=po(Oo.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new Es(t)}({latencyHint:t.latencyHint}),this._ticker=new ro(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,xo.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){Xs(ho(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaElementSource(t){Xs(ho(this._context),"Not available if OfflineAudioContext");return this._context.createMediaElementSource(t)}createMediaStreamDestination(){Xs(ho(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){Xs(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){Xs(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){Xs(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){Xs(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){return Xs(zs(Ds),"This node only works in a secure context (https or localhost)"),new Ds(t,e,n)}(this.rawContext,t,e)}addAudioWorkletModule(t,e){return io(this,void 0,void 0,(function*(){Xs(zs(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return io(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach((e=>t.push(e))),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,Js(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return ho(this._context)?this._context.resume():Promise.resolve()}close(){return io(this,void 0,void 0,(function*(){var t;ho(this._context)&&(yield this._context.close()),this._initialized&&(t=this,So.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,i=()=>{const r=this.now();this._timeouts.add({callback:()=>{t(),i()},id:n,time:r+e})};return i(),n}}function Io(t,e){Ks(e)?e.forEach((e=>Io(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function Po(t,e){Ks(e)?e.forEach((e=>Po(t,e))):Object.defineProperty(t,e,{writable:!0})}const No=()=>{};class Mo extends _o{constructor(){super(),this.name="ToneAudioBuffer",this.onload=No;const t=po(Mo.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&uo(t.url)||t.url instanceof Mo?this.set(t.url):Js(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:No,onload:No,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Uo().sampleRate}set(t){return t instanceof Mo?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return io(this,void 0,void 0,(function*(){const e=Mo.load(t).then((t=>{this.set(t),this.onload(this)}));Mo.downloads.push(e);try{yield e}finally{const t=Mo.downloads.indexOf(e);Mo.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=Ks(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,r=Uo(),s=r.createBuffer(n,i,r.sampleRate),o=e||1!==n?t:[t];for(let t=0;t<n;t++)s.copyToChannel(o[t],t);return this._buffer=s,this}toMono(t){if(qs(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(qs(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);Xs(n<i,"The start time must be less than the end time");const r=i-n,s=Uo().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)s.copyToChannel(this.getChannelData(t).subarray(n,i),t);return new Mo(s)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new Mo).fromArray(t)}static fromUrl(t){return io(this,void 0,void 0,(function*(){const e=new Mo;return yield e.load(t)}))}static load(t){return io(this,void 0,void 0,(function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const n=e[1].split("|");let i=n[0];for(const t of n)if(Mo.supportsType(t)){i=t;break}t=t.replace(e[0],i)}const n=""===Mo.baseUrl||Mo.baseUrl.endsWith("/")?Mo.baseUrl:Mo.baseUrl+"/",i=yield fetch(n+t);if(!i.ok)throw new Error(`could not load url: ${t}`);const r=yield i.arrayBuffer();return yield Uo().decodeAudioData(r)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return io(this,void 0,void 0,(function*(){for(yield Promise.resolve();Mo.downloads.length;)yield Mo.downloads[0]}))}}Mo.baseUrl="",Mo.downloads=[];class Do extends Oo{constructor(){var t,e,n;super({clockSource:"offline",context:ao(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new Us(t,e,n)),lookAhead:0,updateInterval:ao(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=ao(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return io(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(t=!0){return io(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new Mo(e)}))}close(){return Promise.resolve()}}const Lo=new class extends Co{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return io(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let Fo=Lo;function Uo(){return Fo===Lo&&eo&&function(t){Fo=ho(t)?new Oo(t):ao(t)?new Do(t):t}(new Oo),Fo}if(to&&!to.TONE_SILENCE_LOGGING){const t=` * Tone.js ${"v"}14.7.77 * `;console.log(`%c${t}`,"background: #000; color: #fff")}function Go(t){return Math.log(t)/Math.LN10*20}function Bo(t){return Math.pow(2,t/12)}let ko=440;function Vo(t){return Math.round(Xo(t))}function Xo(t){return 69+12*Math.log2(t/ko)}class jo extends _o{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),i="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof jo&&this.fromType(this._val),Ws(this._val))return this._noArg();if(Js(this._val)&&Ws(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Zs(this._val)){let t=0;for(const e in this._val)if(zs(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(zs(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return Js(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class Ho extends jo{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new Ho(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],i=new Ho(this.context,e[0]).toSeconds();return e.forEach((e=>{const r=new Ho(this.context,e).toSeconds();Math.abs(r-t)<Math.abs(i-t)&&(n=e,i=r)})),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let i=e%1*4;e=Math.floor(e)%this._getTimeSignature();const r=i.toString();r.length>3&&(i=parseFloat(parseFloat(r).toFixed(3)));return[n,e,i].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Vo(this.toFrequency())}_now(){return this.context.now()}}class $o extends Ho{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return ko}static set A4(t){!function(t){ko=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:$o.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=Yo[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:$o.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new $o(this.context,this.valueOf()*Bo(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return Vo(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/$o.A4);let n=Math.round(12*e)+57;const i=Math.floor(n/12);i<0&&(n+=-12*i);return Wo[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return function(t){return ko*Math.pow(2,(t-69)/12)}(t)}static ftom(t){return Vo(t)}}const Yo={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Wo=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class zo extends Ho{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class qo extends _o{constructor(){super();const t=po(qo.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Uo()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new Ho(this.context,t).toSeconds()}toFrequency(t){return new $o(this.context,t).toFrequency()}toTicks(t){return new zo(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((n=>{Ws(t[n])&&delete e[n]})),e}get(){const t=function(t){return t.constructor.getDefaults()}(this);return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const n=this[e];zs(n)&&zs(n.value)&&zs(n.setValueAtTime)?t[e]=n.value:n instanceof qo?t[e]=n._getPartialProperties(t[e]):Ks(n)||qs(n)||Js(n)||"boolean"==typeof n?t[e]=n:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&zs(this[e])&&(this[e]&&zs(this[e].value)&&zs(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof qo?this[e].set(t[e]):this[e]=t[e])})),this}}class Zo extends bo{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return js(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n}}}class Ko extends qo{constructor(){super(po(Ko.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=po(Ko.getDefaults(),arguments,["param","units","convert"]);for(Xs(zs(t.param)&&(so(t.param)||t.param instanceof Ko),"param must be an AudioParam");!so(t.param);)t.param=t.param._param;this._swappable=!!zs(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new bo(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,zs(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(qo.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return zs(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return zs(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return zs(this.maxValue)&&zs(this.minValue)&&js(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?(e=t,Math.pow(10,e/20)):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t;var e}_toType(t){return this.convert&&"decibels"===this.units?Go(t):t}setValueAtTime(t,e){const n=this.toSeconds(e),i=this._fromType(t);return Xs(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e);let r=this._initialValue;if(null===i)r=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)r=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=i.value;if("setTargetAtTime"===i.type){const e=this._events.getBefore(i.time);t=null===e?this._initialValue:e.value}r="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,t,n.time,n.value,e):this._exponentialInterpolate(i.time,t,n.time,n.value,e)}else r=i.value;else{const t=this._events.getBefore(i.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===i.type&&(r=this._exponentialApproach(i.time,n,i.value,i.constant,e))}return this._toType(r)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),i=this.toSeconds(e);return Xs(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=Eo(n,0)?this._minOutput:n,this._assertRange(n);const i=this.toSeconds(e);return Xs(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const i=this._fromType(t);Xs(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(e);return this._assertRange(i),Xs(isFinite(i)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,r,n),this._param.setTargetAtTime(i,r,n),this}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);const r=this._fromType(t[0])*i;this.setValueAtTime(this._toType(r),e);const s=n/(t.length-1);for(let n=1;n<t.length;n++){const r=this._fromType(t[n])*i;this.linearRampToValueAtTime(this._toType(r),e+n*s)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return Xs(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));Xs(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const i=this._events.get(e),r=this._events.getAfter(e);return i&&Eo(i.time,e)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),"linearRampToValueAtTime"===r.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const i=this._events.getAfter(n.time),r=i?i.time:e+2,s=(r-e)/10;for(let n=e;n<r;n+=s)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){Xs(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,r){return n+(e-n)*Math.exp(-(r-t)/i)}_linearInterpolate(t,e,n,i,r){return e+(r-t)/(n-t)*(i-e)}_exponentialInterpolate(t,e,n,i,r){return e*Math.pow(i/e,(r-t)/(n-t))}}class Jo extends qo{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return zs(this.input)?so(this.input)||this.input instanceof Ko?1:this.input.numberOfInputs:0}get numberOfOutputs(){return zs(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return zs(t)&&(t instanceof Jo||oo(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();Xs(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return ta(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Ys("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return function(t,e,n=0,i=0){if(zs(e))for(;e instanceof Jo;)e=e.input;for(;!oo(t);)zs(t.output)&&(t=t.output);so(e)?t.disconnect(e,n):oo(e)?t.disconnect(e,n,i):t.disconnect()}(this,t,e,n),this}chain(...t){return Qo(this,...t),this}fan(...t){return t.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),zs(this.input)&&(this.input instanceof Jo?this.input.dispose():oo(this.input)&&this.input.disconnect()),zs(this.output)&&(this.output instanceof Jo?this.output.dispose():oo(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Qo(...t){const e=t.shift();t.reduce(((t,e)=>(t instanceof Jo?t.connect(e):oo(t)&&ta(t,e),e)),e)}function ta(t,e,n=0,i=0){for(Xs(zs(t),"Cannot connect from undefined node"),Xs(zs(e),"Cannot connect to undefined node"),(e instanceof Jo||oo(e))&&Xs(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Xs(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Jo||e instanceof Ko;)zs(e.input)&&(e=e.input);for(;t instanceof Jo;)zs(t.output)&&(t=t.output);so(e)?t.connect(e,n):t.connect(e,n,i)}class ea extends Jo{constructor(){super(po(ea.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=po(ea.getDefaults(),arguments,["gain","units"]);this.gain=new Ko({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),Io(this,"gain")}static getDefaults(){return Object.assign(Jo.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class na extends Jo{constructor(t){super(t),this.onended=No,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new ea({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Jo.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:No})}_startGain(t,e=1){Xs(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){Xs(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==No&&(this.onended(this),this.onended=No,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Xs(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class ia extends na{constructor(){super(po(ia.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=po(ia.getDefaults(),arguments,["offset"]);ta(this._source,this._gainNode),this.offset=new Ko({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(na.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class ra extends Jo{constructor(){super(po(ra.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=po(ra.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new ia({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Jo.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return sa(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function sa(t,e,n,i){(e instanceof Ko||so(e)||e instanceof ra&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof ra&&(e.overridden=!0)),ta(t,e,n,i)}class oa extends Ko{constructor(){super(po(oa.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new bo(1/0),this._multiplier=1;const t=po(oa.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Ko.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const i=this._fromType(t),r=this._events.get(e),s=Math.round(Math.max(1/n,1));for(let t=0;t<=s;t++){const s=n*t+e,o=this._exponentialApproach(r.time,r.value,i,n,s);this.linearRampToValueAtTime(this._toType(o),s)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),i=this._events.get(e),r=Math.round(Math.max(10*(e-i.time),1)),s=(e-i.time)/r;for(let t=0;t<=r;t++){const r=s*t+i.time,o=this._exponentialInterpolate(i.time,i.value,e,n,r);this.linearRampToValueAtTime(this._toType(o),r)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Ws(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let i=this._fromType(this.getValueAtTime(e));const r=this._events.get(e);return r&&r.time===e&&"setValueAtTime"===r.type&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const i=this._fromType(this.getValueAtTime(e.time)),r=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),s=Math.sqrt(Math.pow(i,2)-2*r*(e.ticks-t)),o=(-i+s)/r,a=(-i-s)/r;return(o>0?o:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),i=this.toSeconds(t),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-r}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class aa extends ra{constructor(){super(po(aa.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=po(aa.getDefaults(),arguments,["value"]);this.input=this._param=new oa({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(ra.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class ha extends qo{constructor(){super(po(ha.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Zo,this._tickOffset=new bo;const t=po(ha.getDefaults(),arguments,["frequency"]);this.frequency=new aa({context:this.context,units:t.units,value:t.frequency}),Io(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},qo.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),zs(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let r=n,s=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(t=>{let e=r.time;const n=this._tickOffset.get(t.time);n&&n.time>=r.time&&(s=n.ticks,e=n.time),"started"===r.state&&"started"!==t.state&&(s+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),r=t})),this._state.remove(i),s}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=e,r=0;return this._state.forEachBetween(e.time,t+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(r=n.seconds,e=n.time),"started"===i.state&&"started"!==t.state&&(r+=t.time-e),i=t})),this._state.remove(n),r}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),i=this._state.get(e),r=Math.max(n.time,i.time),s=this.frequency.getTicksAtTime(r)+t-n.ticks;return this.frequency.getTimeOfTick(s)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,(e=>{i&&"started"===i.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(i.time,t),e.time-this.sampleTime,n),i=e}));let r=null;if(i&&"started"===i.state){const s=Math.max(i.time,t),o=this.frequency.getTicksAtTime(s),a=o-this.frequency.getTicksAtTime(i.time);let h=Math.ceil(a)-a;h=Eo(h,1)?0:h;let u=this.frequency.getTimeOfTick(o+h);for(;u<e;){try{n(u,Math.round(this.getTicksAtTime(u)))}catch(t){r=t;break}u+=this.frequency.getDurationOfTicks(1,u)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class ua extends qo{constructor(){super(po(ua.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=No,this._lastUpdate=0,this._state=new Zo("stopped"),this._boundLoop=this._loop.bind(this);const t=po(ua.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new ha({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Io(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(qo.getDefaults(),{callback:No,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){Hs(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Ro.mixin(ua);class la extends _o{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=po(la.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:No,onload:No,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return Xs(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((([t,e])=>e.loaded))}add(t,e,n=No,i=No){return Js(e)?this._buffers.set(t.toString(),new Mo(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new Mo(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}class ca extends zo{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class pa extends qo{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new bo,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Ao((t=>{t.draw=new pa({context:t})})),wo((t=>{t.draw.dispose()}));class da extends _o{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){Xs(zs(t.time),"Events must have a time property"),Xs(zs(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new fa(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class fa{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class ma extends Jo{constructor(){super(po(ma.getDefaults(),arguments,["volume"])),this.name="Volume";const t=po(ma.getDefaults(),arguments,["volume"]);this.input=this.output=new ea({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,Io(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Jo.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class _a extends Jo{constructor(){super(po(_a.getDefaults(),arguments)),this.name="Destination",this.input=new ma({context:this.context}),this.output=new ea({context:this.context}),this.volume=this.input.volume;const t=po(_a.getDefaults(),arguments);Qo(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Jo.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Qo(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Ao((t=>{t.destination=new _a({context:t})})),wo((t=>{t.destination.dispose()}));class ga extends _o{constructor(t){super(),this.name="TimelineValue",this._timeline=new bo({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class va{constructor(t,e){this.id=va._eventId++;const n=Object.assign(va.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:No,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}va._eventId=0;class ya extends va{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(ya.getDefaults(),e);this.duration=new ca(t.context,n.duration).valueOf(),this._interval=new ca(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},va.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new ca(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new ca(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new ca(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class Ta extends qo{constructor(){super(po(Ta.getDefaults(),arguments)),this.name="Transport",this._loop=new ga(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new bo,this._repeatedEvents=new da,this._syncedSignals=[],this._swingAmount=0;const t=po(Ta.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new ua({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),Io(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(qo.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new ca(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(e,(e=>e.invoke(t)))}schedule(t,e){const n=new va(this,{callback:t,time:new zo(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,i=1/0){const r=new ya(this,{callback:t,duration:new Ho(this.context,i).toTicks(),interval:new Ho(this.context,e).toTicks(),time:new zo(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(t,e){const n=new va(this,{callback:t,once:!0,time:new zo(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new ca(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return zs(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){Ks(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new Ho(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new Ho(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new ca(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new ca(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}const n=new ea(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Po(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Ro.mixin(Ta),Ao((t=>{t.transport=new Ta({context:t})})),wo((t=>{t.transport.dispose()}));class Ea extends Jo{constructor(t){super(t),this.input=void 0,this._state=new Zo("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=No,this._syncedStop=No,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new ma({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,Io(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Jo.getDefaults(),{mute:!1,onstop:No,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=Ws(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const t=this._state.get(i);t&&(t.offset=this.toSeconds(fo(e,0)),t.duration=n?this.toSeconds(n):void 0);const r=this.context.transport.schedule((t=>{this._start(t,e,n)}),i);this._scheduled.push(r),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else Hs(this.context),this._start(i,e,n);else Xs(vo(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}stop(t){let e=Ws(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||zs(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const i=e-this.toSeconds(n.time);let r;n.duration&&(r=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,r)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=No,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class ba extends na{constructor(){super(po(ba.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=po(ba.getDefaults(),arguments,["url","onload"]);ta(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Ko({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new Mo(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(na.getDefaults(),{url:new Mo,loop:!1,loopEnd:0,loopStart:0,onload:No,onerror:No,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,i=1){Xs(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(t);this._startGain(r,i),e=this.loop?fo(e,this.loopStart):fo(e,0);let s=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;yo(s,t)&&(s=(s-e)%n+e),Eo(s,this.buffer.duration)&&(s=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,To(s,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,s)),zs(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(r+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function xa(t,e){return io(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,i=new Do(1,n,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0);return(yield i.render()).getChannelData(0)}))}class Aa extends na{constructor(){super(po(Aa.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=po(Aa.getDefaults(),arguments,["frequency","type"]);ta(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new Ko({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new Ko({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),Io(this,["frequency","detune"])}static getDefaults(){return Object.assign(na.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Sa extends Ea{constructor(){super(po(Sa.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=po(Sa.getDefaults(),arguments,["frequency","type"]);this.frequency=new ra({context:this.context,units:"frequency",value:t.frequency}),Io(this,"frequency"),this.detune=new ra({context:this.context,units:"cents",value:t.detune}),Io(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(Ea.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new Aa({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){const t=Sa._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every(((t,e)=>n[e]===t)));var e,n}));return t}{const t=Sa._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(zs(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),Sa._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),Sa._periodicWaveCache.length>100&&Sa._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){js(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,n)=>e[n]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const i=new Float32Array(n),r=new Float32Array(n);let s=1;if("custom"===t){if(s=this._partials.length+1,this._partialCount=this._partials.length,n=s,0===this._partials.length)return[i,r]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(s=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],s=Math.max(s,2),n=s):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let a;switch(t){case"sine":a=o<=s?1:0,this._partials[o-1]=a;break;case"square":a=1&o?2*n:0,this._partials[o-1]=a;break;case"sawtooth":a=n*(1&o?1:-1),this._partials[o-1]=a;break;case"triangle":a=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=a;break;case"custom":a=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(i[o]=-a*Math.sin(e*o),r[o]=a*Math.cos(e*o)):(i[o]=0,r[o]=0)}return[i,r]}_inverseFFT(t,e,n){let i=0;const r=t.length;for(let s=0;s<r;s++)i+=t[s]*Math.cos(s*n)+e[s]*Math.sin(s*n);return i}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const i=2*Math.PI;for(let r=0;r<32;r++)n=Math.max(this._inverseFFT(t,e,r/32*i),n);return r=-this._inverseFFT(t,e,this._phase)/n,s=-1,o=1,Math.max(Math.min(r,o),s);var r,s,o}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return io(this,void 0,void 0,(function*(){return xa(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Sa._periodicWaveCache=[];class wa extends Jo{constructor(){super(Object.assign(po(wa.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return sa(this,t,e,n),this}}class Ra extends wa{constructor(){super(Object.assign(po(Ra.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=po(Ra.getDefaults(),arguments,["mapping","length"]);Ks(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):"function"==typeof t.mapping&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(ra.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let i=0,r=e;i<r;i++){const e=i/(r-1)*2-1;n[i]=t(e,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){Xs(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class Ca extends wa{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Ra({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Oa extends ra{constructor(){super(Object.assign(po(Oa.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=po(Oa.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new ea({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(ra.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Ia extends Ea{constructor(){super(po(Ia.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new Ca({context:this.context}),this._modulationNode=new ea({context:this.context});const t=po(Ia.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Sa({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Sa({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Oa({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Io(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Sa.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return io(this,void 0,void 0,(function*(){return xa(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class Pa extends Ea{constructor(){super(po(Pa.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new ea({context:this.context,gain:0});const t=po(Pa.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Sa({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new ra({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new Sa({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Oa({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new Oa({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Io(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Sa.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return io(this,void 0,void 0,(function*(){return xa(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Na extends Ea{constructor(){super(po(Na.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new ea({context:this.context,gain:0}),this._thresh=new Ra({context:this.context,mapping:t=>t<=0?-1:1});const t=po(Na.getDefaults(),arguments,["frequency","width"]);this.width=new ra({context:this.context,units:"audioRange",value:t.width}),this._triangle=new Sa({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Io(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Ea.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return io(this,void 0,void 0,(function*(){return xa(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Ma extends Ea{constructor(){super(po(Ma.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=po(Ma.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new ra({context:this.context,units:"frequency",value:t.frequency}),this.detune=new ra({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,Io(this,["frequency","detune"])}static getDefaults(){return Object.assign(Sa.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach(((t,i)=>t.detune.value=e+n*i))}}get count(){return this._oscillators.length}set count(t){if(js(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const n=new Sa({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):No});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(t=1024){return io(this,void 0,void 0,(function*(){return xa(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class Da extends Ea{constructor(){super(po(Da.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Oa({context:this.context,value:2});const t=po(Da.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Na({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Sa({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Io(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Ea.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return io(this,void 0,void 0,(function*(){return xa(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const La={am:Ia,fat:Ma,fm:Pa,oscillator:Sa,pulse:Na,pwm:Da};class Fa extends Ea{constructor(){super(po(Fa.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=po(Fa.getDefaults(),arguments,["frequency","type"]);this.frequency=new ra({context:this.context,units:"frequency",value:t.frequency}),this.detune=new ra({context:this.context,units:"cents",value:t.detune}),Io(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(Sa.getDefaults(),Pa.getDefaults(),Ia.getDefaults(),Ma.getDefaults(),Na.getDefaults(),Da.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=La[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof La[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&qs(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&qs(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Js(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return io(this,void 0,void 0,(function*(){return xa(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function Ua(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){js(i,t,e),n.set(this,i)}})}}function Ga(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){js(this.toSeconds(i),t,e),n.set(this,i)}})}}class Ba extends Ea{constructor(){super(po(Ba.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=po(Ba.getDefaults(),arguments,["url","onload"]);this._buffer=new Mo({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ea.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:No,onerror:No,playbackRate:1,reverse:!1})}load(t){return io(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=No){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?fo(e,this._loopStart):fo(e,0);const i=this.toSeconds(e),r=n;n=fo(n,Math.max(this._buffer.duration-i,0));let s=this.toSeconds(n);s/=this._playbackRate,t=this.toSeconds(t);const o=new ba({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+s),this._state.setStateAtTime("stopped",t+s,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&Ws(r)?o.start(t,i):o.start(t,i,s-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&js(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&js(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}no([Ga(0)],Ba.prototype,"fadeIn",void 0),no([Ga(0)],Ba.prototype,"fadeOut",void 0);class ka extends Jo{constructor(){super(po(ka.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new ra({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=po(ka.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Jo.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(Js(t))return t;{let n;for(n in Va)if(Va[n][e]===t)return n;return t}}_setCurve(t,e,n){if(Js(n)&&Reflect.has(Va,n)){const i=Va[n];Zs(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else{if(!Ks(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){Xs(["linear","exponential"].some((e=>e===t)),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),r=this.getValueAtTime(t);if(r>0){n=(1-r)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let i=this._attackCurve;for(let t=1;t<i.length;t++)if(i[t-1]<=r&&r<=i[t]){i=this._attackCurve.slice(t),i[0]=r;break}this._sig.setValueCurveAtTime(i,t,n,e)}if(i&&this.sustain<1){const r=e*this.sustain,s=t+n;this.log("decay",s),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(r,i+s):this._sig.exponentialApproachValueAtTime(r,s,i)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(Xs(Ks(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return sa(this,t,e,n),this}asArray(t=1024){return io(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new Do(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=i+this.toSeconds(this.release),s=.1*r,o=r+s,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/o,decay:e*this.toSeconds(this.decay)/o,release:e*this.toSeconds(this.release)/o,context:n}));a._sig.toDestination(),a.triggerAttackRelease(e*(i+s)/o,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}no([Ga(0)],ka.prototype,"attack",void 0),no([Ga(0)],ka.prototype,"decay",void 0),no([Ua(0,1)],ka.prototype,"sustain",void 0),no([Ga(0)],ka.prototype,"release",void 0);const Va=(()=>{const t=128;let e,n;const i=[];for(e=0;e<t;e++)i[e]=Math.sin(e/127*(Math.PI/2));const r=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;r[e]=t/10+.83*n}r[127]=1;const s=[];for(e=0;e<t;e++)s[e]=Math.ceil(e/127*5)/5;const o=[];for(e=0;e<t;e++)n=e/127,o[e]=.5*(1-Math.cos(Math.PI*n));const a=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,i=Math.cos(t*Math.PI*2*n);a[e]=Math.abs(i*(1-n))}function h(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:h(a),Out:a},cosine:{In:i,Out:(u=i,u.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:r,Out:h(r)},sine:{In:o,Out:h(o)},step:{In:s,Out:h(s)}};var u})();class Xa extends Jo{constructor(){super(po(Xa.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=po(Xa.getDefaults(),arguments);this._volume=this.output=new ma({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Io(this,"volume")}static getDefaults(){return Object.assign(Jo.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const i=t[e],r=this.context.transport.schedule((i=>{t[e]=i,n.apply(this,t)}),i);this._scheduledEvents.push(r)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,i){const r=this.toSeconds(n),s=this.toSeconds(e);return this.triggerAttack(t,r,i),this.triggerRelease(r+s),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class ja extends Xa{constructor(){super(po(ja.getDefaults(),arguments));const t=po(ja.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Xa.getDefaults(),{detune:0,onsilence:No,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),i=t instanceof $o?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,t,n)}else this.frequency.setValueAtTime(i,n);return this}}no([Ga(0)],ja.prototype,"portamento",void 0);class Ha extends ka{constructor(){super(po(Ha.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new ea({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class $a extends ja{constructor(){super(po($a.getDefaults(),arguments)),this.name="Synth";const t=po($a.getDefaults(),arguments);this.oscillator=new Fa(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Ha(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),Io(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(ja.getDefaults(),{envelope:Object.assign(mo(ka.getDefaults(),Object.keys(Jo.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(mo(Fa.getDefaults(),[...Object.keys(Ea.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Ya extends $a{constructor(){super(po(Ya.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=po(Ya.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,Io(this,["oscillator","envelope"])}static getDefaults(){return co(ja.getDefaults(),$a.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),i=this.toFrequency(t instanceof $o?t.toFrequency():t),r=i*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}no([Ua(0)],Ya.prototype,"octaves",void 0),no([Ga(0)],Ya.prototype,"pitchDecay",void 0);const Wa=new Set;function za(t){Wa.add(t)}function qa(t,e){const n=`registerProcessor("${t}", ${e})`;Wa.add(n)}za('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');za("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");za("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");qa("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class Za extends Xa{constructor(){super(po(Za.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=po(Za.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach((n=>{const i=parseInt(n,10);if(Xs(Qs(n)||qs(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),Qs(n)){const i=new $o(this.context,n).toMidi();e[i]=t.urls[n]}else qs(i)&&isFinite(i)&&(e[i]=t.urls[i])})),this._buffers=new la({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Xa.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:No,onerror:No,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((t=>{const i=Xo(new $o(this.context,t).toFrequency()),r=Math.round(i),s=i-r,o=this._findClosest(r),a=r-o,h=this._buffers.get(a),u=Bo(o+s),l=new ba({url:h,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:u}).connect(this.output);l.start(e,0,h.duration/u,n),Ks(this._activeSources.get(r))||this._activeSources.set(r,[]),this._activeSources.get(r).push(l),l.onended=()=>{if(this._activeSources&&this._activeSources.has(r)){const t=this._activeSources.get(r),e=t.indexOf(l);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=new $o(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(n,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;){t.shift().stop(e)}})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,i=1){const r=this.toSeconds(n);return this.triggerAttack(t,r,i),Ks(e)?(Xs(Ks(t),"notes must be an array when duration is array"),t.forEach(((t,n)=>{const i=e[Math.min(n,e.length-1)];this.triggerRelease(t,r+this.toSeconds(i))}))):this.triggerRelease(t,r+this.toSeconds(e)),this}add(t,e,n){if(Xs(Qs(t)||isFinite(t),`note must be a pitch or midi: ${t}`),Qs(t)){const i=new $o(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}no([Ga(0)],Za.prototype,"attack",void 0),no([Ga(0)],Za.prototype,"release",void 0);class Ka extends Jo{constructor(){super(Object.assign(po(Ka.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=po(Ka.getDefaults(),arguments,["pan"]);this.pan=new Ko({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",Io(this,"pan")}static getDefaults(){return Object.assign(Jo.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}qa("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class Ja extends Jo{constructor(){super(po(Ja.getDefaults(),arguments,["solo"])),this.name="Solo";const t=po(Ja.getDefaults(),arguments,["solo"]);this.input=this.output=new ea({context:this.context}),Ja._allSolos.has(this.context)||Ja._allSolos.set(this.context,new Set),Ja._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Jo.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),Ja._allSolos.get(this.context).forEach((t=>t._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){Ja._soloed.has(this.context)||Ja._soloed.set(this.context,new Set),Ja._soloed.get(this.context).add(this)}_removeSolo(){Ja._soloed.has(this.context)&&Ja._soloed.get(this.context).delete(this)}_isSoloed(){return Ja._soloed.has(this.context)&&Ja._soloed.get(this.context).has(this)}_noSolos(){return!Ja._soloed.has(this.context)||Ja._soloed.has(this.context)&&0===Ja._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Ja._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Ja._allSolos=new Map,Ja._soloed=new Map;class Qa extends Jo{constructor(){super(po(Qa.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=po(Qa.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Ka({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new ma({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,Io(this,["pan","volume"])}static getDefaults(){return Object.assign(Jo.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class th extends Jo{constructor(){super(po(th.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=po(th.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Ja({solo:t.solo,context:this.context}),this._panVol=this.output=new Qa({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Io(this,["pan","volume"])}static getDefaults(){return Object.assign(Jo.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return th.buses.has(t)||th.buses.set(t,new ea({context:this.context})),th.buses.get(t)}send(t,e=0){const n=this._getBus(t),i=new ea({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}th.buses=new Map;class eh extends Jo{constructor(){super(...arguments),this.name="Listener",this.positionX=new Ko({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Ko({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Ko({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Ko({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Ko({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Ko({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Ko({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Ko({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Ko({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Jo.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}var nh,ih,rh;Ao((t=>{t.listener=new eh({context:t})})),wo((t=>{t.listener.dispose()})),Uo().transport,Uo().destination,Uo().destination,Uo().listener,Uo().draw,Uo(),function(t){t.MAIN="MAIN"}(nh||(nh={}));class sh{constructor(t,e){this.autoplayRepository=t,this.dateGateway=e}hasAutoplay(){return this.autoplayRepository.hasAutoplay()}isTimeForNextCleavage(){return Promise.all([this.autoplayRepository.retrieveNextAutoPlayDate(),this.dateGateway.retrieveCurrentDate()]).then((([t,e])=>Promise.resolve(e>=t))).catch((t=>Promise.reject(t)))}configureNextAutoPlay(t){return 0===t?this.onDisableAutoplay(t):this.dateGateway.retrieveCurrentDate().then((e=>t?this.onAutoplayMinutes(e,t):this.onNoAutoplayMinutes(e))).catch((t=>Promise.reject(t)))}onDisableAutoplay(t){return Promise.all([this.autoplayRepository.configureAutoplayInterval(t),this.autoplayRepository.configureNextAutoPlay(null)]).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}onAutoplayMinutes(t,e){return Promise.all([this.autoplayRepository.configureNextAutoPlay(this.addMinutes(new Date(t),e)),this.autoplayRepository.configureAutoplayInterval(e)]).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}onNoAutoplayMinutes(t){return this.autoplayRepository.retreiveAutoplayInterval().then((e=>this.autoplayRepository.configureNextAutoPlay(this.addMinutes(new Date(t),e)))).catch((t=>Promise.reject(t)))}addMinutes(t,e){return t.setMinutes(t.getMinutes()+e),t}}class oh extends J{constructor(){super(...arguments),this.eventType=K.INSTALL_NEW_STOOLS_ON_BAR}}class ah extends J{constructor(t,e){super(),this.id=t,this.interfaceEntityState=e,this.eventType=K.DRAW}}class hh extends J{constructor(){super(...arguments),this.eventType=K.INSTALL_NEW_TABLE}}class uh extends J{constructor(t,e){super(),this.username=t,this.position=e,this.eventType=K.PLAYER_MOVE}}class lh extends J{constructor(t){super(),this.username=t,this.eventType=K.PLAYER_QUIT}}class ch extends J{constructor(){super(...arguments),this.eventType=K.TABLE_STOOL_AVAILABLE}}!function(t){t.LEFT="LEFT",t.RIGHT="RIGHT",t.DOWN="DOWN",t.UP="UP"}(ih||(ih={}));class ph extends J{constructor(t){super(),this.gamePhase=t,this.eventType=K.CHANGE_GAME_PHASE}}class dh extends J{constructor(t){super(),this.tableId=t,this.eventType=K.INSTALL_NEW_STOOLS_ON_TABLE}}!function(t){t.PLAYER="PLAYER",t.BAR="BAR",t.STOOL="STOOL",t.TABLE="TABLE"}(rh||(rh={}));class fh{constructor(t,e,n){this.barRepository=t,this.eventGateway=e,this.uuidGateway=n,this.stoolRowsPerTables=2,this.stoolsPerStoolRow=3,this.stoolDiameter=.4,this.defaultTableHorizontalOffset=3.1,this.defaultTableVerticalOffset=2,this.tableSize={height:.8,width:2.4},this.firstTablePosition={x:-.2,y:-2},this.defaultBarPosition={x:0,y:0},this.defaultBarSize={width:8.2,height:6.8},this.firstStoolOffset={x:.6,y:-.4},this.tableStoolPlayerOffsetPosition={x:-.1,y:-.5}}installStoolForBar(){const t=this.makeBarStools();return Promise.all(t.map((t=>this.uuidGateway.nextId()))).then((e=>(e.forEach(((e,n)=>{t[n].id=e})),Promise.all(t.map((t=>this.barRepository.addAvailableBarStool(t))))))).then((e=>this.eventGateway.sendEvents(t.map((t=>new ah(t.id,{position:t.position,spriteType:rh.STOOL,size:t.size})))))).catch((t=>Promise.reject(t)))}makeBarStools(){const t=[];for(let e=0;e<2;e++)for(let n=0;n<9;n++){0!==e&&(3===n||4===n)||t.push({id:"",size:{width:this.stoolDiameter,height:this.stoolDiameter},position:{x:this.precisionRound(this.firstStoolOffset.x+.8*n,3),y:this.precisionRound(this.firstStoolOffset.y+(0===e?0:7.2),3)}})}return t}installBar(){return this.uuidGateway.nextId().then((t=>this.onBarUuid(t))).catch((t=>Promise.reject(t)))}onBarUuid(t){return this.barRepository.installBar({position:this.defaultBarPosition,size:this.defaultBarSize,id:t}).then((()=>this.eventGateway.sendEvents([new oh,new ah(t,{position:this.defaultBarPosition,spriteType:rh.BAR,size:this.defaultBarSize}),new tt(Z.GAME),new ph(At.NEW_CLEAVAGE)]))).catch((t=>Promise.reject(t)))}askForNewTable(){return this.eventGateway.sendEvent(new hh)}installPlayerFromBarStoolToTableStool(t){return this.barRepository.freeBarStool(t.username).then((()=>this.barRepository.nextAvailableTableStool())).then((e=>this.occupyTableStool(e,t.username))).catch((t=>Promise.reject(t)))}occupyTableStool(t,e){return this.barRepository.setOccupiedTableStool(e,t).then((()=>this.eventGateway.sendEvent(new uh(e,{x:this.precisionRound(t.position.x+this.tableStoolPlayerOffsetPosition.x,2),y:this.precisionRound(t.position.y+this.tableStoolPlayerOffsetPosition.y,2)})))).catch((t=>Promise.reject(t)))}nextOccupiedBarStool(){return this.barRepository.nextOccupiedBarStool()}installStoolForTable(t){return this.barRepository.retrieveTableById(t).then((t=>this.stoolsForTable(t))).then((t=>this.onStoolsForTable(t))).catch((t=>Promise.reject(t)))}installNewTable(){return Promise.all([this.barRepository.retrieveTables(),this.barRepository.retrieveBar(),this.barRepository.retreiveTableDirection(),this.uuidGateway.nextId()]).then((([t,e,n,i])=>t.length>0?this.onTables(i,t,e,n):this.installTable({id:i,size:this.tableSize,position:this.firstTablePosition}))).catch((t=>Promise.reject(t)))}onStoolsForTable(t){return Promise.all(t.map((t=>this.barRepository.addAvailableTableStool(t)))).then((e=>this.eventGateway.sendEvents([new ch,...t.map((t=>new ah(t.id,{position:t.position,size:t.size,spriteType:rh.STOOL})))]))).catch((t=>Promise.reject(t)))}stoolsForTable(t){const e=[];for(let n=1;n<=this.stoolRowsPerTables;n++)for(let i=0;i<this.stoolsPerStoolRow;i++)e.push(this.makeStool(t,n,i));return Promise.all(e)}makeStool(t,e,n){return this.uuidGateway.nextId().then((i=>({id:i,size:{width:this.stoolDiameter,height:this.stoolDiameter},position:this.stoolPosition(t,e,n)}))).catch((t=>Promise.reject(t)))}stoolPosition(t,e,n){return{x:this.precisionRound(t.position.x+(this.stoolDiameter/2+n*this.stoolDiameter*2),3),y:this.precisionRound(t.position.y+(e%2==0?2*this.stoolDiameter:-this.stoolDiameter),3)}}onTables(t,e,n,i){return this.newTablePositionAndDirection(e,n,i).then((({position:e,direction:n})=>Promise.all([this.installTable({id:t,position:e,size:this.tableSize}),this.barRepository.updateTableDirection(n)]))).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}newTablePositionAndDirection(t,e,n){const i=t[t.length-1],r=new Map([[ih.UP,{isNoCollision:()=>this.isNoCollision(i,[e,...t],this.defaultTableHorizontalOffset,0),direction:ih.RIGHT}],[ih.RIGHT,{isNoCollision:()=>this.isNoCollision(i,[e,...t],0,this.defaultTableVerticalOffset),direction:ih.DOWN}],[ih.DOWN,{isNoCollision:()=>this.isNoCollision(i,[e,...t],-this.defaultTableHorizontalOffset,0),direction:ih.LEFT}],[ih.LEFT,{isNoCollision:()=>this.isNoCollision(i,[e,...t],0,-this.defaultTableVerticalOffset),direction:ih.UP}]]),s=new Map([[ih.UP,{x:i.position.x+0,y:i.position.y-this.defaultTableVerticalOffset}],[ih.RIGHT,{x:i.position.x+this.defaultTableHorizontalOffset,y:i.position.y+0}],[ih.DOWN,{x:i.position.x+0,y:i.position.y+this.defaultTableVerticalOffset}],[ih.LEFT,{x:i.position.x-this.defaultTableHorizontalOffset,y:i.position.y+0}]]),o=r.get(n);if(!o)return Promise.reject(new Error(`Unsupported change direction strategy with direction ${n}`));n=o.isNoCollision()?o.direction:n;const a=s.get(n);return a?Promise.resolve({position:{x:this.precisionRound(a.x,3),y:this.precisionRound(a.y,3)},direction:n}):Promise.reject(new Error("Position undefined."))}precisionRound(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}isNoCollision(t,e,n,i){t.id;const r=t.size,s={x:this.precisionRound(t.position.x+n,3),y:this.precisionRound(t.position.y+i,3)};for(const t of e){const e=s.x<=t.position.x+t.size.width&&s.x+r.width>=t.position.x;if(s.y<=t.position.y+t.size.height&&s.y+r.height>=t.position.y&&e)return!1}return!0}installTable(t){return console.log(JSON.stringify(t)),this.barRepository.addTable(t).then((()=>this.eventGateway.sendEvents([new dh(t.id),new ah(t.id,{position:t.position,size:t.size,spriteType:rh.TABLE})]))).catch((t=>Promise.reject(t)))}playerQuit(t){return this.eventGateway.sendEvent(new lh(t))}installPlayerOnBarStool(t){return this.barRepository.nextAvailableBarStool().then((e=>Promise.all([this.barRepository.setOccupiedBarStool(t,e),this.eventGateway.sendEvent(new uh(t,e.position)),this.eventGateway.sendEvent(new hh)]))).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}installPlayerOnTableStool(t){return this.barRepository.nextAvailableTableStool().then((e=>Promise.all([this.barRepository.setOccupiedTableStool(t,e),this.eventGateway.sendEvent(new uh(t,e.position))]))).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}hasAvailableTableStool(){return this.barRepository.hasAvailableTableStool()}hasAvailableBarStool(){return this.barRepository.hasAvailableBarStool()}}const mh={message:"You are already connected to chat."},_h={message:"You are already disconnected to chat."},gh={message:"There is no cleavage available."};class vh{constructor(t,e){this.chatGateway=t,this.interfaceGateway=e}sendMessageToPlayer(t){return this.chatGateway.sendMessageToPlayer(t)}sendMessage(t){return this.chatGateway.sendMessage(t)}isConnected(){return this.chatGateway.isConnected()}connectChat(t,e,n){return this.chatGateway.connect(t,e,n)}disconnectChat(){return this.isConnected().then((t=>t?this.chatGateway.disconnect():this.interfaceGateway.notify(_h)))}}class yh{constructor(t){this.name=t.name,this.players=t.players}toDTO(){return{name:this.name,players:this.players}}}class Th{constructor(t){this.title=t.title,this.leftChoice=new yh(t.leftChoice),this.rightChoice=new yh(t.rightChoice),this.players=t.players}majorScore(){const t=this.majorChoice();return t?t===this.leftChoice.name?this.leftChoice.players.length/(this.leftChoice.players.length+this.rightChoice.players.length)*100:this.rightChoice.players.length/(this.leftChoice.players.length+this.rightChoice.players.length)*100:50}majorChoice(){return this.leftChoice.players.length>this.rightChoice.players.length?this.leftChoice.name:this.leftChoice.players.length<this.rightChoice.players.length?this.rightChoice.name:void 0}toDto(){return{title:this.title,leftChoice:this.leftChoice.toDTO(),rightChoice:this.rightChoice.toDTO(),players:this.players}}}class Eh{constructor(t,e){this.username=t,this.message=e}}var bh,xh;!function(t){t.LEFT="LEFT",t.RIGHT="RIGHT",t.NOTHING="NOTHING"}(bh||(bh={}));class Ah{constructor(t,e,n,i,r){this.publicCleavageDrawPileRepository=t,this.globalCleavageDrawPileGateway=e,this.currentCleavageRepository=n,this.chatGateway=i,this.gamePhaseRepository=r}changeGamePhase(t){return this.gamePhaseRepository.changeGamePhase(t)}retrieveCurrentGamePhase(){return this.gamePhaseRepository.retrieveCurrentGamePhase()}saveGlobalCleavage(t){const e=t.toDto();return e.players=[],this.globalCleavageDrawPileGateway.save(new Th(e))}removePlayerOnCleavage(t){return this.loadCurrentCleavage().then((e=>(e.leftChoice.players=e.leftChoice.players.filter((e=>e!==t.username)),e.rightChoice.players=e.rightChoice.players.filter((e=>e!==t.username)),e.players=e.players.filter((e=>e!==t.username)),this.saveCleavage(e)))).catch((t=>Promise.reject(t)))}addPlayerOnCleavage(t){return this.loadCurrentCleavage().then((e=>(e.players.push(t.username),this.saveCleavage(e)))).catch((t=>Promise.reject(t)))}isPublicCleavageExist(t){return this.publicCleavageDrawPileRepository.isCleavageExistByTitle(t)}addPublicCleavage(t){return this.publicCleavageDrawPileRepository.addCleavage(t)}loadCurrentCleavage(){return this.currentCleavageRepository.load()}hasCurrentCleavage(){return this.currentCleavageRepository.hasCleavage()}playerCleave(t){return this.currentCleavageRepository.load().then((e=>this.onCleave(e,t))).catch((t=>Promise.reject(t)))}saveCleavage(t){return this.currentCleavageRepository.save(t)}onCleave(t,e){t.players.some((t=>t===e.username))||t.players.push(e.username);const n=this.previousPlayerCleave(t,e);return n!==bh.NOTHING?this.onPlayerAlreadyCleave(e,n,t):this.cleave(e,t)}previousPlayerCleave(t,e){return t.leftChoice.players.some((t=>t===e.username))?bh.LEFT:t.rightChoice.players.some((t=>t===e.username))?bh.RIGHT:bh.NOTHING}cleave(t,e){return t.playerCleave===bh.LEFT&&e.leftChoice.players.push(t.username),t.playerCleave===bh.RIGHT&&e.rightChoice.players.push(t.username),this.saveCleavage(e)}onPlayerAlreadyCleave(t,e,n){return t.playerCleave===e?this.chatGateway.sendMessageToPlayer(new Eh(t.username,`You have still cleave ${e}`)):this.uncleave(t,e,n).then((e=>this.cleave(t,e))).catch((t=>Promise.reject(t)))}uncleave(t,e,n){return e===bh.LEFT&&(n.leftChoice.players=n.leftChoice.players.filter((e=>e!==t.username))),e===bh.RIGHT&&(n.rightChoice.players=n.rightChoice.players.filter((e=>e!==t.username))),Promise.resolve(n)}nextPublicCleavage(){return this.publicCleavageDrawPileRepository.nextCleavage()}randomGlobalCleavage(){return this.globalCleavageDrawPileGateway.drawGlobalCleavage()}}class Sh{constructor(t){this.eventGateway=t}sentEvent(t){return this.eventGateway.sendEvent(t)}sentEvents(t){return Promise.all(t.map((t=>this.sentEvent(t)))).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}}class wh{constructor(t){this.type=t}}!function(t){t.QUACK="QUACK",t.DICE_ROLL="DICE_ROLL",t.ERROR="ERROR",t.APPLAUSE="APPLAUSE",t.WHISTLE="WHISTLE",t.SHOOT="SHOOT",t.HYPERLIKE="HYPERLIKE",t.POUFFF="POUFFF",t.TICK="TICK"}(xh||(xh={}));class Rh{constructor(t){this.interfaceGateway=t}changeVideoExtractVolumeLevel(t){return Promise.all([this.playSound(new wh(xh.TICK)),this.interfaceGateway.changeVideoExtractVolumeLevel(t)]).then((()=>Promise.resolve())).catch((t=>Promise.reject(t)))}changeGamePhase(t){return this.interfaceGateway.changeGamePhase(t)}removeEntityInterfaceState(t){return this.interfaceGateway.removeEntityInterfaceState(t)}updateEntityInterfaceState(t,e){return this.interfaceGateway.updateEntityInterfaceState(t,e)}disableAutoplay(){return this.interfaceGateway.disableAutoplay()}enableAutoplay(){return this.interfaceGateway.enableAutoplay()}changeMusicVolumeLevel(t){return this.interfaceGateway.changeMusicVolumeLevel(t)}changeSoundVolumeLevel(t){return this.interfaceGateway.changeSoundVolumeLevel(t)}playMusic(t){return this.interfaceGateway.playMusic(t)}onNoCleavageAvailable(){return Promise.all([this.clearCleavage(),this.notify(gh)]).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}playSound(t){return this.interfaceGateway.playSound(t)}retrieveCurrentView(){return this.interfaceGateway.retrieveCurrentView()}notify(t){return this.interfaceGateway.notify(t)}updateCleavage(t){return this.interfaceGateway.updateCleavage(t)}changeView(t){return this.interfaceGateway.changeView(t)}newCleavage(){return this.clearCleavage()}clearCleavage(){return this.interfaceGateway.updateCleavage(void 0)}}class Ch{constructor(t){this.username=t.username,this.position=t.position,this.size=t.size}toDto(){return{username:this.username,position:this.position,size:this.size}}}class Oh extends J{constructor(t){super(),this.username=t,this.eventType=K.PLAYER_JOIN_BAR}}const Ih={width:.6,height:.8};new Th({title:"Les mouchoirs en tissu",leftChoice:{name:"Gôche",players:[]},rightChoice:{name:"Drouate",players:[]},players:[]}),new Th({title:"Les glaciers de l'Ile d'Oléron",leftChoice:{name:"Gôche",players:[]},rightChoice:{name:"Drouate",players:[]},players:[]});class Ph{constructor(t,e){this.playerRepository=t,this.eventGateway=e}playerByUsername(t){return this.playerRepository.playerByUsername(t)}updatePosition(t,e,n){return this.playerRepository.playerByUsername(t).then((t=>(t.position=e,this.playerRepository.save(t)))).then((()=>this.eventGateway.sendEvent(new ah(t,{position:e,size:n,spriteType:rh.PLAYER})))).catch((t=>Promise.reject(t)))}players(){return this.playerRepository.loadAllPlayers()}removePlayer(t){return this.playerRepository.remove(t)}addPlayer(t){return this.playerRepository.hasPlayer(t).then((e=>e?Promise.resolve():this.onNewPlayer(t))).catch((t=>Promise.reject(t)))}onNewPlayer(t){const e=new Ch({username:t,size:Ih});return this.playerRepository.save(e).then((()=>this.eventGateway.sendEvent(new Oh(e.username)))).catch((t=>Promise.reject(t)))}}class Nh{constructor(t,e,n){this.videoExtractRepository=t,this.interfaceGateway=e,this.randomGateway=n}removeVideoExtractOnInterface(){return Promise.all([this.interfaceGateway.changeVideoExtract(void 0),this.interfaceGateway.unMuteMusic()]).then((()=>Promise.resolve())).catch((t=>Promise.reject(t)))}applyVideoExtractOnInterface(t){const e=t.majorChoice();return e?this.onMajorChoice(e,t):this.onNoMajorChoice()}onMajorChoice(t,e){return this.videoExtractRepository.retreiveVideoExtractsByChoice(t).then((t=>{const n=t.reduce(((t,n)=>Math.abs(n.percentage-e.majorScore())<Math.abs(t.percentage-e.majorScore())?n:t));return console.log(JSON.stringify(e)),console.log(JSON.stringify(n)),this.playVideo(n)}))}playVideo(t){Promise.all([this.interfaceGateway.changeVideoExtract(t),this.interfaceGateway.muteMusic()]).then((()=>Promise.resolve())).catch((t=>Promise.reject(t)))}onNoMajorChoice(){return this.videoExtractRepository.retreiveEqualityVideoExtracts().then((t=>Promise.all([t,this.randomGateway.randomIntegerOnRange(1,t.length)]))).then((([t,e])=>this.playVideo(t[e-1]))).catch((t=>Promise.reject(t)))}hasVideoExtractForChoice(t){return t?this.videoExtractRepository.hasVideoExtract(t):this.videoExtractRepository.hasEqualityVideoExtract()}}class Mh extends J{constructor(){super(...arguments),this.eventType=K.APPLICATION_START}}class Dh extends J{constructor(){super(...arguments),this.eventType=K.CHECK_AUTOPLAY}}class Lh{}class Fh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.event.sentEvent(new tt(Z.MAIN_MENU))}}const Uh="!";var Gh;!function(t){t.LEFT="g",t.RIGHT="d",t.UNSUPPORTED="UNSUPPORTED",t.SUGGEST_CLEAVAGE="c",t.HELP="help",t.SHORT_HELP="h",t.SHORT_APPLAUSE="a",t.SHORT_SHOOT="s",t.SHORT_HYPERLIKE="l",t.SHORT_WHISTLE="w"}(Gh||(Gh={}));const Bh=`Le jeu du clivage!\nUn jeu pour tout la famille.\nEn tant que joueur tu peux:\n- [ ${Uh+Gh.HELP} ] Afficher l'aide (tu viens de le faire XD).\n- [ ${Uh+Gh.SHORT_HELP} ] Afficher l'aide (tu viens de le faire XD).\n- [ ${Uh+Gh.SUGGEST_CLEAVAGE} {Nom du clivage} ] Proposer un clivage.\n- [ ${Uh+Gh.LEFT} ] Cliver à Gôche.\n- [ ${Uh+Gh.RIGHT} ] Cliver à Drouate.\n- [ ${Uh+Gh.SHORT_APPLAUSE} ] Applaudir.\n- [ ${Uh+Gh.SHORT_HYPERLIKE} ] Kiffer.\n- [ ${Uh+Gh.SHORT_SHOOT} ] Huer.\n- [ ${Uh+Gh.SHORT_WHISTLE} ] Siffler.\nAttention... ça va cliver!`;class kh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.chat.sendMessageToPlayer(new Eh(t.username,Bh))}}class Vh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.interface.clearCleavage().then((()=>this.applicationServices.interface.playSound(new wh(xh.QUACK)))).catch((t=>Promise.reject(t)))}}class Xh extends Lh{constructor(t){super(),this.interfaceApplicationService=t}execute(t){return this.interfaceApplicationService.changeMusicVolumeLevel(t.volume).then((()=>this.interfaceApplicationService.playSound(new wh(xh.TICK)))).catch((t=>Promise.reject(t)))}}class jh extends Lh{constructor(t){super(),this.interfaceApplicationService=t}execute(t){return this.interfaceApplicationService.changeSoundVolumeLevel(t.volume).then((()=>this.interfaceApplicationService.playSound(new wh(xh.TICK)))).catch((t=>Promise.reject(t)))}}class Hh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return Promise.resolve([this.applicationServices.interface.changeView(t.targetView),this.applicationServices.interface.playSound(new wh(xh.POUFFF))]).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}}class $h extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.interface.playSound(new wh(xh.APPLAUSE))}}class Yh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.player.addPlayer(t.username).then((()=>this.applicationServices.cleavage.retrieveCurrentGamePhase())).then((e=>e!==At.CLEAVING?this.applicationServices.chat.sendMessageToPlayer(new Eh(t.username,"Wait for cleavage launch! 👀")):this.onCleavingPhase(t))).catch((t=>Promise.reject(t)))}onCleavingPhase(t){return this.applicationServices.cleavage.hasCurrentCleavage().then((e=>{return e?this.onCleavage(t):this.applicationServices.chat.sendMessageToPlayer({username:n=t.username,message:`Il n'y a pas de clivage en cours ${n}. Attends un peu.`});var n})).catch((t=>Promise.reject(t)))}onCleavage(t){return this.applicationServices.cleavage.playerCleave(t).then((()=>this.updateCleavageOnInterface())).catch((t=>Promise.reject(t)))}updateCleavageOnInterface(){return this.applicationServices.cleavage.loadCurrentCleavage().then((t=>this.applicationServices.interface.updateCleavage(t))).catch((t=>Promise.reject(t)))}}class Wh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.interface.playSound(new wh(xh.HYPERLIKE))}}class zh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.player.players().then((e=>{const n=e.find((e=>e.username===t.username));return n?this.onPlayer(n):this.onMissingPlayer()}))}onMissingPlayer(){return Promise.resolve()}onPlayer(t){return this.applicationServices.player.removePlayer(t).then((()=>this.applicationServices.cleavage.hasCurrentCleavage())).then((e=>e?this.onCleavage(t):Promise.resolve())).catch((t=>Promise.reject(t)))}onCleavage(t){return this.applicationServices.cleavage.removePlayerOnCleavage(t).then((()=>this.applicationServices.cleavage.loadCurrentCleavage())).then((t=>this.applicationServices.interface.updateCleavage(t))).catch((t=>Promise.reject(t)))}}class qh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.interface.playSound(new wh(xh.SHOOT))}}class Zh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.interface.playSound(new wh(xh.WHISTLE))}}class Kh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.cleavage.isPublicCleavageExist(t.cleavage).then((e=>e?this.applicationServices.chat.sendMessageToPlayer(new Eh(t.username,"Cleavage already suggested.")):this.onPublicCleavageExist(t))).catch((t=>Promise.reject(t)))}onPublicCleavageExist(t){return this.applicationServices.cleavage.addPublicCleavage(t.cleavage).then((()=>{return this.applicationServices.chat.sendMessageToPlayer(new Eh(t.username,(e=t.username,`Cleavage '${t.cleavage.title}' suggested to streamer.\n You rocks ${e}! 👍`)));var e})).catch((t=>Promise.reject(t)))}}class Jh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.chat.isConnected().then((e=>e?this.onConnected(t):this.applicationServices.event.sentEvent(new tt(Z.CONNECT_CHAT)))).catch((t=>Promise.reject(t)))}onConnected(t){return this.applicationServices.player.players().then((e=>this.applicationServices.cleavage.saveCleavage(new Th({title:t.cleavageTitle,leftChoice:{name:t.leftChoiceName,players:[]},rightChoice:{name:t.rightChoiceName,players:[]},players:e.map((t=>t.username))})))).then((()=>this.applicationServices.cleavage.loadCurrentCleavage())).then((t=>Promise.all([this.applicationServices.interface.updateCleavage(t),this.applicationServices.cleavage.saveGlobalCleavage(t)]))).then((t=>this.applicationServices.event.sentEvent(new ph(At.CLEAVING)))).catch((t=>Promise.reject(t)))}}class Qh extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.chat.disconnectChat()}}class tu extends J{constructor(t,e,n){super(),this.cleavageTitle=t,this.leftChoiceName=e,this.rightChoiceName=n,this.eventType=K.LAUNCH_CLEAVAGE}}class eu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.autoplay.hasAutoplay().then((t=>t?this.onAutoPlay(t):this.onNotAutoPlay(t)))}onAutoPlay(t){return this.onNoPublicCleavage(t)}onNotAutoPlay(t){return this.applicationServices.cleavage.nextPublicCleavage().then((e=>e?this.onCleavage(e,t):this.onNoPublicCleavage(t))).catch((t=>Promise.reject(t)))}onCleavage(t,e){return Promise.all([this.applicationServices.cleavage.saveCleavage(t),this.applicationServices.interface.updateCleavage(t),this.applicationServices.interface.playSound(new wh(xh.DICE_ROLL))]).then((n=>e?this.applicationServices.event.sentEvent(new tu(t.title,t.leftChoice.name,t.rightChoice.name)):Promise.resolve())).catch((t=>Promise.reject(t)))}onNoPublicCleavage(t){return this.applicationServices.cleavage.randomGlobalCleavage().then((e=>e?this.onCleavage(e,t):this.onNoGlobalCleavage())).catch((t=>Promise.reject(t)))}onNoGlobalCleavage(){return Promise.all([this.applicationServices.interface.onNoCleavageAvailable(),this.applicationServices.interface.playSound(new wh(xh.ERROR))]).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}}class nu extends J{constructor(){super(...arguments),this.eventType=K.VIDEO_EXTRACT_START}}class iu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.chat.isConnected().then((t=>t?this.onConnected():this.applicationServices.event.sentEvent(new tt(Z.CONNECT_CHAT)))).catch((t=>Promise.reject(t)))}onConnected(){return this.applicationServices.interface.newCleavage().then((()=>Promise.all([this.applicationServices.interface.retrieveCurrentView(),this.applicationServices.cleavage.retrieveCurrentGamePhase()]))).then((([t,e])=>this.applicationServices.event.sentEvents([...e===At.NEW_CLEAVAGE?[]:t!==Z.GAME?[new ph(At.NEW_CLEAVAGE)]:[new nu],...t!==Z.GAME?[new tt(Z.GAME)]:[]]))).catch((t=>Promise.reject(t)))}}const ru=new class{constructor(t,e){this.supportedMusic=t,this.volume=e}}(nh.MAIN,0);class su extends class{constructor(t){this.message=t}}{constructor(){super(ou)}}const ou="La régie du jeu du clivage est chaud patate!\nPour obtenir de l'aide, lancer la commande '!h'";class au extends J{constructor(){super(...arguments),this.eventType=K.CREATE_BAR}}class hu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.chat.isConnected().then((e=>e?this.applicationServices.interface.notify(mh):this.onDisconnected(t))).catch((t=>Promise.reject(t)))}onDisconnected(t){return this.applicationServices.chat.connectChat(t.username,t.token,t.channel).then((()=>this.onConnected())).catch((t=>Promise.reject(t)))}onConnected(){return Promise.all([this.applicationServices.event.sentEvent(new au),this.applicationServices.chat.sendMessage(new su),this.applicationServices.interface.playMusic(ru)]).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}}class uu extends J{constructor(){super(...arguments),this.eventType=K.PLAYER_APPLAUSE}}class lu extends J{constructor(t){super(),this.username=t,this.eventType=K.PLAYER_ASK_FOR_HELP}}class cu extends J{constructor(t,e){super(),this.username=t,this.playerCleave=e,this.eventType=K.PLAYER_CLEAVE}}class pu extends J{constructor(){super(...arguments),this.eventType=K.PLAYER_HYPERLIKE}}class du extends J{constructor(){super(...arguments),this.eventType=K.PLAYER_SHOOT}}class fu extends J{constructor(){super(...arguments),this.eventType=K.PLAYER_WHISTLE}}class mu extends J{constructor(t,e){super(),this.username=t,this.cleavage=e,this.eventType=K.PLAYER_SUGGEST_CLEAVAGE}}class _u extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return t.message.startsWith(Uh)?this.onApplicationEvent(t.username,t.message):Promise.resolve()}onApplicationEvent(t,e){return this.applicationServices.cleavage.hasCurrentCleavage().then((n=>n?this.onCurrentCleavage(t,e):this.applyStrategies(t,this.applicationEventStrategiesWithoutCurrentCleavage(t,e)))).catch((t=>Promise.reject(t)))}onCurrentCleavage(t,e){return this.applicationServices.cleavage.loadCurrentCleavage().then((n=>{const i=new Map;for(const[n,r]of this.applicationEventStrategiesWithoutCurrentCleavage(t,e).entries())i.set(n,r);for(const[r,s]of this.applicationEventStrategiesWithCurrentCleavage(t,e,n).entries())i.set(r,s);return this.applyStrategies(t,i)}))}applyStrategies(t,e){const n=e.get(!0);return n?"string"==typeof n?this.applicationServices.chat.sendMessageToPlayer(new Eh(t,n)):this.applicationServices.event.sentEvent(n):this.applicationServices.chat.sendMessageToPlayer(new Eh(t,(t=>`I don't know what to do with that ${t}.`)(t)))}applicationEventStrategiesWithCurrentCleavage(t,e,n){const i=new Map;var r;return i.set((Uh+n.rightChoice.name.toLocaleLowerCase()).startsWith(e.toLocaleLowerCase()),new cu(t,bh.RIGHT)),i.set((Uh+n.leftChoice.name.toLocaleLowerCase()).startsWith(e.toLocaleLowerCase()),new cu(t,bh.LEFT)),i.set((Uh+n.leftChoice.name.toLocaleLowerCase()).startsWith(e.toLocaleLowerCase())&&(Uh+n.rightChoice.name.toLocaleLowerCase()).startsWith(e.toLocaleLowerCase()),`C'est pas clair... Voila les choix possibles '${(r=n).leftChoice.name}', '${r.rightChoice.name}'.`),i.set(e===Uh+n.leftChoice.name,new cu(t,bh.LEFT)),i.set(e===Uh+n.rightChoice.name,new cu(t,bh.RIGHT)),i}applicationEventStrategiesWithoutCurrentCleavage(t,e){const n=new Map;return n.set(e===Uh+Gh.SHORT_APPLAUSE,new uu),n.set(e===Uh+Gh.SHORT_WHISTLE,new fu),n.set(e===Uh+Gh.SHORT_HYPERLIKE,new pu),n.set(e===Uh+Gh.SHORT_SHOOT,new du),n.set(e===Uh+Gh.RIGHT,new cu(t,bh.RIGHT)),n.set(e===Uh+Gh.LEFT,new cu(t,bh.LEFT)),n.set(e===Uh+Gh.HELP,new lu(t)),n.set(e===Uh+Gh.SHORT_HELP,new lu(t)),n.set(e.startsWith(Uh+Gh.SUGGEST_CLEAVAGE),new mu(t,this.newCleavageFromMessage(e))),n.set(e.replace(" ","")===Uh+Gh.SUGGEST_CLEAVAGE,"Il manque le titre ma gueule!"),n.set("!gauche".toLocaleLowerCase().startsWith(e.toLocaleLowerCase()),new cu(t,bh.LEFT)),n.set("!droite".toLocaleLowerCase().startsWith(e.toLocaleLowerCase()),new cu(t,bh.RIGHT)),n.set("!1"===e,new cu(t,bh.LEFT)),n.set("!2"===e,new cu(t,bh.RIGHT)),n}newCleavageFromMessage(t){return new Th({title:t.replace(Uh+Gh.SUGGEST_CLEAVAGE,"").trimStart(),leftChoice:{name:"Gôche",players:[]},rightChoice:{name:"Drouate",players:[]},players:[]})}}class gu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.autoplay.hasAutoplay().then((t=>t?this.onAutoPlay():Promise.resolve())).catch((t=>Promise.reject(t)))}onAutoPlay(){return this.applicationServices.autoplay.isTimeForNextCleavage().then((t=>t?this.onTimeForNextCleavage():Promise.resolve())).catch((t=>Promise.reject(t)))}onTimeForNextCleavage(){return Promise.resolve([this.applicationServices.autoplay.configureNextAutoPlay(),this.applicationServices.event.sentEvent(new $t)]).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}}class vu extends J{constructor(){super(),this.eventType=K.DRAW_CLEAVAGE}}class yu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.autoplay.configureNextAutoPlay(t.autoplayMinutes).then((()=>this.applicationServices.interface.enableAutoplay())).then((()=>this.applicationServices.event.sentEvent(new vu))).catch((t=>Promise.reject(t)))}}class Tu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.autoplay.configureNextAutoPlay(0).then((()=>this.applicationServices.interface.disableAutoplay())).catch((t=>Promise.reject(t)))}}class Eu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.bar.hasAvailableTableStool().then((e=>e?this.onTableStoolAvailable(t.username):this.onTableStoolUnavailable(t.username))).catch((t=>Promise.reject(t)))}onTableStoolAvailable(t){return this.applicationServices.bar.installPlayerOnTableStool(t)}onTableStoolUnavailable(t){return this.applicationServices.bar.hasAvailableBarStool().then((e=>e?this.onBarStoolAvailable(t):this.onBarStoolUnavailable(t))).catch((t=>Promise.reject(t)))}onBarStoolUnavailable(t){return this.applicationServices.bar.playerQuit(t)}onBarStoolAvailable(t){return this.applicationServices.bar.installPlayerOnBarStool(t)}}class bu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.player.updatePosition(t.username,t.position,Ih)}}class xu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.bar.installNewTable()}}class Au extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.bar.installStoolForTable(t.tableId)}}class Su extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.onEvent()}onEvent(){return this.applicationServices.bar.nextOccupiedBarStool().then((t=>t?this.onOccupiedBarStool(t):Promise.resolve())).catch((t=>Promise.reject(t)))}onOccupiedBarStool(t){return this.applicationServices.bar.hasAvailableTableStool().then((e=>e?this.onTableStoolAvailable(t):this.applicationServices.bar.askForNewTable())).catch((t=>Promise.reject(t)))}onTableStoolAvailable(t){return this.applicationServices.bar.installPlayerFromBarStoolToTableStool(t).then((()=>this.onEvent())).catch((t=>Promise.reject(t)))}}class wu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.bar.installBar()}}class Ru extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.bar.installStoolForBar()}}class Cu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return t.interfaceEntityState?this.applicationServices.interface.updateEntityInterfaceState(t.id,t.interfaceEntityState):this.applicationServices.interface.removeEntityInterfaceState(t.id)}}class Ou extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.cleavage.retrieveCurrentGamePhase().then((e=>this.onPreviousGamePhase(t,e)))}onPreviousGamePhase(t,e){return this.applicationServices.cleavage.changeGamePhase(t.gamePhase).then((()=>this.applicationServices.interface.changeGamePhase(t.gamePhase))).then((()=>e!==At.NONE?this.applicationServices.interface.playSound(new wh(xh.POUFFF)):Promise.resolve())).catch((t=>Promise.reject(t)))}}class Iu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.cleavage.hasCurrentCleavage().then((t=>t?this.onCleavage():this.withoutCleavage()))}onCleavage(){return this.applicationServices.cleavage.loadCurrentCleavage().then((t=>Promise.all([this.applicationServices.autoplay.hasAutoplay(),this.applicationServices.videoExtract.hasVideoExtractForChoice(t.majorChoice()),t]))).then((([t,e,n])=>e?this.onVideoExtract(n,t,e):this.sendNextEvents(t,e))).catch((t=>Promise.reject(t)))}onVideoExtract(t,e,n){return this.applicationServices.videoExtract.applyVideoExtractOnInterface(t).then((()=>this.sendNextEvents(e,n))).catch((t=>Promise.reject(t)))}withoutCleavage(){return this.applicationServices.autoplay.hasAutoplay().then((t=>this.sendNextEvents(t,!1))).catch((t=>Promise.reject(t)))}sendNextEvents(t,e){return this.applicationServices.event.sentEvents([new ph(e?At.PLAY_VIDEO:At.NEW_CLEAVAGE),...t&&!e?[new vu]:[]]).catch((t=>Promise.reject(t)))}}class Pu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return Promise.all([this.applicationServices.videoExtract.removeVideoExtractOnInterface()]).then((()=>this.applicationServices.autoplay.hasAutoplay())).then((t=>this.applicationServices.event.sentEvents([new ph(At.NEW_CLEAVAGE),...t?[new vu]:[]])))}}class Nu extends Lh{constructor(t){super(),this.applicationServices=t}execute(t){return this.applicationServices.interface.changeVideoExtractVolumeLevel(t.volume)}}class Mu{constructor(t){this.applicationServices=t,this.useCases=new Map([]),this.useCases.set(K.DISCONNECT_CHAT,new Qh(this.applicationServices)),this.useCases.set(K.CONNECT_CHAT,new hu(this.applicationServices)),this.useCases.set(K.NEW_CLEAVAGE,new iu(this.applicationServices)),this.useCases.set(K.LAUNCH_CLEAVAGE,new Jh(this.applicationServices)),this.useCases.set(K.PLAYER_MESSAGE,new _u(this.applicationServices)),this.useCases.set(K.PLAYER_CLEAVE,new Yh(this.applicationServices)),this.useCases.set(K.DRAW_CLEAVAGE,new eu(this.applicationServices)),this.useCases.set(K.PLAYER_SUGGEST_CLEAVAGE,new Kh(this.applicationServices)),this.useCases.set(K.PLAYER_ASK_FOR_HELP,new kh(this.applicationServices)),this.useCases.set(K.CANCEL_CLEAVAGE,new Vh(this.applicationServices)),this.useCases.set(K.PLAYER_APPLAUSE,new $h(this.applicationServices)),this.useCases.set(K.PLAYER_HYPERLIKE,new Wh(this.applicationServices)),this.useCases.set(K.PLAYER_WHISTLE,new Zh(this.applicationServices)),this.useCases.set(K.PLAYER_SHOOT,new qh(this.applicationServices)),this.useCases.set(K.APPLICATION_START,new Fh(this.applicationServices)),this.useCases.set(K.NAVIGATE,new Hh(this.applicationServices)),this.useCases.set(K.CHANGE_MUSIC_VOLUME,new Xh(this.applicationServices.interface)),this.useCases.set(K.CHANGE_SOUND_VOLUME,new jh(this.applicationServices.interface)),this.useCases.set(K.PLAYER_QUIT,new zh(this.applicationServices)),this.useCases.set(K.START_AUTOPLAY,new yu(this.applicationServices)),this.useCases.set(K.CHECK_AUTOPLAY,new gu(this.applicationServices)),this.useCases.set(K.STOP_AUTOPLAY,new Tu(this.applicationServices)),this.useCases.set(K.PLAYER_JOIN_BAR,new Eu(this.applicationServices)),this.useCases.set(K.PLAYER_MOVE,new bu(this.applicationServices)),this.useCases.set(K.INSTALL_NEW_TABLE,new xu(this.applicationServices)),this.useCases.set(K.INSTALL_NEW_STOOLS_ON_TABLE,new Au(this.applicationServices)),this.useCases.set(K.TABLE_STOOL_AVAILABLE,new Su(this.applicationServices)),this.useCases.set(K.CREATE_BAR,new wu(this.applicationServices)),this.useCases.set(K.INSTALL_NEW_STOOLS_ON_BAR,new Ru(this.applicationServices)),this.useCases.set(K.DRAW,new Cu(this.applicationServices)),this.useCases.set(K.CHANGE_GAME_PHASE,new Ou(this.applicationServices)),this.useCases.set(K.VIDEO_EXTRACT_START,new Iu(this.applicationServices)),this.useCases.set(K.VIDEO_EXTRACT_STOP,new Pu(this.applicationServices)),this.useCases.set(K.CHANGE_VIDEO_EXTRACT_VOLUME,new Nu(this.applicationServices))}executeEvent(t){const e=this.useCases.get(t.eventType);return e?e.execute(t):Promise.reject(new Error(((t,e)=>`Event '${t.eventType}' is not supported by ${e.constructor.name}.`)(t,this)))}}var Du={exports:{}},Lu=oe(Object.freeze({__proto__:null,default:{}})),Fu={exports:{}};const Uu=/^\u0001ACTION ([^\u0001]+)\u0001$/,Gu=/^(justinfan)(\d+$)/,Bu=/\\([sn:r\\])/g,ku=/([ \n;\r\\])/g,Vu={s:" ",n:"",":":";",r:""},Xu={" ":"s","\n":"n",";":":","\r":"r"},ju=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i"),Hu=/[|\\^$*+?:#]/,$u=Fu.exports={get:(t,e)=>void 0===t?e:t,hasOwn:(t,e)=>({}.hasOwnProperty.call(t,e)),promiseDelay:t=>new Promise((e=>setTimeout(e,t))),isFinite:t=>isFinite(t)&&!isNaN(parseFloat(t)),toNumber(t,e){if(null===t)return 0;const n=Math.pow(10,$u.isFinite(e)?e:0);return Math.round(t*n)/n},isInteger:t=>!isNaN($u.toNumber(t,0)),isRegex:t=>Hu.test(t),isURL:t=>ju.test(t),justinfan:()=>`justinfan${Math.floor(8e4*Math.random()+1e3)}`,isJustinfan:t=>Gu.test(t),channel(t){const e=(t||"").toLowerCase();return"#"===e[0]?e:"#"+e},username(t){const e=(t||"").toLowerCase();return"#"===e[0]?e.slice(1):e},token:t=>t?t.toLowerCase().replace("oauth:",""):"",password(t){const e=$u.token(t);return e?`oauth:${e}`:""},actionMessage:t=>t.match(Uu),replaceAll(t,e){if(null==t)return null;for(const n in e)t=t.replace(new RegExp(n,"g"),e[n]);return t},unescapeHtml:t=>t.replace(/\\&amp\\;/g,"&").replace(/\\&lt\\;/g,"<").replace(/\\&gt\\;/g,">").replace(/\\&quot\\;/g,'"').replace(/\\&#039\\;/g,"'"),unescapeIRC:t=>t&&"string"==typeof t&&t.includes("\\")?t.replace(Bu,((t,e)=>e in Vu?Vu[e]:e)):t,escapeIRC:t=>t&&"string"==typeof t?t.replace(ku,((t,e)=>e in Xu?`\\${Xu[e]}`:e)):t,addWord:(t,e)=>t.length?t+" "+e:t+e,splitLine(t,e){let n=t.substring(0,e).lastIndexOf(" ");return-1===n&&(n=e-1),[t.substring(0,n),t.substring(n+1)]},extractNumber(t){const e=t.split(" ");for(let t=0;t<e.length;t++)if($u.isInteger(e[t]))return~~e[t];return 0},formatDate(t){let e=t.getHours(),n=t.getMinutes();return e=(e<10?"0":"")+e,n=(n<10?"0":"")+n,`${e}:${n}`},inherits(t,e){t.super_=e;const n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t},isNode(){try{return"object"==typeof process&&"[object process]"===Object.prototype.toString.call(process)}catch(t){}return!1}},Yu=Lu,Wu=Fu.exports;var zu=function(t,e){let n=void 0!==t.url?t.url:t.uri;if(Wu.isURL(n)||(n=`https://api.twitch.tv/kraken${"/"===n[0]?n:`/${n}`}`),Wu.isNode()){const i=Object.assign({method:"GET",json:!0},t);if(i.qs){n+=`?${new URLSearchParams(i.qs)}`}const r={};"fetchAgent"in this.opts.connection&&(r.agent=this.opts.connection.fetchAgent);const s=Yu(n,{...r,method:i.method,headers:i.headers,body:i.body});let o={};s.then((t=>(o={statusCode:t.status,headers:t.headers},i.json?t.json():t.text()))).then((t=>e(null,o,t)),(t=>e(t,o,null)))}else{const i=Object.assign({method:"GET",headers:{}},t,{url:n}),r=new XMLHttpRequest;r.open(i.method,i.url,!0);for(const t in i.headers)r.setRequestHeader(t,i.headers[t]);r.responseType="json",r.addEventListener("load",(t=>{4===r.readyState&&(200!==r.status?e(r.status,null,null):e(null,null,r.response))})),r.send()}};const qu=Fu.exports;function Zu(t,e){return t=qu.channel(t),e=qu.get(e,30),this._sendCommand(null,t,`/followers ${e}`,((n,i)=>{this.once("_promiseFollowers",(r=>{r?i(r):n([t,~~e])}))}))}function Ku(t){return t=qu.channel(t),this._sendCommand(null,t,"/followersoff",((e,n)=>{this.once("_promiseFollowersoff",(i=>{i?n(i):e([t])}))}))}function Ju(t){return t=qu.channel(t),this._sendCommand(null,null,`PART ${t}`,((e,n)=>{this.once("_promisePart",(i=>{i?n(i):e([t])}))}))}function Qu(t){return t=qu.channel(t),this._sendCommand(null,t,"/r9kbeta",((e,n)=>{this.once("_promiseR9kbeta",(i=>{i?n(i):e([t])}))}))}function tl(t){return t=qu.channel(t),this._sendCommand(null,t,"/r9kbetaoff",((e,n)=>{this.once("_promiseR9kbetaoff",(i=>{i?n(i):e([t])}))}))}function el(t,e){return t=qu.channel(t),e=qu.get(e,300),this._sendCommand(null,t,`/slow ${e}`,((n,i)=>{this.once("_promiseSlow",(r=>{r?i(r):n([t,~~e])}))}))}function nl(t){return t=qu.channel(t),this._sendCommand(null,t,"/slowoff",((e,n)=>{this.once("_promiseSlowoff",(i=>{i?n(i):e([t])}))}))}var il={action(t,e){return t=qu.channel(t),e=`ACTION ${e}`,this._sendMessage(this._getPromiseDelay(),t,e,((n,i)=>{n([t,e])}))},ban(t,e,n){return t=qu.channel(t),e=qu.username(e),n=qu.get(n,""),this._sendCommand(null,t,`/ban ${e} ${n}`,((i,r)=>{this.once("_promiseBan",(s=>{s?r(s):i([t,e,n])}))}))},clear(t){return t=qu.channel(t),this._sendCommand(null,t,"/clear",((e,n)=>{this.once("_promiseClear",(i=>{i?n(i):e([t])}))}))},color(t,e){return e=qu.get(e,t),this._sendCommand(null,"#tmijs",`/color ${e}`,((t,n)=>{this.once("_promiseColor",(i=>{i?n(i):t([e])}))}))},commercial(t,e){return t=qu.channel(t),e=qu.get(e,30),this._sendCommand(null,t,`/commercial ${e}`,((n,i)=>{this.once("_promiseCommercial",(r=>{r?i(r):n([t,~~e])}))}))},deletemessage(t,e){return t=qu.channel(t),this._sendCommand(null,t,`/delete ${e}`,((e,n)=>{this.once("_promiseDeletemessage",(i=>{i?n(i):e([t])}))}))},emoteonly(t){return t=qu.channel(t),this._sendCommand(null,t,"/emoteonly",((e,n)=>{this.once("_promiseEmoteonly",(i=>{i?n(i):e([t])}))}))},emoteonlyoff(t){return t=qu.channel(t),this._sendCommand(null,t,"/emoteonlyoff",((e,n)=>{this.once("_promiseEmoteonlyoff",(i=>{i?n(i):e([t])}))}))},followersonly:Zu,followersmode:Zu,followersonlyoff:Ku,followersmodeoff:Ku,host(t,e){return t=qu.channel(t),e=qu.username(e),this._sendCommand(2e3,t,`/host ${e}`,((n,i)=>{this.once("_promiseHost",((r,s)=>{r?i(r):n([t,e,~~s])}))}))},join(t){return t=qu.channel(t),this._sendCommand(void 0,null,`JOIN ${t}`,((e,n)=>{const i="_promiseJoin";let r=!1;const s=(o,a)=>{t===qu.channel(a)&&(this.removeListener(i,s),r=!0,o?n(o):e([t]))};this.on(i,s);const o=this._getPromiseDelay();qu.promiseDelay(o).then((()=>{r||this.emit(i,"No response from Twitch.",t)}))}))},mod(t,e){return t=qu.channel(t),e=qu.username(e),this._sendCommand(null,t,`/mod ${e}`,((n,i)=>{this.once("_promiseMod",(r=>{r?i(r):n([t,e])}))}))},mods(t){return t=qu.channel(t),this._sendCommand(null,t,"/mods",((e,n)=>{this.once("_promiseMods",((i,r)=>{i?n(i):(r.forEach((e=>{this.moderators[t]||(this.moderators[t]=[]),this.moderators[t].includes(e)||this.moderators[t].push(e)})),e(r))}))}))},part:Ju,leave:Ju,ping(){return this._sendCommand(null,null,"PING",((t,e)=>{this.latency=new Date,this.pingTimeout=setTimeout((()=>{null!==this.ws&&(this.wasCloseCalled=!1,this.log.error("Ping timeout."),this.ws.close(),clearInterval(this.pingLoop),clearTimeout(this.pingTimeout))}),qu.get(this.opts.connection.timeout,9999)),this.once("_promisePing",(e=>t([parseFloat(e)])))}))},r9kbeta:Qu,r9kmode:Qu,r9kbetaoff:tl,r9kmodeoff:tl,raw(t){return this._sendCommand(null,null,t,((e,n)=>{e([t])}))},say(t,e){return t=qu.channel(t),e.startsWith(".")&&!e.startsWith("..")||e.startsWith("/")||e.startsWith("\\")?"me "===e.substr(1,3)?this.action(t,e.substr(4)):this._sendCommand(null,t,e,((n,i)=>{n([t,e])})):this._sendMessage(this._getPromiseDelay(),t,e,((n,i)=>{n([t,e])}))},slow:el,slowmode:el,slowoff:nl,slowmodeoff:nl,subscribers(t){return t=qu.channel(t),this._sendCommand(null,t,"/subscribers",((e,n)=>{this.once("_promiseSubscribers",(i=>{i?n(i):e([t])}))}))},subscribersoff(t){return t=qu.channel(t),this._sendCommand(null,t,"/subscribersoff",((e,n)=>{this.once("_promiseSubscribersoff",(i=>{i?n(i):e([t])}))}))},timeout(t,e,n,i){return t=qu.channel(t),e=qu.username(e),null===n||qu.isInteger(n)||(i=n,n=300),n=qu.get(n,300),i=qu.get(i,""),this._sendCommand(null,t,`/timeout ${e} ${n} ${i}`,((r,s)=>{this.once("_promiseTimeout",(o=>{o?s(o):r([t,e,~~n,i])}))}))},unban(t,e){return t=qu.channel(t),e=qu.username(e),this._sendCommand(null,t,`/unban ${e}`,((n,i)=>{this.once("_promiseUnban",(r=>{r?i(r):n([t,e])}))}))},unhost(t){return t=qu.channel(t),this._sendCommand(2e3,t,"/unhost",((e,n)=>{this.once("_promiseUnhost",(i=>{i?n(i):e([t])}))}))},unmod(t,e){return t=qu.channel(t),e=qu.username(e),this._sendCommand(null,t,`/unmod ${e}`,((n,i)=>{this.once("_promiseUnmod",(r=>{r?i(r):n([t,e])}))}))},unvip(t,e){return t=qu.channel(t),e=qu.username(e),this._sendCommand(null,t,`/unvip ${e}`,((n,i)=>{this.once("_promiseUnvip",(r=>{r?i(r):n([t,e])}))}))},vip(t,e){return t=qu.channel(t),e=qu.username(e),this._sendCommand(null,t,`/vip ${e}`,((n,i)=>{this.once("_promiseVip",(r=>{r?i(r):n([t,e])}))}))},vips(t){return t=qu.channel(t),this._sendCommand(null,t,"/vips",((t,e)=>{this.once("_promiseVips",((n,i)=>{n?e(n):t(i)}))}))},whisper(t,e){return(t=qu.username(t))===this.getUsername()?Promise.reject("Cannot send a whisper to the same account."):this._sendCommand(null,"#tmijs",`/w ${t} ${e}`,((t,e)=>{this.once("_promiseWhisper",(t=>{t&&e(t)}))})).catch((n=>{if(n&&"string"==typeof n&&0!==n.indexOf("No response from Twitch."))throw n;const i=qu.channel(t),r=Object.assign({"message-type":"whisper","message-id":null,"thread-id":null,username:this.getUsername()},this.globaluserstate);return this.emits(["whisper","message"],[[i,r,e,!0],[i,r,e,!0]]),[t,e]}))}};function rl(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var sl=rl;function ol(t){return"function"==typeof t}function al(t){return"object"==typeof t&&null!==t}function hl(t){return void 0===t}rl.EventEmitter=rl,rl.prototype._events=void 0,rl.prototype._maxListeners=void 0,rl.defaultMaxListeners=10,rl.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},rl.prototype.emit=function(t){var e,n,i,r,s,o;if(this._events||(this._events={}),"error"===t&&(!this._events.error||al(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(hl(n=this._events[t]))return!1;if(ol(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),n.apply(this,r)}else if(al(n))for(r=Array.prototype.slice.call(arguments,1),i=(o=n.slice()).length,s=0;s<i;s++)o[s].apply(this,r);return!0},rl.prototype.addListener=function(t,e){var n;if(!ol(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,ol(e.listener)?e.listener:e),this._events[t]?al(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,al(this._events[t])&&!this._events[t].warned&&(n=hl(this._maxListeners)?rl.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},rl.prototype.on=rl.prototype.addListener,rl.prototype.once=function(t,e){if(!ol(e))throw TypeError("listener must be a function");var n=!1;if(this._events.hasOwnProperty(t)&&"_"===t.charAt(0)){var i=1,r=t;for(var s in this._events)this._events.hasOwnProperty(s)&&s.startsWith(r)&&i++;t+=i}function o(){"_"!==t.charAt(0)||isNaN(t.substr(t.length-1))||(t=t.substring(0,t.length-1)),this.removeListener(t,o),n||(n=!0,e.apply(this,arguments))}return o.listener=e,this.on(t,o),this},rl.prototype.removeListener=function(t,e){var n,i,r,s;if(!ol(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=(n=this._events[t]).length,i=-1,n===e||ol(n.listener)&&n.listener===e){if(delete this._events[t],this._events.hasOwnProperty(t+"2")&&"_"===t.charAt(0)){var o=t;for(var a in this._events)this._events.hasOwnProperty(a)&&a.startsWith(o)&&(isNaN(parseInt(a.substr(a.length-1)))||(this._events[t+parseInt(a.substr(a.length-1)-1)]=this._events[a],delete this._events[a]));this._events[t]=this._events[t+"1"],delete this._events[t+"1"]}this._events.removeListener&&this.emit("removeListener",t,e)}else if(al(n)){for(s=r;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},rl.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(ol(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},rl.prototype.listeners=function(t){return this._events&&this._events[t]?ol(this._events[t])?[this._events[t]]:this._events[t].slice():[]},rl.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(ol(e))return 1;if(e)return e.length}return 0},rl.listenerCount=function(t,e){return t.listenerCount(e)};const ul=Fu.exports;let ll="info";const cl={trace:0,debug:1,info:2,warn:3,error:4,fatal:5};function pl(t){return function(e){cl[t]>=cl[ll]&&console.log(`[${ul.formatDate(new Date)}] ${t}: ${e}`)}}var dl={setLevel(t){ll=t},trace:pl("trace"),debug:pl("debug"),info:pl("info"),warn:pl("warn"),error:pl("error"),fatal:pl("fatal")};const fl=Fu.exports,ml=/\S+/g;function _l(t,e,n=",",i="/",r){const s=t[e];if(void 0===s)return t;const o="string"==typeof s;if(t[e+"-raw"]=o?s:null,!0===s)return t[e]=null,t;if(t[e]={},o){const o=s.split(n);for(let n=0;n<o.length;n++){const s=o[n].split(i);let a=s[1];void 0!==r&&a&&(a=a.split(r)),t[e][s[0]]=a||null}}return t}var gl={badges:t=>_l(t,"badges"),badgeInfo:t=>_l(t,"badge-info"),emotes:t=>_l(t,"emotes","/",":",","),emoteRegex(t,e,n,i){ml.lastIndex=0;const r=new RegExp("(\\b|^|\\s)"+fl.unescapeHtml(e)+"(\\b|$|\\s)");let s;for(;null!==(s=ml.exec(t));)r.test(s[0])&&(i[n]=i[n]||[],i[n].push([s.index,ml.lastIndex-1]))},emoteString(t,e,n,i){let r;for(ml.lastIndex=0;null!==(r=ml.exec(t));)r[0]===fl.unescapeHtml(e)&&(i[n]=i[n]||[],i[n].push([r.index,ml.lastIndex-1]))},transformEmotes(t){let e="";return Object.keys(t).forEach((n=>{e=`${e+n}:`,t[n].forEach((t=>e=`${e+t.join("-")},`)),e=`${e.slice(0,-1)}/`})),e.slice(0,-1)},formTags(t){const e=[];for(const n in t){const i=fl.escapeIRC(t[n]);e.push(`${n}=${i}`)}return`@${e.join(";")}`},msg(t){const e={raw:t,tags:{},prefix:null,command:null,params:[]};let n=0,i=0;if(64===t.charCodeAt(0)){if(i=t.indexOf(" "),-1===i)return null;const r=t.slice(1,i).split(";");for(let t=0;t<r.length;t++){const n=r[t],i=n.split("=");e.tags[i[0]]=n.substring(n.indexOf("=")+1)||!0}n=i+1}for(;32===t.charCodeAt(n);)n++;if(58===t.charCodeAt(n)){if(i=t.indexOf(" ",n),-1===i)return null;for(e.prefix=t.slice(n+1,i),n=i+1;32===t.charCodeAt(n);)n++}if(i=t.indexOf(" ",n),-1===i)return t.length>n?(e.command=t.slice(n),e):null;for(e.command=t.slice(n,i),n=i+1;32===t.charCodeAt(n);)n++;for(;n<t.length;){if(i=t.indexOf(" ",n),58===t.charCodeAt(n)){e.params.push(t.slice(n+1));break}if(-1===i){if(-1===i){e.params.push(t.slice(n));break}}else for(e.params.push(t.slice(n,i)),n=i+1;32===t.charCodeAt(n);)n++}return e}};var vl=class{constructor(t){this.queue=[],this.index=0,this.defaultDelay=void 0===t?3e3:t}add(t,e){this.queue.push({fn:t,delay:e})}next(){const t=this.index++,e=this.queue[t];if(!e)return;const n=this.queue[this.index];if(e.fn(),n){const t=void 0===n.delay?this.defaultDelay:n.delay;setTimeout((()=>this.next()),t)}}};!function(t){const e=void 0!==se?se:"undefined"!=typeof window?window:{},n=e.WebSocket||Lu,i=e.fetch||Lu,r=zu,s=il,o=sl.EventEmitter,a=dl,h=gl,u=vl,l=Fu.exports;let c=!1;const p=function t(e){if(this instanceof t==!1)return new t(e);this.opts=l.get(e,{}),this.opts.channels=this.opts.channels||[],this.opts.connection=this.opts.connection||{},this.opts.identity=this.opts.identity||{},this.opts.options=this.opts.options||{},this.clientId=l.get(this.opts.options.clientId,null),this._globalDefaultChannel=l.channel(l.get(this.opts.options.globalDefaultChannel,"#tmijs")),this._skipMembership=l.get(this.opts.options.skipMembership,!1),this._skipUpdatingEmotesets=l.get(this.opts.options.skipUpdatingEmotesets,!1),this._updateEmotesetsTimer=null,this._updateEmotesetsTimerDelay=l.get(this.opts.options.updateEmotesetsTimer,6e4),this.maxReconnectAttempts=l.get(this.opts.connection.maxReconnectAttempts,1/0),this.maxReconnectInterval=l.get(this.opts.connection.maxReconnectInterval,3e4),this.reconnect=l.get(this.opts.connection.reconnect,!0),this.reconnectDecay=l.get(this.opts.connection.reconnectDecay,1.5),this.reconnectInterval=l.get(this.opts.connection.reconnectInterval,1e3),this.reconnecting=!1,this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.secure=l.get(this.opts.connection.secure,!this.opts.connection.server&&!this.opts.connection.port),this.emotes="",this.emotesets={},this.channels=[],this.currentLatency=0,this.globaluserstate={},this.lastJoined="",this.latency=new Date,this.moderators={},this.pingLoop=null,this.pingTimeout=null,this.reason="",this.username="",this.userstate={},this.wasCloseCalled=!1,this.ws=null;let n="error";this.opts.options.debug&&(n="info"),this.log=this.opts.logger||a;try{a.setLevel(n)}catch(t){}this.opts.channels.forEach(((t,e,n)=>n[e]=l.channel(t))),o.call(this),this.setMaxListeners(0)};l.inherits(p,o);for(const t in s)p.prototype[t]=s[t];p.prototype.emits=function(t,e){for(let n=0;n<t.length;n++){const i=n<e.length?e[n]:e[e.length-1];this.emit.apply(this,[t[n]].concat(i))}},p.prototype.api=function(...t){c||(this.log.warn("Client.prototype.api is deprecated and will be removed for version 2.0.0"),c=!0),r(...t)},p.prototype.handleMessage=function(t){if(!t)return;this.listenerCount("raw_message")&&this.emit("raw_message",JSON.parse(JSON.stringify(t)),t);const e=l.channel(l.get(t.params[0],null));let n=l.get(t.params[1],null);const i=l.get(t.tags["msg-id"],null),r=t.tags=h.badges(h.badgeInfo(h.emotes(t.tags)));for(const t in r){if("emote-sets"===t||"ban-duration"===t||"bits"===t)continue;let e=r[t];"boolean"==typeof e?e=null:"1"===e?e=!0:"0"===e?e=!1:"string"==typeof e&&(e=l.unescapeIRC(e)),r[t]=e}if(null===t.prefix)switch(t.command){case"PING":this.emit("ping"),this._isConnected()&&this.ws.send("PONG");break;case"PONG":{const t=new Date;this.currentLatency=(t.getTime()-this.latency.getTime())/1e3,this.emits(["pong","_promisePing"],[[this.currentLatency]]),clearTimeout(this.pingTimeout);break}default:this.log.warn(`Could not parse message with no prefix:\n${JSON.stringify(t,null,4)}`)}else if("tmi.twitch.tv"===t.prefix)switch(t.command){case"002":case"003":case"004":case"372":case"375":case"CAP":case"SERVERCHANGE":break;case"001":this.username=t.params[0];break;case"376":{this.log.info("Connected to server."),this.userstate[this._globalDefaultChannel]={},this.emits(["connected","_promiseConnect"],[[this.server,this.port],[null]]),this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.pingLoop=setInterval((()=>{this._isConnected()&&this.ws.send("PING"),this.latency=new Date,this.pingTimeout=setTimeout((()=>{null!==this.ws&&(this.wasCloseCalled=!1,this.log.error("Ping timeout."),this.ws.close(),clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer))}),l.get(this.opts.connection.timeout,9999))}),6e4);let t=l.get(this.opts.options.joinInterval,2e3);t<300&&(t=300);const e=new u(t),n=[...new Set([...this.opts.channels,...this.channels])];this.channels=[];for(let t=0;t<n.length;t++){const i=n[t];e.add((()=>{this._isConnected()&&this.join(i).catch((t=>this.log.error(t)))}))}e.next();break}case"NOTICE":{const r=[null],s=[e,i,n],o=[e,!0],a=[e,!1],h=[s,r],u=[s,[i]],l=`[${e}] ${n}`;switch(i){case"subs_on":this.log.info(`[${e}] This room is now in subscribers-only mode.`),this.emits(["subscriber","subscribers","_promiseSubscribers"],[o,o,r]);break;case"subs_off":this.log.info(`[${e}] This room is no longer in subscribers-only mode.`),this.emits(["subscriber","subscribers","_promiseSubscribersoff"],[a,a,r]);break;case"emote_only_on":this.log.info(`[${e}] This room is now in emote-only mode.`),this.emits(["emoteonly","_promiseEmoteonly"],[o,r]);break;case"emote_only_off":this.log.info(`[${e}] This room is no longer in emote-only mode.`),this.emits(["emoteonly","_promiseEmoteonlyoff"],[a,r]);break;case"slow_on":case"slow_off":case"followers_on_zero":case"followers_on":case"followers_off":case"host_on":case"host_off":break;case"r9k_on":this.log.info(`[${e}] This room is now in r9k mode.`),this.emits(["r9kmode","r9kbeta","_promiseR9kbeta"],[o,o,r]);break;case"r9k_off":this.log.info(`[${e}] This room is no longer in r9k mode.`),this.emits(["r9kmode","r9kbeta","_promiseR9kbetaoff"],[a,a,r]);break;case"room_mods":{const t=n.split(": "),i=(t.length>1?t[1]:"").toLowerCase().split(", ").filter((t=>t));this.emits(["_promiseMods","mods"],[[null,i],[e,i]]);break}case"no_mods":this.emits(["_promiseMods","mods"],[[null,[]],[e,[]]]);break;case"vips_success":{n.endsWith(".")&&(n=n.slice(0,-1));const t=n.split(": "),i=(t.length>1?t[1]:"").toLowerCase().split(", ").filter((t=>t));this.emits(["_promiseVips","vips"],[[null,i],[e,i]]);break}case"no_vips":this.emits(["_promiseVips","vips"],[[null,[]],[e,[]]]);break;case"already_banned":case"bad_ban_admin":case"bad_ban_anon":case"bad_ban_broadcaster":case"bad_ban_global_mod":case"bad_ban_mod":case"bad_ban_self":case"bad_ban_staff":case"usage_ban":this.log.info(l),this.emits(["notice","_promiseBan"],u);break;case"ban_success":this.log.info(l),this.emits(["notice","_promiseBan"],h);break;case"usage_clear":this.log.info(l),this.emits(["notice","_promiseClear"],u);break;case"usage_mods":this.log.info(l),this.emits(["notice","_promiseMods"],[s,[i,[]]]);break;case"mod_success":this.log.info(l),this.emits(["notice","_promiseMod"],h);break;case"usage_vips":this.log.info(l),this.emits(["notice","_promiseVips"],[s,[i,[]]]);break;case"usage_vip":case"bad_vip_grantee_banned":case"bad_vip_grantee_already_vip":case"bad_vip_max_vips_reached":case"bad_vip_achievement_incomplete":this.log.info(l),this.emits(["notice","_promiseVip"],[s,[i,[]]]);break;case"vip_success":this.log.info(l),this.emits(["notice","_promiseVip"],h);break;case"usage_mod":case"bad_mod_banned":case"bad_mod_mod":this.log.info(l),this.emits(["notice","_promiseMod"],u);break;case"unmod_success":this.log.info(l),this.emits(["notice","_promiseUnmod"],h);break;case"unvip_success":this.log.info(l),this.emits(["notice","_promiseUnvip"],h);break;case"usage_unmod":case"bad_unmod_mod":this.log.info(l),this.emits(["notice","_promiseUnmod"],u);break;case"usage_unvip":case"bad_unvip_grantee_not_vip":this.log.info(l),this.emits(["notice","_promiseUnvip"],u);break;case"color_changed":this.log.info(l),this.emits(["notice","_promiseColor"],h);break;case"usage_color":case"turbo_only_color":this.log.info(l),this.emits(["notice","_promiseColor"],u);break;case"commercial_success":this.log.info(l),this.emits(["notice","_promiseCommercial"],h);break;case"usage_commercial":case"bad_commercial_error":this.log.info(l),this.emits(["notice","_promiseCommercial"],u);break;case"hosts_remaining":{this.log.info(l);const t=isNaN(n[0])?0:parseInt(n[0]);this.emits(["notice","_promiseHost"],[s,[null,~~t]]);break}case"bad_host_hosting":case"bad_host_rate_exceeded":case"bad_host_error":case"usage_host":this.log.info(l),this.emits(["notice","_promiseHost"],[s,[i,null]]);break;case"already_r9k_on":case"usage_r9k_on":this.log.info(l),this.emits(["notice","_promiseR9kbeta"],u);break;case"already_r9k_off":case"usage_r9k_off":this.log.info(l),this.emits(["notice","_promiseR9kbetaoff"],u);break;case"timeout_success":this.log.info(l),this.emits(["notice","_promiseTimeout"],h);break;case"delete_message_success":this.log.info(`[${e} ${n}]`),this.emits(["notice","_promiseDeletemessage"],h);break;case"already_subs_off":case"usage_subs_off":this.log.info(l),this.emits(["notice","_promiseSubscribersoff"],u);break;case"already_subs_on":case"usage_subs_on":this.log.info(l),this.emits(["notice","_promiseSubscribers"],u);break;case"already_emote_only_off":case"usage_emote_only_off":this.log.info(l),this.emits(["notice","_promiseEmoteonlyoff"],u);break;case"already_emote_only_on":case"usage_emote_only_on":this.log.info(l),this.emits(["notice","_promiseEmoteonly"],u);break;case"usage_slow_on":this.log.info(l),this.emits(["notice","_promiseSlow"],u);break;case"usage_slow_off":this.log.info(l),this.emits(["notice","_promiseSlowoff"],u);break;case"usage_timeout":case"bad_timeout_admin":case"bad_timeout_anon":case"bad_timeout_broadcaster":case"bad_timeout_duration":case"bad_timeout_global_mod":case"bad_timeout_mod":case"bad_timeout_self":case"bad_timeout_staff":this.log.info(l),this.emits(["notice","_promiseTimeout"],u);break;case"untimeout_success":case"unban_success":this.log.info(l),this.emits(["notice","_promiseUnban"],h);break;case"usage_unban":case"bad_unban_no_ban":this.log.info(l),this.emits(["notice","_promiseUnban"],u);break;case"usage_delete":case"bad_delete_message_error":case"bad_delete_message_broadcaster":case"bad_delete_message_mod":this.log.info(l),this.emits(["notice","_promiseDeletemessage"],u);break;case"usage_unhost":case"not_hosting":this.log.info(l),this.emits(["notice","_promiseUnhost"],u);break;case"whisper_invalid_login":case"whisper_invalid_self":case"whisper_limit_per_min":case"whisper_limit_per_sec":case"whisper_restricted":case"whisper_restricted_recipient":this.log.info(l),this.emits(["notice","_promiseWhisper"],u);break;case"no_permission":case"msg_banned":case"msg_room_not_found":case"msg_channel_suspended":case"tos_ban":case"invalid_user":this.log.info(l),this.emits(["notice","_promiseBan","_promiseClear","_promiseUnban","_promiseTimeout","_promiseDeletemessage","_promiseMods","_promiseMod","_promiseUnmod","_promiseVips","_promiseVip","_promiseUnvip","_promiseCommercial","_promiseHost","_promiseUnhost","_promiseJoin","_promisePart","_promiseR9kbeta","_promiseR9kbetaoff","_promiseSlow","_promiseSlowoff","_promiseFollowers","_promiseFollowersoff","_promiseSubscribers","_promiseSubscribersoff","_promiseEmoteonly","_promiseEmoteonlyoff","_promiseWhisper"],[s,[i,e]]);break;case"msg_rejected":case"msg_rejected_mandatory":this.log.info(l),this.emit("automod",e,i,n);break;case"unrecognized_cmd":case"cmds_available":case"host_target_went_offline":case"msg_censored_broadcaster":case"msg_duplicate":case"msg_emoteonly":case"msg_verified_email":case"msg_ratelimit":case"msg_subsonly":case"msg_timedout":case"msg_bad_characters":case"msg_channel_blocked":case"msg_facebook":case"msg_followersonly":case"msg_followersonly_followed":case"msg_followersonly_zero":case"msg_slowmode":case"msg_suspended":case"no_help":case"usage_disconnect":case"usage_help":case"usage_me":case"unavailable_command":this.log.info(l),this.emit("notice",e,i,n);break;default:n.includes("Login unsuccessful")||n.includes("Login authentication failed")||n.includes("Error logging in")||n.includes("Improperly formatted auth")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason=n,this.log.error(this.reason),this.ws.close()):n.includes("Invalid NICK")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason="Invalid NICK.",this.log.error(this.reason),this.ws.close()):(this.log.warn(`Could not parse NOTICE from tmi.twitch.tv:\n${JSON.stringify(t,null,4)}`),this.emit("notice",e,i,n))}break}case"USERNOTICE":{const t=r["display-name"]||r.login,s=r["msg-param-sub-plan"]||"",o=l.unescapeIRC(l.get(r["msg-param-sub-plan-name"],""))||null,a={prime:s.includes("Prime"),plan:s,planName:o},h=~~(r["msg-param-streak-months"]||0),u=r["msg-param-recipient-display-name"]||r["msg-param-recipient-user-name"],c=~~r["msg-param-mass-gift-count"];switch(r["message-type"]=i,i){case"resub":this.emits(["resub","subanniversary"],[[e,t,h,n,r,a]]);break;case"sub":this.emits(["subscription","sub"],[[e,t,a,n,r]]);break;case"subgift":this.emit("subgift",e,t,h,u,a,r);break;case"anonsubgift":this.emit("anonsubgift",e,h,u,a,r);break;case"submysterygift":this.emit("submysterygift",e,t,c,a,r);break;case"anonsubmysterygift":this.emit("anonsubmysterygift",e,c,a,r);break;case"primepaidupgrade":this.emit("primepaidupgrade",e,t,a,r);break;case"giftpaidupgrade":{const n=r["msg-param-sender-name"]||r["msg-param-sender-login"];this.emit("giftpaidupgrade",e,t,n,r);break}case"anongiftpaidupgrade":this.emit("anongiftpaidupgrade",e,t,r);break;case"raid":{const t=r["msg-param-displayName"]||r["msg-param-login"],n=+r["msg-param-viewerCount"];this.emit("raided",e,t,n,r);break}case"ritual":{const i=r["msg-param-ritual-name"];if("new_chatter"===i)this.emit("newchatter",e,t,r,n);else this.emit("ritual",i,e,t,r,n);break}default:this.emit("usernotice",i,e,r,n)}break}case"HOSTTARGET":{const t=n.split(" "),i=~~t[1]||0;"-"===t[0]?(this.log.info(`[${e}] Exited host mode.`),this.emits(["unhost","_promiseUnhost"],[[e,i],[null]])):(this.log.info(`[${e}] Now hosting ${t[0]} for ${i} viewer(s).`),this.emit("hosting",e,t[0],i));break}case"CLEARCHAT":if(t.params.length>1){const i=l.get(t.tags["ban-duration"],null);null===i?(this.log.info(`[${e}] ${n} has been banned.`),this.emit("ban",e,n,null,t.tags)):(this.log.info(`[${e}] ${n} has been timed out for ${i} seconds.`),this.emit("timeout",e,n,null,~~i,t.tags))}else this.log.info(`[${e}] Chat was cleared by a moderator.`),this.emits(["clearchat","_promiseClear"],[[e],[null]]);break;case"CLEARMSG":if(t.params.length>1){const t=n,i=r.login;r["message-type"]="messagedeleted",this.log.info(`[${e}] ${i}'s message has been deleted.`),this.emit("messagedeleted",e,i,t,r)}break;case"RECONNECT":this.log.info("Received RECONNECT request from Twitch.."),this.log.info(`Disconnecting and reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.disconnect().catch((t=>this.log.error(t))),setTimeout((()=>this.connect().catch((t=>this.log.error(t)))),this.reconnectTimer);break;case"USERSTATE":t.tags.username=this.username,"mod"===t.tags["user-type"]&&(this.moderators[e]||(this.moderators[e]=[]),this.moderators[e].includes(this.username)||this.moderators[e].push(this.username)),l.isJustinfan(this.getUsername())||this.userstate[e]||(this.userstate[e]=r,this.lastJoined=e,this.channels.push(e),this.log.info(`Joined ${e}`),this.emit("join",e,l.username(this.getUsername()),!0)),t.tags["emote-sets"]!==this.emotes&&this._updateEmoteset(t.tags["emote-sets"]),this.userstate[e]=r;break;case"GLOBALUSERSTATE":this.globaluserstate=r,this.emit("globaluserstate",r),void 0!==t.tags["emote-sets"]&&this._updateEmoteset(t.tags["emote-sets"]);break;case"ROOMSTATE":if(l.channel(this.lastJoined)===e&&this.emit("_promiseJoin",null,e),t.tags.channel=e,this.emit("roomstate",e,t.tags),!l.hasOwn(t.tags,"subs-only")){if(l.hasOwn(t.tags,"slow"))if("boolean"!=typeof t.tags.slow||t.tags.slow){const n=[e,!0,~~t.tags.slow];this.log.info(`[${e}] This room is now in slow mode.`),this.emits(["slow","slowmode","_promiseSlow"],[n,n,[null]])}else{const t=[e,!1,0];this.log.info(`[${e}] This room is no longer in slow mode.`),this.emits(["slow","slowmode","_promiseSlowoff"],[t,t,[null]])}if(l.hasOwn(t.tags,"followers-only"))if("-1"===t.tags["followers-only"]){const t=[e,!1,0];this.log.info(`[${e}] This room is no longer in followers-only mode.`),this.emits(["followersonly","followersmode","_promiseFollowersoff"],[t,t,[null]])}else{const n=[e,!0,~~t.tags["followers-only"]];this.log.info(`[${e}] This room is now in follower-only mode.`),this.emits(["followersonly","followersmode","_promiseFollowers"],[n,n,[null]])}}break;default:this.log.warn(`Could not parse message from tmi.twitch.tv:\n${JSON.stringify(t,null,4)}`)}else if("jtv"===t.prefix)if("MODE"===t.command)"+o"===n?(this.moderators[e]||(this.moderators[e]=[]),this.moderators[e].includes(t.params[2])||this.moderators[e].push(t.params[2]),this.emit("mod",e,t.params[2])):"-o"===n&&(this.moderators[e]||(this.moderators[e]=[]),this.moderators[e].filter((e=>e!==t.params[2])),this.emit("unmod",e,t.params[2]));else this.log.warn(`Could not parse message from jtv:\n${JSON.stringify(t,null,4)}`);else switch(t.command){case"353":this.emit("names",t.params[2],t.params[3].split(" "));break;case"366":break;case"JOIN":{const n=t.prefix.split("!")[0];l.isJustinfan(this.getUsername())&&this.username===n&&(this.lastJoined=e,this.channels.push(e),this.log.info(`Joined ${e}`),this.emit("join",e,n,!0)),this.username!==n&&this.emit("join",e,n,!1);break}case"PART":{let n=!1;const i=t.prefix.split("!")[0];if(this.username===i){n=!0,this.userstate[e]&&delete this.userstate[e];let t=this.channels.indexOf(e);-1!==t&&this.channels.splice(t,1),t=this.opts.channels.indexOf(e),-1!==t&&this.opts.channels.splice(t,1),this.log.info(`Left ${e}`),this.emit("_promisePart",null)}this.emit("part",e,i,n);break}case"WHISPER":{const e=t.prefix.split("!")[0];this.log.info(`[WHISPER] <${e}>: ${n}`),l.hasOwn(t.tags,"username")||(t.tags.username=e),t.tags["message-type"]="whisper";const i=l.channel(t.tags.username);this.emits(["whisper","message"],[[i,t.tags,n,!1]]);break}case"PRIVMSG":if(t.tags.username=t.prefix.split("!")[0],"jtv"===t.tags.username){const t=l.username(n.split(" ")[0]),i=n.includes("auto");if(n.includes("hosting you for")){const r=l.extractNumber(n);this.emit("hosted",e,t,r,i)}else n.includes("hosting you")&&this.emit("hosted",e,t,0,i)}else{const i=l.get(this.opts.options.messagesLogLevel,"info"),r=l.actionMessage(n);if(t.tags["message-type"]=r?"action":"chat",n=r?r[1]:n,l.hasOwn(t.tags,"bits"))this.emit("cheer",e,t.tags,n);else{if(l.hasOwn(t.tags,"msg-id")){if("highlighted-message"===t.tags["msg-id"]){const i=t.tags["msg-id"];this.emit("redeem",e,t.tags.username,i,t.tags,n)}else if("skip-subs-mode-message"===t.tags["msg-id"]){const i=t.tags["msg-id"];this.emit("redeem",e,t.tags.username,i,t.tags,n)}}else if(l.hasOwn(t.tags,"custom-reward-id")){const i=t.tags["custom-reward-id"];this.emit("redeem",e,t.tags.username,i,t.tags,n)}r?(this.log[i](`[${e}] *<${t.tags.username}>: ${n}`),this.emits(["action","message"],[[e,t.tags,n,!1]])):(this.log[i](`[${e}] <${t.tags.username}>: ${n}`),this.emits(["chat","message"],[[e,t.tags,n,!1]]))}}break;default:this.log.warn(`Could not parse message:\n${JSON.stringify(t,null,4)}`)}},p.prototype.connect=function(){return new Promise(((t,e)=>{this.server=l.get(this.opts.connection.server,"irc-ws.chat.twitch.tv"),this.port=l.get(this.opts.connection.port,80),this.secure&&(this.port=443),443===this.port&&(this.secure=!0),this.reconnectTimer=this.reconnectTimer*this.reconnectDecay,this.reconnectTimer>=this.maxReconnectInterval&&(this.reconnectTimer=this.maxReconnectInterval),this._openConnection(),this.once("_promiseConnect",(n=>{n?e(n):t([this.server,~~this.port])}))}))},p.prototype._openConnection=function(){const t=`${this.secure?"wss":"ws"}://${this.server}:${this.port}/`,e={};"agent"in this.opts.connection&&(e.agent=this.opts.connection.agent),this.ws=new n(t,"irc",e),this.ws.onmessage=this._onMessage.bind(this),this.ws.onerror=this._onError.bind(this),this.ws.onclose=this._onClose.bind(this),this.ws.onopen=this._onOpen.bind(this)},p.prototype._onOpen=function(){this._isConnected()&&(this.log.info(`Connecting to ${this.server} on port ${this.port}..`),this.emit("connecting",this.server,~~this.port),this.username=l.get(this.opts.identity.username,l.justinfan()),this._getToken().then((t=>{const e=l.password(t);this.log.info("Sending authentication to server.."),this.emit("logon");let n="twitch.tv/tags twitch.tv/commands";this._skipMembership||(n+=" twitch.tv/membership"),this.ws.send("CAP REQ :"+n),e?this.ws.send(`PASS ${e}`):l.isJustinfan(this.username)&&this.ws.send("PASS SCHMOOPIIE"),this.ws.send(`NICK ${this.username}`)})).catch((t=>{this.emits(["_promiseConnect","disconnected"],[[t],["Could not get a token."]])})))},p.prototype._getToken=function(){const t=this.opts.identity.password;let e;return"function"==typeof t?(e=t(),e instanceof Promise?e:Promise.resolve(e)):Promise.resolve(t)},p.prototype._onMessage=function(t){t.data.trim().split("\r\n").forEach((t=>{const e=h.msg(t);e&&this.handleMessage(e)}))},p.prototype._onError=function(){this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer),this.reason=null===this.ws?"Connection closed.":"Unable to connect.",this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error(`Reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.emit("reconnect"),setTimeout((()=>{this.reconnecting=!1,this.connect().catch((t=>this.log.error(t)))}),this.reconnectTimer)),this.ws=null},p.prototype._onClose=function(){this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer),this.wasCloseCalled?(this.wasCloseCalled=!1,this.reason="Connection closed.",this.log.info(this.reason),this.emits(["_promiseConnect","_promiseDisconnect","disconnected"],[[this.reason],[null],[this.reason]])):(this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error(`Could not connect to server. Reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.emit("reconnect"),setTimeout((()=>{this.reconnecting=!1,this.connect().catch((t=>this.log.error(t)))}),this.reconnectTimer))),this.ws=null},p.prototype._getPromiseDelay=function(){return this.currentLatency<=600?600:this.currentLatency+100},p.prototype._sendCommand=function(t,e,n,i){return new Promise(((r,s)=>{if(!this._isConnected())return s("Not connected to server.");if(null!==t&&"number"!=typeof t||(null===t&&(t=this._getPromiseDelay()),l.promiseDelay(t).then((()=>s("No response from Twitch.")))),null!==e){const t=l.channel(e);this.log.info(`[${t}] Executing command: ${n}`),this.ws.send(`PRIVMSG ${t} :${n}`)}else this.log.info(`Executing command: ${n}`),this.ws.send(n);"function"==typeof i?i(r,s):r()}))},p.prototype._sendMessage=function(t,e,n,i){return new Promise(((r,s)=>{if(!this._isConnected())return s("Not connected to server.");if(l.isJustinfan(this.getUsername()))return s("Cannot send anonymous messages.");const o=l.channel(e);if(this.userstate[o]||(this.userstate[o]={}),n.length>=500){const i=l.splitLine(n,500);n=i[0],setTimeout((()=>{this._sendMessage(t,e,i[1],(()=>{}))}),350)}this.ws.send(`PRIVMSG ${o} :${n}`);const a={};Object.keys(this.emotesets).forEach((t=>this.emotesets[t].forEach((t=>(l.isRegex(t.code)?h.emoteRegex:h.emoteString)(n,t.code,t.id,a)))));const u=Object.assign(this.userstate[o],h.emotes({emotes:h.transformEmotes(a)||null})),c=l.get(this.opts.options.messagesLogLevel,"info"),p=l.actionMessage(n);p?(u["message-type"]="action",this.log[c](`[${o}] *<${this.getUsername()}>: ${p[1]}`),this.emits(["action","message"],[[o,u,p[1],!0]])):(u["message-type"]="chat",this.log[c](`[${o}] <${this.getUsername()}>: ${n}`),this.emits(["chat","message"],[[o,u,n,!0]])),"function"==typeof i?i(r,s):r()}))},p.prototype._updateEmoteset=function(t){let e=void 0!==t;if(e&&(t===this.emotes?e=!1:this.emotes=t),this._skipUpdatingEmotesets)return void(e&&this.emit("emotesets",t,{}));const n=()=>{this._updateEmotesetsTimerDelay>0&&(clearTimeout(this._updateEmotesetsTimer),this._updateEmotesetsTimer=setTimeout((()=>this._updateEmoteset(t)),this._updateEmotesetsTimerDelay))};this._getToken().then((e=>{const n=`https://api.twitch.tv/kraken/chat/emoticon_images?emotesets=${t}`,r={};return"fetchAgent"in this.opts.connection&&(r.agent=this.opts.connection.fetchAgent),i(n,{...r,headers:{Accept:"application/vnd.twitchtv.v5+json",Authorization:`OAuth ${l.token(e)}`,"Client-ID":this.clientId}})})).then((t=>t.json())).then((e=>{this.emotesets=e.emoticon_sets||{},this.emit("emotesets",t,this.emotesets),n()})).catch((()=>n()))},p.prototype.getUsername=function(){return this.username},p.prototype.getOptions=function(){return this.opts},p.prototype.getChannels=function(){return this.channels},p.prototype.isMod=function(t,e){const n=l.channel(t);return this.moderators[n]||(this.moderators[n]=[]),this.moderators[n].includes(l.username(e))},p.prototype.readyState=function(){return null===this.ws?"CLOSED":["CONNECTING","OPEN","CLOSING","CLOSED"][this.ws.readyState]},p.prototype._isConnected=function(){return null!==this.ws&&1===this.ws.readyState},p.prototype.disconnect=function(){return new Promise(((t,e)=>{null!==this.ws&&3!==this.ws.readyState?(this.wasCloseCalled=!0,this.log.info("Disconnecting from server.."),this.ws.close(),this.once("_promiseDisconnect",(()=>t([this.server,~~this.port])))):(this.log.error("Cannot disconnect from server. Socket is not opened or connection is already closing."),e("Cannot disconnect from server. Socket is not opened or connection is already closing."))}))},p.prototype.off=p.prototype.removeListener,t.exports&&(t.exports=p),"undefined"!=typeof window&&(window.tmi={client:p,Client:p})}(Du);const yl=Du.exports;var Tl={client:yl,Client:yl};class El extends J{constructor(t,e){super(),this.username=t,this.message=e,this.eventType=K.PLAYER_MESSAGE}}const bl="No Twitch Client Set";const xl=t=>`Channel is undefined. Can't send player message: ${t}`,Al=(t,e)=>`Twitch client connecting on ${t}:${e} ...`,Sl="Client not connected.",wl=(t,e)=>`Twitch client connected on ${t}:${e}.`,Rl="Twitch client message",Cl="Twitch client disconnecting ...",Ol="Twitch client disconnected.",Il=t=>`@${t.username} >>> ${t.message}`,Pl=(t,e)=>`${e} joint channel '${t}'.`,Nl=(t,e)=>`${e} leave channel '${t}'.`;var Ml={exports:{}},Dl=function(t,e){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return t.apply(e,n)}},Ll=Dl,Fl=Object.prototype.toString;function Ul(t){return Array.isArray(t)}function Gl(t){return void 0===t}function Bl(t){return"[object ArrayBuffer]"===Fl.call(t)}function kl(t){return null!==t&&"object"==typeof t}function Vl(t){if("[object Object]"!==Fl.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function Xl(t){return"[object Function]"===Fl.call(t)}function jl(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),Ul(t))for(var n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.call(null,t[r],r,t)}var Hl={isArray:Ul,isArrayBuffer:Bl,isBuffer:function(t){return null!==t&&!Gl(t)&&null!==t.constructor&&!Gl(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"[object FormData]"===Fl.call(t)},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&Bl(t.buffer)},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:kl,isPlainObject:Vl,isUndefined:Gl,isDate:function(t){return"[object Date]"===Fl.call(t)},isFile:function(t){return"[object File]"===Fl.call(t)},isBlob:function(t){return"[object Blob]"===Fl.call(t)},isFunction:Xl,isStream:function(t){return kl(t)&&Xl(t.pipe)},isURLSearchParams:function(t){return"[object URLSearchParams]"===Fl.call(t)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:jl,merge:function t(){var e={};function n(n,i){Vl(e[i])&&Vl(n)?e[i]=t(e[i],n):Vl(n)?e[i]=t({},n):Ul(n)?e[i]=n.slice():e[i]=n}for(var i=0,r=arguments.length;i<r;i++)jl(arguments[i],n);return e},extend:function(t,e,n){return jl(e,(function(e,i){t[i]=n&&"function"==typeof e?Ll(e,n):e})),t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}},$l=Hl;function Yl(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Wl=function(t,e,n){if(!e)return t;var i;if(n)i=n(e);else if($l.isURLSearchParams(e))i=e.toString();else{var r=[];$l.forEach(e,(function(t,e){null!=t&&($l.isArray(t)?e+="[]":t=[t],$l.forEach(t,(function(t){$l.isDate(t)?t=t.toISOString():$l.isObject(t)&&(t=JSON.stringify(t)),r.push(Yl(e)+"="+Yl(t))})))})),i=r.join("&")}if(i){var s=t.indexOf("#");-1!==s&&(t=t.slice(0,s)),t+=(-1===t.indexOf("?")?"?":"&")+i}return t},zl=Hl;function ql(){this.handlers=[]}ql.prototype.use=function(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},ql.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},ql.prototype.forEach=function(t){zl.forEach(this.handlers,(function(e){null!==e&&t(e)}))};var Zl=ql,Kl=Hl,Jl=function(t,e,n,i,r){return t.config=e,n&&(t.code=n),t.request=i,t.response=r,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t},Ql=Jl,tc=function(t,e,n,i,r){var s=new Error(t);return Ql(s,e,n,i,r)},ec=tc,nc=Hl,ic=nc.isStandardBrowserEnv()?{write:function(t,e,n,i,r,s){var o=[];o.push(t+"="+encodeURIComponent(e)),nc.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),nc.isString(i)&&o.push("path="+i),nc.isString(r)&&o.push("domain="+r),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},rc=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)},sc=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t},oc=Hl,ac=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],hc=Hl,uc=hc.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(t){var i=t;return e&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=i(window.location.href),function(e){var n=hc.isString(e)?i(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0};function lc(t){this.message=t}lc.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},lc.prototype.__CANCEL__=!0;var cc=lc,pc=Hl,dc=function(t,e,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(ec("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)},fc=ic,mc=Wl,_c=function(t,e){return t&&!rc(e)?sc(t,e):e},gc=function(t){var e,n,i,r={};return t?(oc.forEach(t.split("\n"),(function(t){if(i=t.indexOf(":"),e=oc.trim(t.substr(0,i)).toLowerCase(),n=oc.trim(t.substr(i+1)),e){if(r[e]&&ac.indexOf(e)>=0)return;r[e]="set-cookie"===e?(r[e]?r[e]:[]).concat([n]):r[e]?r[e]+", "+n:n}})),r):r},vc=uc,yc=tc,Tc=Ic,Ec=cc,bc=function(t){return new Promise((function(e,n){var i,r=t.data,s=t.headers,o=t.responseType;function a(){t.cancelToken&&t.cancelToken.unsubscribe(i),t.signal&&t.signal.removeEventListener("abort",i)}pc.isFormData(r)&&delete s["Content-Type"];var h=new XMLHttpRequest;if(t.auth){var u=t.auth.username||"",l=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";s.Authorization="Basic "+btoa(u+":"+l)}var c=_c(t.baseURL,t.url);function p(){if(h){var i="getAllResponseHeaders"in h?gc(h.getAllResponseHeaders()):null,r={data:o&&"text"!==o&&"json"!==o?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:i,config:t,request:h};dc((function(t){e(t),a()}),(function(t){n(t),a()}),r),h=null}}if(h.open(t.method.toUpperCase(),mc(c,t.params,t.paramsSerializer),!0),h.timeout=t.timeout,"onloadend"in h?h.onloadend=p:h.onreadystatechange=function(){h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))&&setTimeout(p)},h.onabort=function(){h&&(n(yc("Request aborted",t,"ECONNABORTED",h)),h=null)},h.onerror=function(){n(yc("Network Error",t,null,h)),h=null},h.ontimeout=function(){var e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",i=t.transitional||Tc.transitional;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(yc(e,t,i.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",h)),h=null},pc.isStandardBrowserEnv()){var d=(t.withCredentials||vc(c))&&t.xsrfCookieName?fc.read(t.xsrfCookieName):void 0;d&&(s[t.xsrfHeaderName]=d)}"setRequestHeader"in h&&pc.forEach(s,(function(t,e){void 0===r&&"content-type"===e.toLowerCase()?delete s[e]:h.setRequestHeader(e,t)})),pc.isUndefined(t.withCredentials)||(h.withCredentials=!!t.withCredentials),o&&"json"!==o&&(h.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&h.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(i=function(t){h&&(n(!t||t&&t.type?new Ec("canceled"):t),h.abort(),h=null)},t.cancelToken&&t.cancelToken.subscribe(i),t.signal&&(t.signal.aborted?i():t.signal.addEventListener("abort",i))),r||(r=null),h.send(r)}))},xc=Hl,Ac=function(t,e){Kl.forEach(t,(function(n,i){i!==e&&i.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[i])}))},Sc=Jl,wc={"Content-Type":"application/x-www-form-urlencoded"};function Rc(t,e){!xc.isUndefined(t)&&xc.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var Cc,Oc={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(Cc=bc),Cc),transformRequest:[function(t,e){return Ac(e,"Accept"),Ac(e,"Content-Type"),xc.isFormData(t)||xc.isArrayBuffer(t)||xc.isBuffer(t)||xc.isStream(t)||xc.isFile(t)||xc.isBlob(t)?t:xc.isArrayBufferView(t)?t.buffer:xc.isURLSearchParams(t)?(Rc(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):xc.isObject(t)||e&&"application/json"===e["Content-Type"]?(Rc(e,"application/json"),function(t,e,n){if(xc.isString(t))try{return(e||JSON.parse)(t),xc.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(n||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){var e=this.transitional||Oc.transitional,n=e&&e.silentJSONParsing,i=e&&e.forcedJSONParsing,r=!n&&"json"===this.responseType;if(r||i&&xc.isString(t)&&t.length)try{return JSON.parse(t)}catch(t){if(r){if("SyntaxError"===t.name)throw Sc(t,this,"E_JSON_PARSE");throw t}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};xc.forEach(["delete","get","head"],(function(t){Oc.headers[t]={}})),xc.forEach(["post","put","patch"],(function(t){Oc.headers[t]=xc.merge(wc)}));var Ic=Oc,Pc=Hl,Nc=Ic,Mc=function(t){return!(!t||!t.__CANCEL__)},Dc=Hl,Lc=function(t,e,n){var i=this||Nc;return Pc.forEach(n,(function(n){t=n.call(i,t,e)})),t},Fc=Mc,Uc=Ic,Gc=cc;function Bc(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Gc("canceled")}var kc=Hl,Vc=function(t,e){e=e||{};var n={};function i(t,e){return kc.isPlainObject(t)&&kc.isPlainObject(e)?kc.merge(t,e):kc.isPlainObject(e)?kc.merge({},e):kc.isArray(e)?e.slice():e}function r(n){return kc.isUndefined(e[n])?kc.isUndefined(t[n])?void 0:i(void 0,t[n]):i(t[n],e[n])}function s(t){if(!kc.isUndefined(e[t]))return i(void 0,e[t])}function o(n){return kc.isUndefined(e[n])?kc.isUndefined(t[n])?void 0:i(void 0,t[n]):i(void 0,e[n])}function a(n){return n in e?i(t[n],e[n]):n in t?i(void 0,t[n]):void 0}var h={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a};return kc.forEach(Object.keys(t).concat(Object.keys(e)),(function(t){var e=h[t]||r,i=e(t);kc.isUndefined(i)&&e!==a||(n[t]=i)})),n},Xc="0.25.0",jc=Xc,Hc={};["object","boolean","number","function","string","symbol"].forEach((function(t,e){Hc[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}}));var $c={};Hc.transitional=function(t,e,n){function i(t,e){return"[Axios v"+jc+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return function(n,r,s){if(!1===t)throw new Error(i(r," has been removed"+(e?" in "+e:"")));return e&&!$c[r]&&($c[r]=!0,console.warn(i(r," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,r,s)}};var Yc={assertOptions:function(t,e,n){if("object"!=typeof t)throw new TypeError("options must be an object");for(var i=Object.keys(t),r=i.length;r-- >0;){var s=i[r],o=e[s];if(o){var a=t[s],h=void 0===a||o(a,s,t);if(!0!==h)throw new TypeError("option "+s+" must be "+h)}else if(!0!==n)throw Error("Unknown option "+s)}},validators:Hc},Wc=Hl,zc=Wl,qc=Zl,Zc=function(t){return Bc(t),t.headers=t.headers||{},t.data=Lc.call(t,t.data,t.headers,t.transformRequest),t.headers=Dc.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),Dc.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||Uc.adapter)(t).then((function(e){return Bc(t),e.data=Lc.call(t,e.data,e.headers,t.transformResponse),e}),(function(e){return Fc(e)||(Bc(t),e&&e.response&&(e.response.data=Lc.call(t,e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))},Kc=Vc,Jc=Yc,Qc=Jc.validators;function tp(t){this.defaults=t,this.interceptors={request:new qc,response:new qc}}tp.prototype.request=function(t,e){if("string"==typeof t?(e=e||{}).url=t:e=t||{},!e.url)throw new Error("Provided config url is not valid");(e=Kc(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var n=e.transitional;void 0!==n&&Jc.assertOptions(n,{silentJSONParsing:Qc.transitional(Qc.boolean),forcedJSONParsing:Qc.transitional(Qc.boolean),clarifyTimeoutError:Qc.transitional(Qc.boolean)},!1);var i=[],r=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,i.unshift(t.fulfilled,t.rejected))}));var s,o=[];if(this.interceptors.response.forEach((function(t){o.push(t.fulfilled,t.rejected)})),!r){var a=[Zc,void 0];for(Array.prototype.unshift.apply(a,i),a=a.concat(o),s=Promise.resolve(e);a.length;)s=s.then(a.shift(),a.shift());return s}for(var h=e;i.length;){var u=i.shift(),l=i.shift();try{h=u(h)}catch(t){l(t);break}}try{s=Zc(h)}catch(t){return Promise.reject(t)}for(;o.length;)s=s.then(o.shift(),o.shift());return s},tp.prototype.getUri=function(t){if(!t.url)throw new Error("Provided config url is not valid");return t=Kc(this.defaults,t),zc(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},Wc.forEach(["delete","get","head","options"],(function(t){tp.prototype[t]=function(e,n){return this.request(Kc(n||{},{method:t,url:e,data:(n||{}).data}))}})),Wc.forEach(["post","put","patch"],(function(t){tp.prototype[t]=function(e,n,i){return this.request(Kc(i||{},{method:t,url:e,data:n}))}}));var ep=tp,np=cc;function ip(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;this.promise.then((function(t){if(n._listeners){var e,i=n._listeners.length;for(e=0;e<i;e++)n._listeners[e](t);n._listeners=null}})),this.promise.then=function(t){var e,i=new Promise((function(t){n.subscribe(t),e=t})).then(t);return i.cancel=function(){n.unsubscribe(e)},i},t((function(t){n.reason||(n.reason=new np(t),e(n.reason))}))}ip.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},ip.prototype.subscribe=function(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]},ip.prototype.unsubscribe=function(t){if(this._listeners){var e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}},ip.source=function(){var t;return{token:new ip((function(e){t=e})),cancel:t}};var rp=ip,sp=Hl,op=Hl,ap=Dl,hp=ep,up=Vc;var lp=function t(e){var n=new hp(e),i=ap(hp.prototype.request,n);return op.extend(i,hp.prototype,n),op.extend(i,n),i.create=function(n){return t(up(e,n))},i}(Ic);lp.Axios=hp,lp.Cancel=cc,lp.CancelToken=rp,lp.isCancel=Mc,lp.VERSION=Xc,lp.all=function(t){return Promise.all(t)},lp.spread=function(t){return function(e){return t.apply(null,e)}},lp.isAxiosError=function(t){return sp.isObject(t)&&!0===t.isAxiosError},Ml.exports=lp,Ml.exports.default=lp;var cp,pp,dp=Ml.exports;!function(t){t.GLOBAL_CLEAVAGE_DRAWPILE_DRAW="/globalCleavageDrawPile/draw",t.GLOBAL_CLEAVAGE_DRAWPILE_SAVE="/globalCleavageDrawPile/save"}(cp||(cp={}));!function(t){t.TWITCHTOKEN="TWITCHTOKEN",t.TWITCHUSERNAME="TWITCHUSERNAME",t.TWITCHCHANNEL="TWITCHCHANNEL",t.GCP_PROJECT_ID="GCP_PROJECT_ID",t.GCP_CLIENT_EMAIL="GCP_CLIENT_EMAIL",t.GCP_PRIVATE_KEY="GCP_PRIVATE_KEY",t.BACKEND_PORT="PORT",t.BACKEND_FQDN="BACKEND_FQDN",t.BACKEND_SHEME="BACKEND_SHEME"}(pp||(pp={}));var fp,mp=new Uint8Array(16);function _p(){if(!fp&&!(fp="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return fp(mp)}var gp=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function vp(t){return"string"==typeof t&&gp.test(t)}for(var yp=[],Tp=0;Tp<256;++Tp)yp.push((Tp+256).toString(16).substr(1));function Ep(t,e,n){var i=(t=t||{}).random||(t.rng||_p)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(var r=0;r<16;++r)e[n+r]=i[r];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(yp[t[e+0]]+yp[t[e+1]]+yp[t[e+2]]+yp[t[e+3]]+"-"+yp[t[e+4]]+yp[t[e+5]]+"-"+yp[t[e+6]]+yp[t[e+7]]+"-"+yp[t[e+8]]+yp[t[e+9]]+"-"+yp[t[e+10]]+yp[t[e+11]]+yp[t[e+12]]+yp[t[e+13]]+yp[t[e+14]]+yp[t[e+15]]).toLowerCase();if(!vp(n))throw TypeError("Stringified UUID is invalid");return n}(i)}var bp=setTimeout;function xp(t){return Boolean(t&&void 0!==t.length)}function Ap(){}function Sp(t){if(!(this instanceof Sp))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Pp(t,this)}function wp(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,Sp._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var i;try{i=n(t._value)}catch(t){return void Cp(e.promise,t)}Rp(e.promise,i)}else(1===t._state?Rp:Cp)(e.promise,t._value)}))):t._deferreds.push(e)}function Rp(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof Sp)return t._state=3,t._value=e,void Op(t);if("function"==typeof n)return void Pp((i=n,r=e,function(){i.apply(r,arguments)}),t)}t._state=1,t._value=e,Op(t)}catch(e){Cp(t,e)}var i,r}function Cp(t,e){t._state=2,t._value=e,Op(t)}function Op(t){2===t._state&&0===t._deferreds.length&&Sp._immediateFn((function(){t._handled||Sp._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)wp(t,t._deferreds[e]);t._deferreds=null}function Ip(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function Pp(t,e){var n=!1;try{t((function(t){n||(n=!0,Rp(e,t))}),(function(t){n||(n=!0,Cp(e,t))}))}catch(t){if(n)return;n=!0,Cp(e,t)}}Sp.prototype.catch=function(t){return this.then(null,t)},Sp.prototype.then=function(t,e){var n=new this.constructor(Ap);return wp(this,new Ip(t,e,n)),n},Sp.prototype.finally=function(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))},Sp.all=function(t){return new Sp((function(e,n){if(!xp(t))return n(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var r=i.length;function s(t,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var a=o.then;if("function"==typeof a)return void a.call(o,(function(e){s(t,e)}),n)}i[t]=o,0==--r&&e(i)}catch(t){n(t)}}for(var o=0;o<i.length;o++)s(o,i[o])}))},Sp.allSettled=function(t){return new this((function(e,n){if(!t||void 0===t.length)return n(new TypeError(typeof t+" "+t+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var r=i.length;function s(t,n){if(n&&("object"==typeof n||"function"==typeof n)){var o=n.then;if("function"==typeof o)return void o.call(n,(function(e){s(t,e)}),(function(n){i[t]={status:"rejected",reason:n},0==--r&&e(i)}))}i[t]={status:"fulfilled",value:n},0==--r&&e(i)}for(var o=0;o<i.length;o++)s(o,i[o])}))},Sp.resolve=function(t){return t&&"object"==typeof t&&t.constructor===Sp?t:new Sp((function(e){e(t)}))},Sp.reject=function(t){return new Sp((function(e,n){n(t)}))},Sp.race=function(t){return new Sp((function(e,n){if(!xp(t))return n(new TypeError("Promise.race accepts an array"));for(var i=0,r=t.length;i<r;i++)Sp.resolve(t[i]).then(e,n)}))},Sp._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){bp(t,0)},Sp._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};
/*
    object-assign
    (c) Sindre Sorhus
    @license MIT
    */
var Np=Object.getOwnPropertySymbols,Mp=Object.prototype.hasOwnProperty,Dp=Object.prototype.propertyIsEnumerable;function Lp(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var Fp=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,i,r=Lp(t),s=1;s<arguments.length;s++){for(var o in n=Object(arguments[s]))Mp.call(n,o)&&(r[o]=n[o]);if(Np){i=Np(n);for(var a=0;a<i.length;a++)Dp.call(n,i[a])&&(r[i[a]]=n[i[a]])}}return r};
/*!
     * @pixi/polyfill - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/polyfill is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */"undefined"==typeof globalThis&&("undefined"!=typeof self?self.globalThis=self:"undefined"!=typeof global&&(global.globalThis=global)),globalThis.Promise||(globalThis.Promise=Sp),Object.assign||(Object.assign=Fp);if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!globalThis.performance||!globalThis.performance.now){var Up=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-Up}}for(var Gp=Date.now(),Bp=["ms","moz","webkit","o"],kp=0;kp<Bp.length&&!globalThis.requestAnimationFrame;++kp){var Vp=Bp[kp];globalThis.requestAnimationFrame=globalThis[Vp+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[Vp+"CancelAnimationFrame"]||globalThis[Vp+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+Gp-e;return n<0&&(n=0),Gp=e,globalThis.self.setTimeout((function(){Gp=Date.now(),t(performance.now())}),n)}),globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array),globalThis.Float32Array||(globalThis.Float32Array=Array),globalThis.Uint32Array||(globalThis.Uint32Array=Array),globalThis.Uint16Array||(globalThis.Uint16Array=Array),globalThis.Uint8Array||(globalThis.Uint8Array=Array),globalThis.Int32Array||(globalThis.Int32Array=Array);var Xp=/iPhone/i,jp=/iPod/i,Hp=/iPad/i,$p=/\biOS-universal(?:.+)Mac\b/i,Yp=/\bAndroid(?:.+)Mobile\b/i,Wp=/Android/i,zp=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,qp=/Silk/i,Zp=/Windows Phone/i,Kp=/\bWindows(?:.+)ARM\b/i,Jp=/BlackBerry/i,Qp=/BB10/i,td=/Opera Mini/i,ed=/\b(CriOS|Chrome)(?:.+)Mobile/i,nd=/Mobile(?:.+)Firefox\b/i,id=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
     * @pixi/settings - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/settings is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
var rd,sd,od,ad,hd,ud,ld,cd,pd,dd,fd,md,_d,gd,vd,yd,Td,Ed,bd,xd=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,i=n.split("[FBAN");void 0!==i[1]&&(n=i[0]),void 0!==(i=n.split("Twitter"))[1]&&(n=i[0]);var r=function(t){return function(e){return e.test(t)}}(n),s={apple:{phone:r(Xp)&&!r(Zp),ipod:r(jp),tablet:!r(Xp)&&(r(Hp)||id(e))&&!r(Zp),universal:r($p),device:(r(Xp)||r(jp)||r(Hp)||r($p)||id(e))&&!r(Zp)},amazon:{phone:r(zp),tablet:!r(zp)&&r(qp),device:r(zp)||r(qp)},android:{phone:!r(Zp)&&r(zp)||!r(Zp)&&r(Yp),tablet:!r(Zp)&&!r(zp)&&!r(Yp)&&(r(qp)||r(Wp)),device:!r(Zp)&&(r(zp)||r(qp)||r(Yp)||r(Wp))||r(/\bokhttp\b/i)},windows:{phone:r(Zp),tablet:r(Kp),device:r(Zp)||r(Kp)},other:{blackberry:r(Jp),blackberry10:r(Qp),opera:r(td),firefox:r(nd),chrome:r(ed),device:r(Jp)||r(Qp)||r(td)||r(nd)||r(ed)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}(globalThis.navigator);!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(rd||(rd={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(sd||(sd={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(od||(od={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(ad||(ad={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(hd||(hd={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(ud||(ud={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(ld||(ld={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(cd||(cd={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(pd||(pd={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(dd||(dd={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(fd||(fd={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(md||(md={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(_d||(_d={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(gd||(gd={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(vd||(vd={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(yd||(yd={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Td||(Td={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(Ed||(Ed={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(bd||(bd={}));var Ad={MIPMAP_TEXTURES:md.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:Ed.NONE,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(xd.tablet||xd.phone){var n;if(xd.apple.device)if(n=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(n[1],10)<11&&(e=!1);if(xd.android.device)if(n=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(n[1],10)<7&&(e=!1)}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:vd.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:fd.CLAMP,SCALE_MODE:dd.LINEAR,PRECISION_VERTEX:yd.HIGH,PRECISION_FRAGMENT:xd.apple.device?yd.HIGH:yd.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!xd.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},Sd={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,i,s,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new r(i,s||t,o),h=n?n+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],a]:t._events[h].push(a):(t._events[h]=a,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},a.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,o=new Array(s);r<s;r++)o[r]=i[r].fn;return o},a.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},a.prototype.emit=function(t,e,i,r,s,o){var a=n?n+t:t;if(!this._events[a])return!1;var h,u,l=this._events[a],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,i),!0;case 4:return l.fn.call(l.context,e,i,r),!0;case 5:return l.fn.call(l.context,e,i,r,s),!0;case 6:return l.fn.call(l.context,e,i,r,s,o),!0}for(u=1,h=new Array(c-1);u<c;u++)h[u-1]=arguments[u];l.fn.apply(l.context,h)}else{var p,d=l.length;for(u=0;u<d;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,i);break;case 4:l[u].fn.call(l[u].context,e,i,r);break;default:if(!h)for(p=1,h=new Array(c-1);p<c;p++)h[p-1]=arguments[p];l[u].fn.apply(l[u].context,h)}}return!0},a.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,i,r){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||r&&!a.once||i&&a.context!==i||o(this,s);else{for(var h=0,u=[],l=a.length;h<l;h++)(a[h].fn!==e||r&&!a[h].once||i&&a[h].context!==i)&&u.push(a[h]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}(Sd);var wd=Sd.exports,Rd={exports:{}};function Cd(t,e,n){n=n||2;var i,r,s,o,a,h,u,l=e&&e.length,c=l?e[0]*n:t.length,p=Od(t,0,c,n,!0),d=[];if(!p||p.next===p.prev)return d;if(l&&(p=function(t,e,n,i){var r,s,o,a=[];for(r=0,s=e.length;r<s;r++)(o=Od(t,e[r]*i,r<s-1?e[r+1]*i:t.length,i,!1))===o.next&&(o.steiner=!0),a.push(kd(o));for(a.sort(Fd),r=0;r<a.length;r++)n=Id(n=Ud(a[r],n),n.next);return n}(t,e,p,n)),t.length>80*n){i=s=t[0],r=o=t[1];for(var f=n;f<c;f+=n)(a=t[f])<i&&(i=a),(h=t[f+1])<r&&(r=h),a>s&&(s=a),h>o&&(o=h);u=0!==(u=Math.max(s-i,o-r))?1/u:0}return Pd(p,d,n,i,r,u),d}function Od(t,e,n,i,r){var s,o;if(r===Qd(t,e,n,i)>0)for(s=e;s<n;s+=i)o=Zd(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=Zd(s,t[s],t[s+1],o);return o&&Hd(o,o.next)&&(Kd(o),o=o.next),o}function Id(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!Hd(i,i.next)&&0!==jd(i.prev,i,i.next))i=i.next;else{if(Kd(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function Pd(t,e,n,i,r,s,o){if(t){!o&&s&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=Bd(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,s,o,a,h,u=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(h=u;a>0||h>0&&i;)0!==a&&(0===h||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,h--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,u*=2}while(o>1)}(r)}(t,i,r,s);for(var a,h,u=t;t.prev!==t.next;)if(a=t.prev,h=t.next,s?Md(t,i,r,s):Nd(t))e.push(a.i/n),e.push(t.i/n),e.push(h.i/n),Kd(t),t=h.next,u=h.next;else if((t=h)===u){o?1===o?Pd(t=Dd(Id(t),e,n),e,n,i,r,s,2):2===o&&Ld(t,e,n,i,r,s):Pd(Id(t),e,n,i,r,s,1);break}}}function Nd(t){var e=t.prev,n=t,i=t.next;if(jd(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(Vd(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&jd(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Md(t,e,n,i){var r=t.prev,s=t,o=t.next;if(jd(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,h=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,u=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,l=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,c=Bd(a,h,e,n,i),p=Bd(u,l,e,n,i),d=t.prevZ,f=t.nextZ;d&&d.z>=c&&f&&f.z<=p;){if(d!==t.prev&&d!==t.next&&Vd(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&jd(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,f!==t.prev&&f!==t.next&&Vd(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&jd(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;d&&d.z>=c;){if(d!==t.prev&&d!==t.next&&Vd(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&jd(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&Vd(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&jd(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function Dd(t,e,n){var i=t;do{var r=i.prev,s=i.next.next;!Hd(r,s)&&$d(r,i,i.next,s)&&zd(r,s)&&zd(s,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(s.i/n),Kd(i),Kd(i.next),i=t=s),i=i.next}while(i!==t);return Id(i)}function Ld(t,e,n,i,r,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&Xd(o,a)){var h=qd(o,a);return o=Id(o,o.next),h=Id(h,h.next),Pd(o,e,n,i,r,s),void Pd(h,e,n,i,r,s)}a=a.next}o=o.next}while(o!==t)}function Fd(t,e){return t.x-e.x}function Ud(t,e){var n=function(t,e){var n,i=e,r=t.x,s=t.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>o){if(o=a,a===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n;var h,u=n,l=n.x,c=n.y,p=1/0;i=n;do{r>=i.x&&i.x>=l&&r!==i.x&&Vd(s<c?r:o,s,l,c,s<c?o:r,s,i.x,i.y)&&(h=Math.abs(s-i.y)/(r-i.x),zd(i,t)&&(h<p||h===p&&(i.x>n.x||i.x===n.x&&Gd(n,i)))&&(n=i,p=h)),i=i.next}while(i!==u);return n}(t,e);if(!n)return e;var i=qd(n,t),r=Id(n,n.next);return Id(i,i.next),e===n?r:e}function Gd(t,e){return jd(t.prev,t,e.prev)<0&&jd(e.next,t,t.next)<0}function Bd(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function kd(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Vd(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function Xd(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&$d(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(zd(t,e)&&zd(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(jd(t.prev,t,e.prev)||jd(t,e.prev,e))||Hd(t,e)&&jd(t.prev,t,t.next)>0&&jd(e.prev,e,e.next)>0)}function jd(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Hd(t,e){return t.x===e.x&&t.y===e.y}function $d(t,e,n,i){var r=Wd(jd(t,e,n)),s=Wd(jd(t,e,i)),o=Wd(jd(n,i,t)),a=Wd(jd(n,i,e));return r!==s&&o!==a||(!(0!==r||!Yd(t,n,e))||(!(0!==s||!Yd(t,i,e))||(!(0!==o||!Yd(n,t,i))||!(0!==a||!Yd(n,e,i)))))}function Yd(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Wd(t){return t>0?1:t<0?-1:0}function zd(t,e){return jd(t.prev,t,t.next)<0?jd(t,e,t.next)>=0&&jd(t,t.prev,e)>=0:jd(t,e,t.prev)<0||jd(t,t.next,e)<0}function qd(t,e){var n=new Jd(t.i,t.x,t.y),i=new Jd(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Zd(t,e,n,i){var r=new Jd(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Kd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Jd(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qd(t,e,n,i){for(var r=0,s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}Rd.exports=Cd,Rd.exports.default=Cd,Cd.deviation=function(t,e,n,i){var r=e&&e.length,s=r?e[0]*n:t.length,o=Math.abs(Qd(t,0,s,n));if(r)for(var a=0,h=e.length;a<h;a++){var u=e[a]*n,l=a<h-1?e[a+1]*n:t.length;o-=Math.abs(Qd(t,u,l,n))}var c=0;for(a=0;a<i.length;a+=3){var p=i[a]*n,d=i[a+1]*n,f=i[a+2]*n;c+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},Cd.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[r][s][o]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};var tf=Rd.exports,ef={exports:{}};
/*! https://mths.be/punycode v1.3.2 by @mathias */
!function(t,e){!function(n){var i=e&&!e.nodeType&&e,r=t&&!t.nodeType&&t,s="object"==typeof se&&se;s.global!==s&&s.window!==s&&s.self!==s||(n=s);var o,a,h=2147483647,u=36,l=/^xn--/,c=/[^\x20-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,m=String.fromCharCode;function _(t){throw RangeError(d[t])}function g(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}function v(t,e){var n=t.split("@"),i="";return n.length>1&&(i=n[0]+"@",t=n[1]),i+g((t=t.replace(p,".")).split("."),e).join(".")}function y(t){for(var e,n,i=[],r=0,s=t.length;r<s;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<s?56320==(64512&(n=t.charCodeAt(r++)))?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--):i.push(e);return i}function T(t){return g(t,(function(t){var e="";return t>65535&&(e+=m((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=m(t)})).join("")}function E(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function b(t,e,n){var i=0;for(t=n?f(t/700):t>>1,t+=f(t/e);t>455;i+=u)t=f(t/35);return f(i+36*t/(t+38))}function x(t){var e,n,i,r,s,o,a,l,c,p,d,m=[],g=t.length,v=0,y=128,E=72;for((n=t.lastIndexOf("-"))<0&&(n=0),i=0;i<n;++i)t.charCodeAt(i)>=128&&_("not-basic"),m.push(t.charCodeAt(i));for(r=n>0?n+1:0;r<g;){for(s=v,o=1,a=u;r>=g&&_("invalid-input"),((l=(d=t.charCodeAt(r++))-48<10?d-22:d-65<26?d-65:d-97<26?d-97:u)>=u||l>f((h-v)/o))&&_("overflow"),v+=l*o,!(l<(c=a<=E?1:a>=E+26?26:a-E));a+=u)o>f(h/(p=u-c))&&_("overflow"),o*=p;E=b(v-s,e=m.length+1,0==s),f(v/e)>h-y&&_("overflow"),y+=f(v/e),v%=e,m.splice(v++,0,y)}return T(m)}function A(t){var e,n,i,r,s,o,a,l,c,p,d,g,v,T,x,A=[];for(g=(t=y(t)).length,e=128,n=0,s=72,o=0;o<g;++o)(d=t[o])<128&&A.push(m(d));for(i=r=A.length,r&&A.push("-");i<g;){for(a=h,o=0;o<g;++o)(d=t[o])>=e&&d<a&&(a=d);for(a-e>f((h-n)/(v=i+1))&&_("overflow"),n+=(a-e)*v,e=a,o=0;o<g;++o)if((d=t[o])<e&&++n>h&&_("overflow"),d==e){for(l=n,c=u;!(l<(p=c<=s?1:c>=s+26?26:c-s));c+=u)x=l-p,T=u-p,A.push(m(E(p+x%T,0))),l=f(x/T);A.push(m(E(l,0))),s=b(n,v,i==r),n=0,++i}++n,++e}return A.join("")}if(o={version:"1.3.2",ucs2:{decode:y,encode:T},decode:x,encode:A,toASCII:function(t){return v(t,(function(t){return c.test(t)?"xn--"+A(t):t}))},toUnicode:function(t){return v(t,(function(t){return l.test(t)?x(t.slice(4).toLowerCase()):t}))}},i&&r)if(t.exports==i)r.exports=o;else for(a in o)o.hasOwnProperty(a)&&(i[a]=o[a]);else n.punycode=o}(se)}(ef,ef.exports);var nf={};function rf(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var sf=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};nf.decode=nf.parse=function(t,e,n,i){e=e||"&",n=n||"=";var r={};if("string"!=typeof t||0===t.length)return r;var s=/\+/g;t=t.split(e);var o=1e3;i&&"number"==typeof i.maxKeys&&(o=i.maxKeys);var a=t.length;o>0&&a>o&&(a=o);for(var h=0;h<a;++h){var u,l,c,p,d=t[h].replace(s,"%20"),f=d.indexOf(n);f>=0?(u=d.substr(0,f),l=d.substr(f+1)):(u=d,l=""),c=decodeURIComponent(u),p=decodeURIComponent(l),rf(r,c)?Array.isArray(r[c])?r[c].push(p):r[c]=[r[c],p]:r[c]=p}return r},nf.encode=nf.stringify=function(t,e,n,i){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(i){var r=encodeURIComponent(sf(i))+n;return Array.isArray(t[i])?t[i].map((function(t){return r+encodeURIComponent(sf(t))})).join(e):r+encodeURIComponent(sf(t[i]))})).join(e):i?encodeURIComponent(sf(i))+n+encodeURIComponent(sf(t)):""};var of=ef.exports,af={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}},hf=Hf,uf=function(t,e){return Hf(t,!1,!0).resolve(e)},lf=function(t){af.isString(t)&&(t=Hf(t));return t instanceof cf?t.format():cf.prototype.format.call(t)};function cf(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var pf,df,ff,mf,_f,gf,vf,yf,Tf,Ef,bf,xf,Af,Sf,wf,Rf,Cf,Of,If,Pf=/^([a-z0-9.+-]+:)/i,Nf=/:[0-9]*$/,Mf=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Df=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Lf=["'"].concat(Df),Ff=["%","/","?",";","#"].concat(Lf),Uf=["/","?","#"],Gf=/^[+a-z0-9A-Z_-]{0,63}$/,Bf=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,kf={javascript:!0,"javascript:":!0},Vf={javascript:!0,"javascript:":!0},Xf={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},jf=nf;function Hf(t,e,n){if(t&&af.isObject(t)&&t instanceof cf)return t;var i=new cf;return i.parse(t,e,n),i}cf.prototype.parse=function(t,e,n){if(!af.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),r=-1!==i&&i<t.indexOf("#")?"?":"#",s=t.split(r);s[0]=s[0].replace(/\\/g,"/");var o=t=s.join(r);if(o=o.trim(),!n&&1===t.split("#").length){var a=Mf.exec(o);if(a)return this.path=o,this.href=o,this.pathname=a[1],a[2]?(this.search=a[2],this.query=e?jf.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var h=Pf.exec(o);if(h){var u=(h=h[0]).toLowerCase();this.protocol=u,o=o.substr(h.length)}if(n||h||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===o.substr(0,2);!l||h&&Vf[h]||(o=o.substr(2),this.slashes=!0)}if(!Vf[h]&&(l||h&&!Xf[h])){for(var c,p,d=-1,f=0;f<Uf.length;f++){-1!==(m=o.indexOf(Uf[f]))&&(-1===d||m<d)&&(d=m)}-1!==(p=-1===d?o.lastIndexOf("@"):o.lastIndexOf("@",d))&&(c=o.slice(0,p),o=o.slice(p+1),this.auth=decodeURIComponent(c)),d=-1;for(f=0;f<Ff.length;f++){var m;-1!==(m=o.indexOf(Ff[f]))&&(-1===d||m<d)&&(d=m)}-1===d&&(d=o.length),this.host=o.slice(0,d),o=o.slice(d),this.parseHost(),this.hostname=this.hostname||"";var _="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!_)for(var g=this.hostname.split(/\./),v=(f=0,g.length);f<v;f++){var y=g[f];if(y&&!y.match(Gf)){for(var T="",E=0,b=y.length;E<b;E++)y.charCodeAt(E)>127?T+="x":T+=y[E];if(!T.match(Gf)){var x=g.slice(0,f),A=g.slice(f+1),S=y.match(Bf);S&&(x.push(S[1]),A.unshift(S[2])),A.length&&(o="/"+A.join(".")+o),this.hostname=x.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),_||(this.hostname=of.toASCII(this.hostname));var w=this.port?":"+this.port:"",R=this.hostname||"";this.host=R+w,this.href+=this.host,_&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!kf[u])for(f=0,v=Lf.length;f<v;f++){var C=Lf[f];if(-1!==o.indexOf(C)){var O=encodeURIComponent(C);O===C&&(O=escape(C)),o=o.split(C).join(O)}}var I=o.indexOf("#");-1!==I&&(this.hash=o.substr(I),o=o.slice(0,I));var P=o.indexOf("?");if(-1!==P?(this.search=o.substr(P),this.query=o.substr(P+1),e&&(this.query=jf.parse(this.query)),o=o.slice(0,P)):e&&(this.search="",this.query={}),o&&(this.pathname=o),Xf[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){w=this.pathname||"";var N=this.search||"";this.path=w+N}return this.href=this.format(),this},cf.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",i=this.hash||"",r=!1,s="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&af.isObject(this.query)&&Object.keys(this.query).length&&(s=jf.stringify(this.query));var o=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||Xf[e])&&!1!==r?(r="//"+(r||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):r||(r=""),i&&"#"!==i.charAt(0)&&(i="#"+i),o&&"?"!==o.charAt(0)&&(o="?"+o),e+r+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(o=o.replace("#","%23"))+i},cf.prototype.resolve=function(t){return this.resolveObject(Hf(t,!1,!0)).format()},cf.prototype.resolveObject=function(t){if(af.isString(t)){var e=new cf;e.parse(t,!1,!0),t=e}for(var n=new cf,i=Object.keys(this),r=0;r<i.length;r++){var s=i[r];n[s]=this[s]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var h=o[a];"protocol"!==h&&(n[h]=t[h])}return Xf[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!Xf[t.protocol]){for(var u=Object.keys(t),l=0;l<u.length;l++){var c=u[l];n[c]=t[c]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||Vf[t.protocol])n.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var d=n.pathname||"",f=n.search||"";n.path=d+f}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var m=n.pathname&&"/"===n.pathname.charAt(0),_=t.host||t.pathname&&"/"===t.pathname.charAt(0),g=_||m||n.host&&t.pathname,v=g,y=n.pathname&&n.pathname.split("/")||[],T=(p=t.pathname&&t.pathname.split("/")||[],n.protocol&&!Xf[n.protocol]);if(T&&(n.hostname="",n.port=null,n.host&&(""===y[0]?y[0]=n.host:y.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),g=g&&(""===p[0]||""===y[0])),_)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,y=p;else if(p.length)y||(y=[]),y.pop(),y=y.concat(p),n.search=t.search,n.query=t.query;else if(!af.isNullOrUndefined(t.search)){if(T)n.hostname=n.host=y.shift(),(S=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=S.shift(),n.host=n.hostname=S.shift());return n.search=t.search,n.query=t.query,af.isNull(n.pathname)&&af.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!y.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var E=y.slice(-1)[0],b=(n.host||t.host||y.length>1)&&("."===E||".."===E)||""===E,x=0,A=y.length;A>=0;A--)"."===(E=y[A])?y.splice(A,1):".."===E?(y.splice(A,1),x++):x&&(y.splice(A,1),x--);if(!g&&!v)for(;x--;x)y.unshift("..");!g||""===y[0]||y[0]&&"/"===y[0].charAt(0)||y.unshift(""),b&&"/"!==y.join("/").substr(-1)&&y.push("");var S,w=""===y[0]||y[0]&&"/"===y[0].charAt(0);T&&(n.hostname=n.host=w?"":y.length?y.shift():"",(S=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=S.shift(),n.host=n.hostname=S.shift()));return(g=g||n.host&&y.length)&&!w&&y.unshift(""),y.length?n.pathname=y.join("/"):(n.pathname=null,n.path=null),af.isNull(n.pathname)&&af.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},cf.prototype.parseHost=function(){var t=this.host,e=Nf.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)},function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(pf||(pf={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(df||(df={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(ff||(ff={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(mf||(mf={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(_f||(_f={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(gf||(gf={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(vf||(vf={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(yf||(yf={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(Tf||(Tf={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Ef||(Ef={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(bf||(bf={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(xf||(xf={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Af||(Af={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(Sf||(Sf={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(wf||(wf={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Rf||(Rf={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Cf||(Cf={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(Of||(Of={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(If||(If={}));
/*!
     * @pixi/utils - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/utils is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
var $f={parse:hf,format:lf,resolve:uf};Ad.RETINA_PREFIX=/@([0-9\.]+)x/,Ad.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Yf,Wf=!1;var zf={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function qf(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function Zf(t){var e=t.toString(16);return"#"+(e="000000".substring(0,6-e.length)+e)}function Kf(t){return"string"==typeof t&&"#"===(t=zf[t.toLowerCase()]||t)[0]&&(t=t.slice(1)),parseInt(t,16)}var Jf=function(){for(var t=[],e=[],n=0;n<32;n++)t[n]=n,e[n]=n;t[mf.NORMAL_NPM]=mf.NORMAL,t[mf.ADD_NPM]=mf.ADD,t[mf.SCREEN_NPM]=mf.SCREEN,e[mf.NORMAL]=mf.NORMAL_NPM,e[mf.ADD]=mf.ADD_NPM,e[mf.SCREEN]=mf.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();function Qf(t,e){return Jf[e?1:0][t]}function tm(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var n=t>>16&255,i=t>>8&255,r=255&t;return(255*e<<24)+((n=n*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(r=r*e+.5|0)}function em(t,e,n,i){return(n=n||new Float32Array(4))[0]=(t>>16&255)/255,n[1]=(t>>8&255)/255,n[2]=(255&t)/255,(i||void 0===i)&&(n[0]*=e,n[1]*=e,n[2]*=e),n[3]=e,n}function nm(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}function im(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function rm(t){return!(t&t-1||!t)}function sm(t){var e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,e|=n=((t>>>=n)>15?1:0)<<2,(e|=n=((t>>>=n)>3?1:0)<<1)|(t>>>=n)>>1}function om(t,e,n){var i,r=t.length;if(!(e>=r||0===n)){var s=r-(n=e+n>r?r-e:n);for(i=e;i<s;++i)t[i]=t[i+n];t.length=s}}function am(t){return 0===t?0:t<0?-1:1}var hm=0;function um(){return++hm}var lm={};function cm(t,e,n){if(void 0===n&&(n=3),!lm[e]){var i=(new Error).stack;void 0===i?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(i=i.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(i))),lm[e]=!0}}var pm,dm={},fm=Object.create(null),mm=Object.create(null),_m=function(){function t(t,e,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||Ad.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)},enumerable:!1,configurable:!0}),t}();function gm(t,e){if(void 0===e&&(e=globalThis.location),0===t.indexOf("data:"))return"";e=e||globalThis.location,pm||(pm=document.createElement("a")),pm.href=t;var n=$f.parse(pm.href),i=!n.port&&""===e.port||n.port===e.port;return n.hostname===e.hostname&&i&&n.protocol===e.protocol?"":"anonymous"}function vm(t,e){var n=Ad.RETINA_PREFIX.exec(t);return n?parseFloat(n[1]):void 0!==e?e:1}
/*!
     * @pixi/math - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/math is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */var ym,Tm=2*Math.PI,Em=180/Math.PI,bm=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(ym||(ym={}));var xm=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},t}(),Am=[new xm,new xm,new xm,new xm],Sm=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(i),this.type=ym.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.intersects=function(t,e){if(!e){var n=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=n)return!1;var i=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>i}var r=this.left,s=this.right,o=this.top,a=this.bottom;if(s<=r||a<=o)return!1;var h=Am[0].set(t.left,t.top),u=Am[1].set(t.left,t.bottom),l=Am[2].set(t.right,t.top),c=Am[3].set(t.right,t.bottom);if(l.x<=h.x||u.y<=h.y)return!1;var p=Math.sign(e.a*e.d-e.b*e.c);if(0===p)return!1;if(e.apply(h,h),e.apply(u,u),e.apply(l,l),e.apply(c,c),Math.max(h.x,u.x,l.x,c.x)<=r||Math.min(h.x,u.x,l.x,c.x)>=s||Math.max(h.y,u.y,l.y,c.y)<=o||Math.min(h.y,u.y,l.y,c.y)>=a)return!1;var d=p*(u.y-h.y),f=p*(h.x-u.x),m=d*r+f*o,_=d*s+f*o,g=d*r+f*a,v=d*s+f*a;if(Math.max(m,_,g,v)<=d*h.x+f*h.y||Math.min(m,_,g,v)>=d*c.x+f*c.y)return!1;var y=p*(h.y-l.y),T=p*(l.x-h.x),E=y*r+T*o,b=y*s+T*o,x=y*r+T*a,A=y*s+T*a;return!(Math.max(E,b,x,A)<=y*h.x+T*h.y||Math.min(E,b,x,A)>=y*c.x+T*c.y)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=i,this.height=Math.max(r-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var n=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=i,this.height=r-i,this},t.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),wm=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.radius=n,this.type=ym.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,i=this.x-t,r=this.y-e;return(i*=i)+(r*=r)<=n},t.prototype.getBounds=function(){return new Sm(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},t}(),Rm=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=n,this.height=i,this.type=ym.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,i=(e-this.y)/this.height;return(n*=n)+(i*=i)<=1},t.prototype.getBounds=function(){return new Sm(this.x-this.width,this.y-this.height,this.width,this.height)},t.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),Cm=function(){function t(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var i=Array.isArray(e[0])?e[0]:e;if("number"!=typeof i[0]){for(var r=[],s=0,o=i.length;s<o;s++)r.push(i[s].x,i[s].y);i=r}this.points=i,this.type=ym.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var n=!1,i=this.points.length/2,r=0,s=i-1;r<i;s=r++){var o=this.points[2*r],a=this.points[2*r+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(n=!n)}return n},t.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce((function(t,e){return t+", "+e}),"")+"]"},t}(),Om=function(){function t(t,e,n,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=20),this.x=t,this.y=e,this.width=n,this.height=i,this.radius=r,this.type=ym.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){var n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;var i=t-(this.x+n),r=e-(this.y+n),s=n*n;if(i*i+r*r<=s)return!0;if((i=t-(this.x+this.width-n))*i+r*r<=s)return!0;if(i*i+(r=e-(this.y+this.height-n))*r<=s)return!0;if((i=t-(this.x+n))*i+r*r<=s)return!0}return!1},t.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},t}(),Im=function(){function t(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0),this._x=n,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,n){return void 0===e&&(e=this.cb),void 0===n&&(n=this.scope),new t(e,n,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},t.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),Pm=function(){function t(t,e,n,i,r,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=s}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,n,i,r,s){return this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=s,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},t.prototype.apply=function(t,e){e=e||new xm;var n=t.x,i=t.y;return e.x=this.a*n+this.c*i+this.tx,e.y=this.b*n+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new xm;var n=1/(this.a*this.d+this.c*-this.b),i=t.x,r=t.y;return e.x=this.d*n*i+-this.c*n*r+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*r+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.c,s=this.tx;return this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=r*e-this.d*n,this.d=r*n+this.d*e,this.tx=s*e-this.ty*n,this.ty=s*n+this.ty*e,this},t.prototype.append=function(t){var e=this.a,n=this.b,i=this.c,r=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*n+t.b*r,this.c=t.c*e+t.d*i,this.d=t.c*n+t.d*r,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*n+t.ty*r+this.ty,this},t.prototype.setTransform=function(t,e,n,i,r,s,o,a,h){return this.a=Math.cos(o+h)*r,this.b=Math.sin(o+h)*r,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(n*this.a+i*this.c),this.ty=e-(n*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var n=this.a,i=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,n=this.b,i=this.c,r=this.d,s=t.pivot,o=-Math.atan2(-i,r),a=Math.atan2(n,e),h=Math.abs(o+a);return h<1e-5||Math.abs(Tm-h)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=a),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(i*i+r*r),t.position.x=this.tx+(s.x*e+s.y*i),t.position.y=this.ty+(s.x*n+s.y*r),t},t.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,s=t*i-e*n;return this.a=i/s,this.b=-e/s,this.c=-n/s,this.d=t/s,this.tx=(n*this.ty-i*r)/s,this.ty=-(t*this.ty-e*r)/s,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),Nm=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Mm=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Dm=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Lm=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Fm=[],Um=[],Gm=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Fm.push(e);for(var n=0;n<16;n++)for(var i=Gm(Nm[t]*Nm[n]+Dm[t]*Mm[n]),r=Gm(Mm[t]*Nm[n]+Lm[t]*Mm[n]),s=Gm(Nm[t]*Dm[n]+Dm[t]*Lm[n]),o=Gm(Mm[t]*Dm[n]+Lm[t]*Lm[n]),a=0;a<16;a++)if(Nm[a]===i&&Mm[a]===r&&Dm[a]===s&&Lm[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new Pm;h.set(Nm[t],Mm[t],Dm[t],Lm[t],0,0),Um.push(h)}}();var Bm={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Nm[t]},uY:function(t){return Mm[t]},vX:function(t){return Dm[t]},vY:function(t){return Lm[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Fm[t][e]},sub:function(t,e){return Fm[t][Bm.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?Bm.S:Bm.N:2*Math.abs(e)<=Math.abs(t)?t>0?Bm.E:Bm.W:e>0?t>0?Bm.SE:Bm.SW:t>0?Bm.NE:Bm.NW},matrixAppendRotationInv:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var r=Um[Bm.inv(e)];r.tx=n,r.ty=i,t.append(r)}},km=function(){function t(){this.worldTransform=new Pm,this.localTransform=new Pm,this.position=new Im(this.onChange,this,0,0),this.scale=new Im(this.onChange,this,1,1),this.pivot=new Im(this.onChange,this,0,0),this.skew=new Im(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var n=t.worldTransform,i=this.worldTransform;i.a=e.a*n.a+e.b*n.c,i.b=e.a*n.b+e.b*n.d,i.c=e.c*n.a+e.d*n.c,i.d=e.c*n.b+e.d*n.d,i.tx=e.tx*n.a+e.ty*n.c+n.tx,i.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();
/*!
     * @pixi/display - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/display is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
Ad.SORTABLE_CHILDREN=!1;var Vm=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Sm.EMPTY:((t=t||new Sm(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addPointMatrix=function(t,e){var n=t.a,i=t.b,r=t.c,s=t.d,o=t.tx,a=t.ty,h=n*e.x+r*e.y+o,u=i*e.x+s*e.y+a;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)},t.prototype.addQuad=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY,s=t[0],o=t[1];e=s<e?s:e,n=o<n?o:n,i=s>i?s:i,r=o>r?o:r,e=(s=t[2])<e?s:e,n=(o=t[3])<n?o:n,i=s>i?s:i,r=o>r?o:r,e=(s=t[4])<e?s:e,n=(o=t[5])<n?o:n,i=s>i?s:i,r=o>r?o:r,e=(s=t[6])<e?s:e,n=(o=t[7])<n?o:n,i=s>i?s:i,r=o>r?o:r,this.minX=e,this.minY=n,this.maxX=i,this.maxY=r},t.prototype.addFrame=function(t,e,n,i,r){this.addFrameMatrix(t.worldTransform,e,n,i,r)},t.prototype.addFrameMatrix=function(t,e,n,i,r){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,p=this.minY,d=this.maxX,f=this.maxY,m=s*e+a*n+u,_=o*e+h*n+l;c=m<c?m:c,p=_<p?_:p,d=m>d?m:d,f=_>f?_:f,c=(m=s*i+a*n+u)<c?m:c,p=(_=o*i+h*n+l)<p?_:p,d=m>d?m:d,f=_>f?_:f,c=(m=s*e+a*r+u)<c?m:c,p=(_=o*e+h*r+l)<p?_:p,d=m>d?m:d,f=_>f?_:f,c=(m=s*i+a*r+u)<c?m:c,p=(_=o*i+h*r+l)<p?_:p,d=m>d?m:d,f=_>f?_:f,this.minX=c,this.minY=p,this.maxX=d,this.maxY=f},t.prototype.addVertexData=function(t,e,n){for(var i=this.minX,r=this.minY,s=this.maxX,o=this.maxY,a=e;a<n;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,r=u<r?u:r,s=h>s?h:s,o=u>o?u:o}this.minX=i,this.minY=r,this.maxX=s,this.maxY=o},t.prototype.addVertices=function(t,e,n,i){this.addVerticesMatrix(t.worldTransform,e,n,i)},t.prototype.addVerticesMatrix=function(t,e,n,i,r,s){void 0===r&&(r=0),void 0===s&&(s=r);for(var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty,p=this.minX,d=this.minY,f=this.maxX,m=this.maxY,_=n;_<i;_+=2){var g=e[_],v=e[_+1],y=o*g+h*v+l,T=u*v+a*g+c;p=Math.min(p,y-r),f=Math.max(f,y+r),d=Math.min(d,T-s),m=Math.max(m,T+s)}this.minX=p,this.minY=d,this.maxX=f,this.maxY=m},t.prototype.addBounds=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>r?t.maxY:r},t.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=r&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=n<o?n:o,this.minY=i<a?i:a,this.maxX=r>h?r:h,this.maxY=s>u?s:u}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=r&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=n<o?n:o,this.minY=i<a?i:a,this.maxX=r>h?r:h,this.maxY=s>u?s:u}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,n,i,r,s){t-=r,e-=s,n+=r,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i},t}(),Xm=function(t,e){return Xm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Xm(t,e)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function jm(t,e){function n(){this.constructor=t}Xm(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Hm,$m,Ym,Wm,zm,qm,Zm,Km,Jm,Qm,t_,e_,n_,i_,r_,s_,o_,a_,h_,u_=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new km,e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Vm,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return jm(e,t),e.mixin=function(t){for(var n=Object.keys(t),i=0;i<n.length;++i){var r=n[i];Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Sm),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new Sm),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Vm);var e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var i=this._bounds,r=this._boundsID;this._bounds=this._localBounds;var s=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-r,s},e.prototype.toGlobal=function(t,e,n){return void 0===n&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,n,i){return e&&(t=e.toGlobal(t,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,n,i,r,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=1),void 0===i&&(i=1),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=i||1,this.rotation=r,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.emit("destroyed"),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new l_),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*Em},set:function(t){this.transform.rotation=t*bm},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){if(this._mask!==t){var e;if(this._mask)(e=this._mask.maskObject||this._mask)._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1);if(this._mask=t,this._mask)0===(e=this._mask.maskObject||this._mask)._maskRefCount&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++}},enumerable:!1,configurable:!0}),e}(wd),l_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return jm(e,t),e}(u_);function c_(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}u_.prototype.displayObjectUpdateTransform=u_.prototype.updateTransform,function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(Hm||(Hm={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}($m||($m={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(Ym||(Ym={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Wm||(Wm={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(zm||(zm={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(qm||(qm={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Zm||(Zm={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Km||(Km={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(Jm||(Jm={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Qm||(Qm={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(t_||(t_={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(e_||(e_={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(n_||(n_={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(i_||(i_={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(r_||(r_={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(s_||(s_={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(o_||(o_={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(a_||(a_={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(h_||(h_={}));var p_=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=Ad.SORTABLE_CHILDREN,e.sortDirty=!1,e}return jm(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.addChild(e[i]);else{var r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var n=this.getChildIndex(t),i=this.getChildIndex(e);this.children[n]=e,this.children[i]=t,this.onChildrenChange(n<i?n:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);om(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.removeChild(e[i]);else{var r=e[0],s=this.children.indexOf(r);if(-1===s)return null;r.parent=null,r.transform._parentID=-1,om(this.children,s,1),this._boundsID++,this.onChildrenChange(s),r.emit("removed",this),this.emit("childRemoved",r,this,s)}return e[0]},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,om(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var n,i=t,r=e-i;if(r>0&&r<=e){n=this.children.splice(i,r);for(var s=0;s<n.length;++s)n[s].parent=null,n[s].transform&&(n[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(s=0;s<n.length;++s)n[s].emit("removed",this),this.emit("childRemoved",n[s],this,s);return n}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,n=this.children.length;e<n;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(c_),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var n=this.children[t];n.visible&&n.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var n=e._mask.maskObject||e._mask;n.calculateBounds(),this._bounds.addBoundsMask(e._bounds,n._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(e,n){void 0===n&&(n=!1);var i=t.prototype.getLocalBounds.call(this,e);if(!n)for(var r=0,s=this.children.length;r<s;++r){var o=this.children[r];o.visible&&o.updateTransform()}return i},e.prototype._calculateBounds=function(){},e.prototype._renderWithCulling=function(t){var n=t.renderTexture.sourceFrame;if(n.width>0&&n.height>0){var i,r;if(this.cullArea?(i=this.cullArea,r=this.worldTransform):this._render!==e.prototype._render&&(i=this.getBounds(!0)),i&&n.intersects(i,r))this._render(t);else if(this.cullArea)return;for(var s=0,o=this.children.length;s<o;++s){var a=this.children[s],h=a.cullable;a.cullable=h||!this.cullArea,a.render(t),a.cullable=h}}},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){var e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i])}var r=e&&this._enabledFilters&&this._enabledFilters.length||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==o_.NONE));if(r&&t.batch.flush(),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.push(this,this._enabledFilters),n&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);i=0;for(var s=this.children.length;i<s;++i)this.children[i].render(t)}r&&t.batch.flush(),n&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var n="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(n)for(var r=0;r<i.length;++r)i[r].destroy(e)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),e}(u_);p_.prototype.containerUpdateTransform=p_.prototype.updateTransform;u_.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});var d_,f_=function(){function t(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(xd.tablet||xd.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",(function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e},t.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},t.prototype.activate=function(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(t=this.renderer.view.parentNode)||void 0===t||t.appendChild(this.div))},t.prototype.deactivate=function(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(t=this.div.parentNode)||void 0===t||t.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);var e=t.children;if(e)for(var n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}},t.prototype.update=function(){var t=performance.now();if(!(xd.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=e.left,i=e.top,r=e.width,s=e.height,o=this.renderer,a=o.width,h=o.height,u=o.resolution,l=r/a*u,c=s/h*u,p=this.div;p.style.left=n+"px",p.style.top=i+"px",p.style.width=a+"px",p.style.height=h+"px";for(var d=0;d<this.children.length;d++){var f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,om(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{p=f._accessibleDiv;var m=f.hitArea,_=f.worldTransform;f.hitArea?(p.style.left=(_.tx+m.x*_.a)*l+"px",p.style.top=(_.ty+m.y*_.d)*c+"px",p.style.width=m.width*_.a*l+"px",p.style.height=m.height*_.d*c+"px"):(m=f.getBounds(),this.capHitArea(m),p.style.left=m.x*l+"px",p.style.top=m.y*c+"px",p.style.width=m.width*l+"px",p.style.height=m.height*c+"px",p.title!==f.accessibleTitle&&null!==f.accessibleTitle&&(p.title=f.accessibleTitle),p.getAttribute("aria-label")!==f.accessibleHint&&null!==f.accessibleHint&&p.setAttribute("aria-label",f.accessibleHint)),f.accessibleTitle===p.title&&f.tabIndex===p.tabIndex||(p.title=f.accessibleTitle,p.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(p))}}this.renderId++}},t.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,n=e.width,i=e.height;t.x+t.width>n&&(t.width=n-t.x),t.y+t.height>i&&(t.height=i-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction,n=t.target.displayObject,i=e.eventData;e.dispatchEvent(n,"click",i),e.dispatchEvent(n,"pointertap",i),e.dispatchEvent(n,"tap",i)},t.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,n=t.target.displayObject,i=e.eventData;e.dispatchEvent(n,"mouseover",i)},t.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,n=t.target.displayObject,i=e.eventData;e.dispatchEvent(n,"mouseout",i)},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},t.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},t.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t}();
/*!
     * @pixi/ticker - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/ticker is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
Ad.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(d_||(d_={}));var m_=function(){function t(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=0),void 0===i&&(i=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=i}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),__=function(){function t(){var t=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new m_(null,null,1/0),this.deltaMS=1/Ad.TARGET_FPMS,this.elapsedMS=1/Ad.TARGET_FPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,n){return void 0===n&&(n=d_.NORMAL),this._addListener(new m_(t,e,n))},t.prototype.addOnce=function(t,e,n){return void 0===n&&(n=d_.NORMAL),this._addListener(new m_(t,e,n,!0))},t.prototype._addListener=function(t){var e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var n=this._head.next;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Ad.TARGET_FPMS;for(var i=this._head,r=i.next;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,Ad.TARGET_FPMS);this._maxElapsedMS=1/n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),g_=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,d_.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?__.shared:new __,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t}(),v_=function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new xm,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(t.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},t}(),y_=function(t,e){return y_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},y_(t,e)};var T_=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}(),E_=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return 0!=(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return 0!=(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return 0!=(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}(),b_=function(){function t(){this._tempPoint=new xm}return t.prototype.recursiveFindHit=function(t,e,n,i,r){if(!e||!e.visible)return!1;var s=t.data.global,o=!1,a=r=e.interactive||r,h=!0;if(e.hitArea?(i&&(e.worldTransform.applyInverse(s,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?o=!0:(i=!1,h=!1)),a=!1):e._mask&&i&&(e._mask.containsPoint&&e._mask.containsPoint(s)||(i=!1)),h&&e.interactiveChildren&&e.children)for(var u=e.children,l=u.length-1;l>=0;l--){var c=u[l],p=this.recursiveFindHit(t,c,n,i,a);if(p){if(!c.parent)continue;a=!1,p&&(t.target&&(i=!1),o=!0)}}return r&&(i&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(s)&&(o=!0),e.interactive&&(o&&!t.target&&(t.target=e),n&&n(t,e,!!o))),o},t.prototype.findHit=function(t,e,n,i){this.recursiveFindHit(t,e,n,i,!1)},t}(),x_={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};u_.mixin(x_);var A_={target:null,data:{global:null}},S_=function(t){function e(e,n){var i=t.call(this)||this;return n=n||{},i.renderer=e,i.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,i.interactionFrequency=n.interactionFrequency||10,i.mouse=new v_,i.mouse.identifier=1,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[1]=i.mouse,i.interactionDataPool=[],i.eventData=new T_,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!("PointerEvent"in globalThis),i.supportsTouchEvents="ontouchstart"in globalThis,i.supportsPointerEvents=!!globalThis.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new b_,i._tempDisplayObject=new l_,i._eventListenerOptions={capture:!0,passive:!1},i._useSystemTicker=void 0===n.useSystemTicker||n.useSystemTicker,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return function(t,e){function n(){this.constructor=t}y_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,e){return A_.target=null,A_.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(A_,e,null,!0),A_.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(__.system.add(this.tickerUpdate,this,d_.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(__.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){t=t||"default";var e=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(e=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.interactionDOMElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.interactionDOMElement.style,n)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,n){n.stopPropagationHint&&t!==n.stopsPropagatingAt||(n.currentTarget=t,n.type=e,t.emit(e,n),t[e]&&t[e](n))},e.prototype.delayDispatchEvent=function(t,e,n){this.delayedEvents.push({displayObject:t,eventString:e,eventData:n})},e.prototype.mapPositionToPoint=function(t,e,n){var i;i=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var r=1/this.resolution;t.x=(e-i.left)*(this.interactionDOMElement.width/i.width)*r,t.y=(n-i.top)*(this.interactionDOMElement.height/i.height)*r},e.prototype.processInteractive=function(t,e,n,i){var r=this.search.findHit(t,e,n,i),s=this.delayedEvents;if(!s.length)return r;t.stopPropagationHint=!1;var o=s.length;this.delayedEvents=[];for(var a=0;a<o;a++){var h=s[a],u=h.displayObject,l=h.eventString,c=h.eventData;c.stopsPropagatingAt===u&&(c.stopPropagationHint=!0),this.dispatchEvent(u,l,c)}return r},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=e.length,i=0;i<n;i++){var r=e[i],s=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,s);if(o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===r.pointerType)this.emit("touchstart",o);else if("mouse"===r.pointerType||"pen"===r.pointerType){var a=2===r.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,n){var i=t.data,r=t.data.identifier;if(n)if(e.trackedPointers[r]||(e.trackedPointers[r]=new E_(r)),this.dispatchEvent(e,"pointerdown",t),"touch"===i.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===i.pointerType||"pen"===i.pointerType){var s=2===i.button;s?e.trackedPointers[r].rightDown=!0:e.trackedPointers[r].leftDown=!0,this.dispatchEvent(e,s?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,n){for(var i=this.normalizeToPointerData(t),r=i.length,s=t.target!==this.interactionDOMElement?"outside":"",o=0;o<r;o++){var a=i[o],h=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,h);if(u.data.originalEvent=t,this.processInteractive(u,this.lastObjectRendered,n,e||!s),this.emit(e?"pointercancel":"pointerup"+s,u),"mouse"===a.pointerType||"pen"===a.pointerType){var l=2===a.button;this.emit(l?"rightup"+s:"mouseup"+s,u)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+s,u),this.releaseInteractionDataForPointerId(a.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var n=t.data,i=t.data.identifier;void 0!==e.trackedPointers[i]&&(delete e.trackedPointers[i],this.dispatchEvent(e,"pointercancel",t),"touch"===n.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,n){var i=t.data,r=t.data.identifier,s=e.trackedPointers[r],o="touch"===i.pointerType,a="mouse"===i.pointerType||"pen"===i.pointerType,h=!1;if(a){var u=2===i.button,l=E_.FLAGS,c=u?l.RIGHT_DOWN:l.LEFT_DOWN,p=void 0!==s&&s.flags&c;n?(this.dispatchEvent(e,u?"rightup":"mouseup",t),p&&(this.dispatchEvent(e,u?"rightclick":"click",t),h=!0)):p&&this.dispatchEvent(e,u?"rightupoutside":"mouseupoutside",t),s&&(u?s.rightDown=!1:s.leftDown=!1)}n?(this.dispatchEvent(e,"pointerup",t),o&&this.dispatchEvent(e,"touchend",t),s&&(a&&!h||this.dispatchEvent(e,"pointertap",t),o&&(this.dispatchEvent(e,"tap",t),s.over=!1))):s&&(this.dispatchEvent(e,"pointerupoutside",t),o&&this.dispatchEvent(e,"touchendoutside",t)),s&&s.none&&delete e.trackedPointers[r]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var n=e.length,i=0;i<n;i++){var r=e[i],s=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,s);o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",o),"touch"===r.pointerType&&this.emit("touchmove",o),"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.emit("mousemove",o)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,n){var i=t.data,r="touch"===i.pointerType,s="mouse"===i.pointerType||"pen"===i.pointerType;s&&this.processPointerOverOut(t,e,n),this.moveWhenInside&&!n||(this.dispatchEvent(e,"pointermove",t),r&&this.dispatchEvent(e,"touchmove",t),s&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,n);i.data.originalEvent=e,this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",i),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",i):this.releaseInteractionDataForPointerId(n.identifier)}},e.prototype.processPointerOverOut=function(t,e,n){var i=t.data,r=t.data.identifier,s="mouse"===i.pointerType||"pen"===i.pointerType,o=e.trackedPointers[r];n&&!o&&(o=e.trackedPointers[r]=new E_(r)),void 0!==o&&(n&&this.mouseOverRenderer?(o.over||(o.over=!0,this.delayDispatchEvent(e,"pointerover",t),s&&this.delayDispatchEvent(e,"mouseover",t)),s&&null===this.cursor&&(this.cursor=e.cursor)):o.over&&(o.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),s&&this.dispatchEvent(e,"mouseout",t),o.none&&delete e.trackedPointers[r]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],n=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,n);i.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",i),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",i)},e.prototype.getInteractionDataForPointerId=function(t){var e,n=t.pointerId;return 1===n||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[n]?e=this.activeInteractionData[n]:((e=this.interactionDataPool.pop()||new v_).identifier=n,this.activeInteractionData[n]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,n){return t.data=n,this.mapPositionToPoint(n.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=n.global.x,e.globalY=n.global.y),n.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var n=0,i=t.changedTouches.length;n<i;n++){var r=t.changedTouches[n];void 0===r.button&&(r.button=t.touches.length?1:0),void 0===r.buttons&&(r.buttons=t.touches.length?1:0),void 0===r.isPrimary&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===r.width&&(r.width=r.radiusX||1),void 0===r.height&&(r.height=r.radiusY||1),void 0===r.tiltX&&(r.tiltX=0),void 0===r.tiltY&&(r.tiltY=0),void 0===r.pointerType&&(r.pointerType="touch"),void 0===r.pointerId&&(r.pointerId=r.identifier||0),void 0===r.pressure&&(r.pressure=r.force||.5),void 0===r.twist&&(r.twist=0),void 0===r.tangentialPressure&&(r.tangentialPressure=0),void 0===r.layerX&&(r.layerX=r.offsetX=r.clientX),void 0===r.layerY&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,e.push(r)}else if(globalThis.MouseEvent&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof globalThis.PointerEvent))e.push(t);else{var s=t;void 0===s.isPrimary&&(s.isPrimary=!0),void 0===s.width&&(s.width=1),void 0===s.height&&(s.height=1),void 0===s.tiltX&&(s.tiltX=0),void 0===s.tiltY&&(s.tiltY=0),void 0===s.pointerType&&(s.pointerType="mouse"),void 0===s.pointerId&&(s.pointerId=1),void 0===s.pressure&&(s.pressure=.5),void 0===s.twist&&(s.twist=0),void 0===s.tangentialPressure&&(s.tangentialPressure=0),s.isNormalized=!0,e.push(s)}return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e}(wd),w_=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,n,i,r,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,p=l.length;c<p;c++)l[c][u](t,e,n,i,r,s,o,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(w_.prototype,{dispatch:{value:w_.prototype.emit},run:{value:w_.prototype.emit}}),
/*!
     * @pixi/core - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/core is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
Ad.PREFER_ENV=xd.any?pf.WEBGL:pf.WEBGL2,Ad.STRICT_TEXTURE_CACHE=!1;var R_=[];function C_(t,e){if(!t)return null;var n="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(n=i[1].toLowerCase())}for(var r=R_.length-1;r>=0;--r){var s=R_[r];if(s.test&&s.test(t,n))return new s(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var O_=function(t,e){return O_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},O_(t,e)};function I_(t,e){function n(){this.constructor=t}O_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var P_=function(){return P_=Object.assign||function(t){for(var e,n=arguments,i=1,r=arguments.length;i<r;i++)for(var s in e=n[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},P_.apply(this,arguments)};var N_=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new w_("setRealSize"),this.onUpdate=new w_("update"),this.onError=new w_("onError")}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},t.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(t.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit()},t.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,n){return!1},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},t.test=function(t,e){return!1},t}(),M_=function(t){function e(e,n){var i=this,r=n||{},s=r.width,o=r.height;if(!s||!o)throw new Error("BufferResource width or height invalid");return(i=t.call(this,s,o)||this).data=e,i}return I_(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Af.UNPACK);var r=e.realWidth,s=e.realHeight;return n.width===r&&n.height===s?i.texSubImage2D(e.target,0,0,0,r,s,e.format,n.type,this.data):(n.width=r,n.height=s,i.texImage2D(e.target,0,n.internalFormat,r,s,0,e.format,n.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(N_),D_={scaleMode:Ef.NEAREST,format:gf.RGBA,alphaMode:Af.NPM},L_=function(t){function e(e,n){void 0===e&&(e=null),void 0===n&&(n=null);var i=t.call(this)||this,r=(n=n||{}).alphaMode,s=n.mipmap,o=n.anisotropicLevel,a=n.scaleMode,h=n.width,u=n.height,l=n.wrapMode,c=n.format,p=n.type,d=n.target,f=n.resolution,m=n.resourceOptions;return!e||e instanceof N_||((e=C_(e,m)).internal=!0),i.resolution=f||Ad.RESOLUTION,i.width=Math.round((h||0)*i.resolution)/i.resolution,i.height=Math.round((u||0)*i.resolution)/i.resolution,i._mipmap=void 0!==s?s:Ad.MIPMAP_TEXTURES,i.anisotropicLevel=void 0!==o?o:Ad.ANISOTROPIC_LEVEL,i._wrapMode=l||Ad.WRAP_MODE,i._scaleMode=void 0!==a?a:Ad.SCALE_MODE,i.format=c||gf.RGBA,i.type=p||yf.UNSIGNED_BYTE,i.target=d||vf.TEXTURE_2D,i.alphaMode=void 0!==r?r:Af.UNPACK,i.uid=um(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=h>0&&u>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(e),i}return I_(e,t),Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,e){var n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,n){return n=n||this.resolution,this.setRealSize(t*n,e*n,n)},e.prototype.setRealSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=rm(this.realWidth)&&rm(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete mm[this.cacheId],delete fm[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,n,i){void 0===i&&(i=Ad.STRICT_TEXTURE_CACHE);var r="string"==typeof t,s=null;if(r)s=t;else{if(!t._pixiId){var o=n&&n.pixiIdPrefix||"pixiid";t._pixiId=o+"_"+um()}s=t._pixiId}var a=mm[s];if(r&&i&&!a)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return a||((a=new e(t,n)).cacheId=s,e.addToCache(a,s)),a},e.fromBuffer=function(t,n,i,r){t=t||new Float32Array(n*i*4);var s=new M_(t,{width:n,height:i}),o=t instanceof Float32Array?yf.FLOAT:yf.UNSIGNED_BYTE;return new e(s,Object.assign(D_,r||{width:n,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),mm[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),mm[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=mm[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete mm[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete mm[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}(wd),F_=function(t){function e(e,n){var i=this,r=n||{},s=r.width,o=r.height;(i=t.call(this,s,o)||this).items=[],i.itemDirtyIds=[];for(var a=0;a<e;a++){var h=new L_;i.items.push(h),i.itemDirtyIds.push(-2)}return i.length=e,i._load=null,i.baseTexture=null,i}return I_(e,t),e.prototype.initFromArray=function(t,e){for(var n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof N_?this.addResourceAt(t[n],n):this.addResourceAt(C_(t[n],e),n))},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=e,this.items[n].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})).filter((function(t){return t})).map((function(t){return t.load()}));return this._load=Promise.all(e).then((function(){var e=t.items[0],n=e.realWidth,i=e.realHeight;return t.resize(n,i),Promise.resolve(t)})),this._load},e}(N_),U_=function(t){function e(e,n){var i,r,s=this,o=n||{},a=o.width,h=o.height;return Array.isArray(e)?(i=e,r=e.length):r=e,s=t.call(this,r,{width:a,height:h})||this,i&&s.initFromArray(i,n),s}return I_(e,t),e.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=vf.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,e,n){var i=this,r=i.length,s=i.itemDirtyIds,o=i.items,a=t.gl;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,e.format,n.type,null);for(var h=0;h<r;h++){var u=o[h];s[h]<u.dirtyId&&(s[h]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,u.resource.width,u.resource.height,1,e.format,n.type,u.resource.source))}return!0},e}(F_),G_=function(t){function e(e){var n=this,i=e,r=i.naturalWidth||i.videoWidth||i.width,s=i.naturalHeight||i.videoHeight||i.height;return(n=t.call(this,r,s)||this).source=e,n.noSubImage=!1,n}return I_(e,t),e.crossOrigin=function(t,e,n){void 0===n&&0!==e.indexOf("data:")?t.crossOrigin=gm(e):!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous")},e.prototype.upload=function(t,e,n,i){var r=t.gl,s=e.realWidth,o=e.realHeight;if((i=i||this.source)instanceof HTMLImageElement){if(!i.complete||0===i.naturalWidth)return!1}else if(i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Af.UNPACK),this.noSubImage||e.target!==r.TEXTURE_2D||n.width!==s||n.height!==o?(n.width=s,n.height=o,r.texImage2D(e.target,0,n.internalFormat,e.format,n.type,i)):r.texSubImage2D(r.TEXTURE_2D,0,0,0,e.format,n.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source,n=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(n,i),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(N_),B_=function(t){function e(e){return t.call(this,e)||this}return I_(e,t),e.test=function(t){var e=globalThis.OffscreenCanvas;return!!(e&&t instanceof e)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement},e}(G_),k_=function(t){function e(n,i){var r=this,s=i||{},o=s.width,a=s.height,h=s.autoLoad,u=s.linkBaseTexture;if(n&&n.length!==e.SIDES)throw new Error("Invalid length. Got "+n.length+", expected 6");r=t.call(this,6,{width:o,height:a})||this;for(var l=0;l<e.SIDES;l++)r.items[l].target=vf.TEXTURE_CUBE_MAP_POSITIVE_X+l;return r.linkBaseTexture=!1!==u,n&&r.initFromArray(n,i),!1!==h&&r.load(),r}return I_(e,t),e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=vf.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,e,n){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=vf.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this},e.prototype.upload=function(t,n,i){for(var r=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];r[s]<o.dirtyId&&(o.valid&&o.resource?(o.resource.upload(t,o,i),r[s]=o.dirtyId):r[s]<-1&&(t.gl.texImage2D(o.target,0,i.internalFormat,n.realWidth,n.realHeight,0,n.format,i.type,null),r[s]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(F_),V_=function(t){function e(e,n){var i=this;if(n=n||{},!(e instanceof HTMLImageElement)){var r=new Image;G_.crossOrigin(r,e,n.crossorigin),r.src=e,e=r}return i=t.call(this,e)||this,!e.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=e.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(void 0!==n.createBitmap?n.createBitmap:Ad.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,i.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,i.bitmap=null,i._load=null,!1!==n.autoLoad&&i.load(),i}return I_(e,t),e.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,n){var i=e.source;e.url=i.src;var r=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?r():(i.onload=r,i.onerror=function(t){n(t),e.onError.emit(t)})}))),this._load},e.prototype.process=function(){var t=this,e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var n=globalThis.createImageBitmap,i=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then((function(t){return t.blob()})).then((function(i){return n(i,0,0,e.width,e.height,{premultiplyAlpha:t.alphaMode===Af.UNPACK?"premultiply":"none"})})).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process},e.prototype.upload=function(e,n,i){if("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,n,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,n,i,this.bitmap),!this.preserveBitmap){var r=!0,s=n._glTextures;for(var o in s){var a=s[o];if(a!==i&&a.dirtyId!==n.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement},e}(G_),X_=function(t){function e(e,n){var i=this;return n=n||{},(i=t.call(this,document.createElement("canvas"))||this)._width=0,i._height=0,i.svg=e,i.scale=n.scale||1,i._overrideWidth=n.width,i._overrideHeight=n.height,i._resolve=null,i._crossorigin=n.crossorigin,i._load=null,!1!==n.autoLoad&&i.load(),i}return I_(e,t),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(n){if(t._resolve=function(){t.resize(t.source.width,t.source.height),n(t)},e.SVG_XML.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var t=this,e=new Image;G_.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(n){t._resolve&&(e.onerror=null,t.onError.emit(n))},e.onload=function(){if(t._resolve){var n=e.width,i=e.height;if(!n||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var r=n*t.scale,s=i*t.scale;(t._overrideWidth||t._overrideHeight)&&(r=t._overrideWidth||t._overrideHeight/i*n,s=t._overrideHeight||t._overrideWidth/n*i),r=Math.round(r),s=Math.round(s);var o=t.source;o.width=r,o.height=s,o._pixiId="canvas_"+um(),o.getContext("2d").drawImage(e,0,0,n,i,0,0,r,s),t._resolve(),t._resolve=null}}},e.getSize=function(t){var n=e.SVG_SIZE.exec(t),i={};return n&&(i[n[1]]=Math.round(parseFloat(n[3])),i[n[5]]=Math.round(parseFloat(n[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,n){return"svg"===n||"string"==typeof t&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(t)||"string"==typeof t&&e.SVG_XML.test(t)},e.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(G_),j_=function(t){function e(n,i){var r=this;if(i=i||{},!(n instanceof HTMLVideoElement)){var s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),"string"==typeof n&&(n=[n]);var o=n[0].src||n[0];G_.crossOrigin(s,o,i.crossorigin);for(var a=0;a<n.length;++a){var h=document.createElement("source"),u=n[a],l=u.src,c=u.mime,p=(l=l||n[a]).split("?").shift().toLowerCase(),d=p.slice(p.lastIndexOf(".")+1);c=c||e.MIME_TYPES[d]||"video/"+d,h.src=l,h.type=c,s.appendChild(h)}n=s}return(r=t.call(this,n)||this).noSubImage=!0,r._autoUpdate=!0,r._isConnectedToTicker=!1,r._updateFPS=i.updateFPS||0,r._msToNextUpdate=0,r.autoPlay=!1!==i.autoPlay,r._load=null,r._resolve=null,r._onCanPlay=r._onCanPlay.bind(r),r._onError=r._onError.bind(r),!1!==i.autoLoad&&r.load(),r}return I_(e,t),e.prototype.update=function(e){if(!this.destroyed){var n=__.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(n){t.valid?n(t):(t._resolve=n,e.load())})),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){var t=this.source;return 3===t.readyState||4===t.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(__.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(__.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&(__.shared.remove(this.update,this),this._isConnectedToTicker=!1);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(__.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(__.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,n){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(n)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(G_),H_=function(t){function e(e){return t.call(this,e)||this}return I_(e,t),e.test=function(t){return!!globalThis.createImageBitmap&&t instanceof ImageBitmap},e}(G_);R_.push(V_,H_,B_,j_,X_,M_,k_,U_);var $_={__proto__:null,Resource:N_,BaseImageResource:G_,INSTALLED:R_,autoDetectResource:C_,AbstractMultiResource:F_,ArrayResource:U_,BufferResource:M_,CanvasResource:B_,CubeResource:k_,ImageResource:V_,SVGResource:X_,VideoResource:j_,ImageBitmapResource:H_},Y_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return I_(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Af.UNPACK);var r=e.realWidth,s=e.realHeight;return n.width===r&&n.height===s?i.texSubImage2D(e.target,0,0,0,r,s,e.format,n.type,this.data):(n.width=r,n.height=s,i.texImage2D(e.target,0,n.internalFormat,r,s,0,e.format,n.type,this.data)),!0},e}(M_),W_=function(){function t(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new w_("disposeFramebuffer"),this.multisample=Of.NONE}return Object.defineProperty(t.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),t.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new L_(null,{scaleMode:Ef.NEAREST,resolution:1,mipmap:xf.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.addDepthTexture=function(t){return this.depthTexture=t||new L_(new Y_(null,{width:this.width,height:this.height}),{scaleMode:Ef.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:xf.OFF,format:gf.DEPTH_COMPONENT,type:yf.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var i=this.colorTextures[n],r=i.resolution;i.setSize(t/r,e/r)}if(this.depthTexture){r=this.depthTexture.resolution;this.depthTexture.setSize(t/r,e/r)}}},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},t}(),z_=function(t){function e(e){void 0===e&&(e={});var n=this;if("number"==typeof e){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];e={width:i,height:r,scaleMode:s,resolution:o}}return e.width=e.width||100,e.height=e.height||100,e.multisample=void 0!==e.multisample?e.multisample:Of.NONE,(n=t.call(this,null,e)||this).mipmap=xf.OFF,n.valid=!0,n.clearColor=[0,0,0,0],n.framebuffer=new W_(n.realWidth,n.realHeight).addColorTexture(0,n),n.framebuffer.multisample=e.multisample,n.maskStack=[],n.filterStack=[{}],n}return I_(e,t),e.prototype.resize=function(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(L_),q_=function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return t.prototype.set=function(t,e,n){var i=e.width,r=e.height;if(n){var s=t.width/2/i,o=t.height/2/r,a=t.x/i+s,h=t.y/r+o;n=Bm.add(n,Bm.NW),this.x0=a+s*Bm.uX(n),this.y0=h+o*Bm.uY(n),n=Bm.add(n,2),this.x1=a+s*Bm.uX(n),this.y1=h+o*Bm.uY(n),n=Bm.add(n,2),this.x2=a+s*Bm.uX(n),this.y2=h+o*Bm.uY(n),n=Bm.add(n,2),this.x3=a+s*Bm.uX(n),this.y3=h+o*Bm.uY(n)}else this.x0=t.x/i,this.y0=t.y/r,this.x1=(t.x+t.width)/i,this.y1=t.y/r,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/r,this.x3=t.x/i,this.y3=(t.y+t.height)/r;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},t.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},t}(),Z_=new q_,K_=function(t){function e(n,i,r,s,o,a){var h=t.call(this)||this;if(h.noFrame=!1,i||(h.noFrame=!0,i=new Sm(0,0,1,1)),n instanceof e&&(n=n.baseTexture),h.baseTexture=n,h._frame=i,h.trim=s,h.valid=!1,h._uvs=Z_,h.uvMatrix=null,h.orig=r||i,h._rotate=Number(o||0),!0===o)h._rotate=2;else if(h._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return h.defaultAnchor=a?new xm(a.x,a.y):new xm(0,0),h._updateID=0,h.textureCacheIds=[],n.valid?h.noFrame?n.valid&&h.onBaseTextureUpdated(n):h.frame=i:n.once("loaded",h.onBaseTextureUpdated,h),h.noFrame&&n.on("update",h.onBaseTextureUpdated,h),h}return I_(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var n=this.baseTexture.resource;n&&n.url&&fm[n.url]&&e.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){var t=this._frame.clone(),n=this._frame===this.orig?t:this.orig.clone(),i=new e(this.baseTexture,!this.noFrame&&t,n,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i},e.prototype.updateUvs=function(){this._uvs===Z_&&(this._uvs=new q_),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,n,i){void 0===n&&(n={}),void 0===i&&(i=Ad.STRICT_TEXTURE_CACHE);var r="string"==typeof t,s=null;if(r)s=t;else if(t instanceof L_){if(!t.cacheId){var o=n&&n.pixiIdPrefix||"pixiid";t.cacheId=o+"-"+um(),L_.addToCache(t,t.cacheId)}s=t.cacheId}else{if(!t._pixiId){o=n&&n.pixiIdPrefix||"pixiid";t._pixiId=o+"_"+um()}s=t._pixiId}var a=fm[s];if(r&&i&&!a)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return a||t instanceof L_?!a&&t instanceof L_&&(a=new e(t),e.addToCache(a,s)):(n.resolution||(n.resolution=vm(t)),(a=new e(new L_(t,n))).baseTexture.cacheId=s,L_.addToCache(a.baseTexture,s),e.addToCache(a,s)),a},e.fromURL=function(t,n){var i=Object.assign({autoLoad:!1},null==n?void 0:n.resourceOptions),r=e.from(t,Object.assign({resourceOptions:i},n),!1),s=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):s.load().then((function(){return Promise.resolve(r)}))},e.fromBuffer=function(t,n,i,r){return new e(L_.fromBuffer(t,n,i,r))},e.fromLoader=function(t,n,i,r){var s=new L_(t,Object.assign({scaleMode:Ad.SCALE_MODE,resolution:vm(n)},r)),o=s.resource;o instanceof V_&&(o.url=n);var a=new e(s);return i||(i=n),L_.addToCache(a.baseTexture,i),e.addToCache(a,i),i!==n&&(L_.addToCache(a.baseTexture,n),e.addToCache(a,n)),a.baseTexture.valid?Promise.resolve(a):new Promise((function(t){a.baseTexture.once("loaded",(function(){return t(a)}))}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),fm[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),fm[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=fm[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete fm[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)fm[t.textureCacheIds[i]]===t&&delete fm[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,n=t.y,i=t.width,r=t.height,s=e+i>this.baseTexture.width,o=n+r>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+n+" + "+r+" = "+(n+r)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=i&&r&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},e}(wd);function J_(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}K_.EMPTY=new K_(new L_),J_(K_.EMPTY),J_(K_.EMPTY.baseTexture),K_.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new K_(new L_(new B_(t)))}(),J_(K_.WHITE),J_(K_.WHITE.baseTexture);var Q_=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return I_(e,t),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,n){void 0===n&&(n=!0);var i=this.baseTexture.resolution,r=Math.round(t*i)/i,s=Math.round(e*i)/i;this.valid=r>0&&s>0,this._frame.width=this.orig.width=r,this._frame.height=this.orig.height=s,n&&this.baseTexture.resize(r,s),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){for(var n=arguments,i=[],r=1;r<arguments.length;r++)i[r-1]=n[r];return"number"==typeof t&&(cm("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:i[0],scaleMode:i[1],resolution:i[2]}),new e(new z_(t))},e}(K_),tg=function(){function t(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return t.prototype.createTexture=function(t,e,n){void 0===n&&(n=Of.NONE);var i=new z_(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new Q_(i)},t.prototype.getOptimalTexture=function(t,e,n,i){var r;void 0===n&&(n=1),void 0===i&&(i=Of.NONE),t=Math.ceil(t*n-1e-6),e=Math.ceil(e*n-1e-6),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?r=i>1?-i:-1:(r=((65535&(t=im(t)))<<16|65535&(e=im(e)))>>>0,i>1&&(r+=4294967296*i)),this.texturePool[r]||(this.texturePool[r]=[]);var s=this.texturePool[r].pop();return s||(s=this.createTexture(t,e,i)),s.filterPoolKey=r,s.setResolution(n),s},t.prototype.getFilterTexture=function(t,e,n){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||Of.NONE);return i.filterFrame=t.filterFrame,i},t.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},t.prototype.returnFilterTexture=function(t){this.returnTexture(t)},t.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var n=this.texturePool[e];if(n)for(var i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}},t.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){for(var e in this.enableFullScreen=t.width>0&&t.height>0,this.texturePool)if(Number(e)<0){var n=this.texturePool[e];if(n)for(var i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}},t.SCREEN_KEY=-1,t}(),eg=function(){function t(t,e,n,i,r,s,o){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===i&&(i=yf.FLOAT),this.buffer=t,this.size=e,this.normalized=n,this.type=i,this.stride=r,this.start=s,this.instance=o}return t.prototype.destroy=function(){this.buffer=null},t.from=function(e,n,i,r,s){return new t(e,n,i,r,s)},t}(),ng=0,ig=function(){function t(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=ng++,this.disposeRunner=new w_("disposeBuffer")}return t.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(t.prototype,"index",{get:function(){return this.type===If.ELEMENT_ARRAY_BUFFER},set:function(t){this.type=t?If.ELEMENT_ARRAY_BUFFER:If.ARRAY_BUFFER},enumerable:!1,configurable:!0}),t.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e)},t}(),rg={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var sg={5126:4,5123:2,5121:1},og=0,ag={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},hg=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=og++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new w_("disposeGeometry"),this.refCount=0}return t.prototype.addAttribute=function(t,e,n,i,r,s,o,a){if(void 0===n&&(n=0),void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof ig||(e instanceof Array&&(e=new Float32Array(e)),e=new ig(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,n,i,r);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new eg(l,n,i,r,s,o,a),this.instanced=this.instanced||a,this},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},t.prototype.addIndex=function(t){return t instanceof ig||(t instanceof Array&&(t=new Uint16Array(t)),t=new ig(t)),t.type=If.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},t.prototype.getIndex=function(){return this.indexBuffer},t.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],n=[],i=new ig;for(t in this.attributes){var r=this.attributes[t],s=this.buffers[r.buffer];e.push(s.data),n.push(r.size*sg[r.type]/4),r.buffer=0}for(i.data=function(t,e){for(var n=0,i=0,r={},s=0;s<t.length;s++)i+=e[s],n+=t[s].length;var o=new ArrayBuffer(4*n),a=null,h=0;for(s=0;s<t.length;s++){var u=e[s],l=t[s],c=nm(l);r[c]||(r[c]=new rg[c](o)),a=r[c];for(var p=0;p<l.length;p++)a[(p/u|0)*i+h+p%u]=l[p];h+=u}return new Float32Array(o)}(e,n),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},t.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},t.prototype.clone=function(){for(var e=new t,n=0;n<this.buffers.length;n++)e.buffers[n]=new ig(this.buffers[n].data.slice(0));for(var n in this.attributes){var i=this.attributes[n];e.attributes[n]=new eg(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=If.ELEMENT_ARRAY_BUFFER),e},t.merge=function(e){for(var n,i=new t,r=[],s=[],o=[],a=0;a<e.length;a++){n=e[a];for(var h=0;h<n.buffers.length;h++)s[h]=s[h]||0,s[h]+=n.buffers[h].data.length,o[h]=0}for(a=0;a<n.buffers.length;a++)r[a]=new(ag[nm(n.buffers[a].data)])(s[a]),i.buffers[a]=new ig(r[a]);for(a=0;a<e.length;a++){n=e[a];for(h=0;h<n.buffers.length;h++)r[h].set(n.buffers[h].data,o[h]),o[h]+=n.buffers[h].data.length}if(i.attributes=n.attributes,n.indexBuffer){i.indexBuffer=i.buffers[n.buffers.indexOf(n.indexBuffer)],i.indexBuffer.type=If.ELEMENT_ARRAY_BUFFER;var u=0,l=0,c=0,p=0;for(a=0;a<n.buffers.length;a++)if(n.buffers[a]!==n.indexBuffer){p=a;break}for(var a in n.attributes){var d=n.attributes[a];(0|d.buffer)===p&&(l+=d.size*sg[d.type]/4)}for(a=0;a<e.length;a++){var f=e[a].indexBuffer.data;for(h=0;h<f.length;h++)i.indexBuffer.data[h+c]+=u;u+=e[a].buffers[p].data.length/l,c+=f.length}}return i},t}(),ug=function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return I_(e,t),e}(hg),lg=function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new ig(e.vertices),e.uvBuffer=new ig(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return I_(e,t),e.prototype.map=function(t,e){var n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+e.width/t.width,this.uvs[3]=i,this.uvs[4]=n+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=n,this.uvs[7]=i+e.height/t.height,n=e.x,i=e.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+e.width,this.vertices[3]=i,this.vertices[4]=n+e.width,this.vertices[5]=i+e.height,this.vertices[6]=n,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(hg),cg=0,pg=function(){function t(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=cg++,this.static=!!e,this.ubo=!!n,t instanceof ig?(this.buffer=t,this.buffer.type=If.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new ig(new Float32Array(1)),this.buffer.type=If.UNIFORM_BUFFER,this.autoManage=!0))}return t.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},t.prototype.add=function(e,n,i){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new t(n,i)},t.from=function(e,n,i){return new t(e,n,i)},t.uboFrom=function(e,n){return new t(e,null==n||n,!0)},t}(),dg=function(){function t(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Of.NONE,this.sourceFrame=new Sm,this.destinationFrame=new Sm,this.bindingSourceFrame=new Sm,this.bindingDestinationFrame=new Sm,this.filters=[],this.transform=null}return t.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},t}(),fg=[new xm,new xm,new xm,new xm],mg=new Pm,_g=function(){function t(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new tg,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new ug,this.quadUv=new lg,this.tempRect=new Sm,this.activeState={},this.globalUniforms=new pg({outputFrame:new Sm,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t.prototype.push=function(t,e){for(var n,i,r=this.renderer,s=this.defaultFilterStack,o=this.statePool.pop()||new dg,a=this.renderer.renderTexture,h=e[0].resolution,u=e[0].multisample,l=e[0].padding,c=e[0].autoFit,p=null===(n=e[0].legacy)||void 0===n||n,d=1;d<e.length;d++){var f=e[d];h=Math.min(h,f.resolution),u=Math.min(u,f.multisample),l=this.useMaxPadding?Math.max(l,f.padding):l+f.padding,c=c&&f.autoFit,p=p||null===(i=f.legacy)||void 0===i||i}if(1===s.length&&(this.defaultFilterStack[0].renderTexture=a.current),s.push(o),o.resolution=h,o.multisample=u,o.legacy=p,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(l),c){var m=this.tempRect.copyFrom(a.sourceFrame);r.projection.transform&&this.transformAABB(mg.copyFrom(r.projection.transform).invert(),m),o.sourceFrame.fit(m)}this.roundFrame(o.sourceFrame,a.current?a.current.resolution:r.resolution,a.sourceFrame,a.destinationFrame,r.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,h,u),o.filters=e,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;var _=this.tempRect;_.x=0,_.y=0,_.width=o.sourceFrame.width,_.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(a.sourceFrame),o.bindingDestinationFrame.copyFrom(a.destinationFrame),o.transform=r.projection.transform,r.projection.transform=null,a.bind(o.renderTexture,o.sourceFrame,_),r.framebuffer.clear(0,0,0,0)},t.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var r=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(r[0]=e.destinationFrame.width,r[1]=e.destinationFrame.height,r[2]=1/r[0],r[3]=1/r[1],s[0]=Math.round(r[0]*e.resolution),s[1]=Math.round(r[1]*e.resolution),s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*r[2]-.5*s[2],o[3]=e.sourceFrame.height*r[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,e.renderTexture,h.renderTexture,Sf.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<n.length-1;++c){1===c&&e.multisample>1&&((l=this.getOptimalFilterTexture(u.width,u.height,e.resolution)).filterFrame=u.filterFrame),n[c].apply(this,u,l,Sf.CLEAR,e);var p=u;u=l,l=p}n[c].apply(this,u,h.renderTexture,Sf.BLEND,e),c>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.bindAndClear=function(t,e){void 0===e&&(e=Sf.CLEAR);var n=this.renderer,i=n.renderTexture,r=n.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame){var s=this.tempRect;s.x=0,s.y=0,s.width=t.filterFrame.width,s.height=t.filterFrame.height,i.bind(t,t.filterFrame,s)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var o=1&r.stateId||this.forceClear;(e===Sf.CLEAR||e===Sf.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)},t.prototype.applyFilter=function(t,e,n,i){var r=this.renderer;r.state.set(t.state),this.bindAndClear(n,i),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,r.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),r.geometry.bind(this.quadUv),r.geometry.draw(_f.TRIANGLES)):(r.geometry.bind(this.quad),r.geometry.draw(_f.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var n=this.activeState,i=n.sourceFrame,r=n.destinationFrame,s=e._texture.orig,o=t.set(r.width,0,0,r.height,i.x,i.y),a=e.worldTransform.copyTo(Pm.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,n,i){return void 0===n&&(n=1),void 0===i&&(i=Of.NONE),this.texturePool.getOptimalTexture(t,e,n,i)},t.prototype.getFilterTexture=function(t,e,n){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||Of.NONE);return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t.prototype.transformAABB=function(t,e){var n=fg[0],i=fg[1],r=fg[2],s=fg[3];n.set(e.left,e.top),i.set(e.left,e.bottom),r.set(e.right,e.top),s.set(e.right,e.bottom),t.apply(n,n),t.apply(i,i),t.apply(r,r),t.apply(s,s);var o=Math.min(n.x,i.x,r.x,s.x),a=Math.min(n.y,i.y,r.y,s.y),h=Math.max(n.x,i.x,r.x,s.x),u=Math.max(n.y,i.y,r.y,s.y);e.x=o,e.y=a,e.width=h-o,e.height=u-a},t.prototype.roundFrame=function(t,e,n,i,r){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(r){var s=r.a,o=r.b,a=r.c,h=r.d;if((Math.abs(o)>1e-4||Math.abs(a)>1e-4)&&(Math.abs(s)>1e-4||Math.abs(h)>1e-4))return}(r=r?mg.copyFrom(r):mg.identity()).translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(r,t),t.ceil(e),this.transformAABB(r.invert(),t)}},t}(),gg=function(){function t(t){this.renderer=t}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.render=function(t){},t}(),vg=function(){function t(t){this.renderer=t,this.emptyRenderer=new gg(t),this.currentRenderer=this.emptyRenderer}return t.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(t,e){for(var n=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=n[i]||null,t[i]&&(t[i]._batchLocation=i)},t.prototype.boundArray=function(t,e,n,i){for(var r=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=r[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==n||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},t.prototype.destroy=function(){this.renderer=null},t}(),yg=0,Tg=function(){function t(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=yg++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=yg++,this.renderer.runners.contextChange.emit(t)},t.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var n;if(Ad.PREFER_ENV>=pf.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var t=this.gl,e={anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},t.prototype.handleContextLost=function(t){t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(t){var e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var i=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},t}(),Eg=function(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Of.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},bg=new Sm,xg=function(){function t(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new W_(10,10),this.msaaSamples=null}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Sm,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;Ad.PREFER_ENV===pf.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},t.prototype.bind=function(t,e,n){void 0===n&&(n=0);var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,r.mipLevel=n),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,r.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var s=0;s<t.colorTextures.length;s++){var o=t.colorTextures[s];this.renderer.texture.unbind(o.parentTextureArray||o)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var a=e.width>>n,h=e.height>>n,u=a/e.width;this.setViewport(e.x*u,e.y*u,a,h)}else{a=t.width>>n,h=t.height>>n;this.setViewport(0,0,a,h)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(t,e,n,i){var r=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),i=Math.round(i),r.width===n&&r.height===i&&r.x===t&&r.y===e||(r.x=t,r.y=e,r.width=n,r.height=i,this.gl.viewport(t,e,n,i))},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(t,e,n,i,r){void 0===r&&(r=ff.COLOR|ff.DEPTH);var s=this.gl;s.clearColor(t,e,n,i),s.clear(r)},t.prototype.initFramebuffer=function(t){var e=this.gl,n=new Eg(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n},t.prototype.resizeFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID];n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.RGBA8,t.width,t.height)),n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var i=t.colorTextures,r=i.length;e.drawBuffers||(r=Math.min(r,1));for(var s=0;s<r;s++){var o=i[s],a=o.parentTextureArray||o;this.renderer.texture.bind(a,0)}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t,e){var n=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures,s=r.length;n.drawBuffers||(s=Math.min(s,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?(i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.RGBA8,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));for(var o=[],a=0;a<s;a++){var h=r[a],u=h.parentTextureArray||h;this.renderer.texture.bind(u,0),0===a&&i.msaaBuffer||(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+a,h.target,u._glTextures[this.CONTEXT_UID].texture,e),o.push(n.COLOR_ATTACHMENT0+a))}if((o.length>1&&n.drawBuffers(o),t.depthTexture)&&this.writeDepthTexture){var l=t.depthTexture;this.renderer.texture.bind(l,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null):(i.stencil=i.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,i.stencil))},t.prototype.canMultisampleFramebuffer=function(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture},t.prototype.detectSamples=function(t){var e=this.msaaSamples,n=Of.NONE;if(t<=1||null===e)return n;for(var i=0;i<e.length;i++)if(e[i]<=t){n=e[i];break}return 1===n&&(n=Of.NONE),n},t.prototype.blit=function(t,e,n){var i=this,r=i.current,s=i.renderer,o=i.gl,a=i.CONTEXT_UID;if(2===s.context.webGLVersion&&r){var h=r.glFramebuffers[a];if(h){if(!t){if(!h.msaaBuffer)return;var u=r.colorTextures[0];if(!u)return;h.blitFramebuffer||(h.blitFramebuffer=new W_(r.width,r.height),h.blitFramebuffer.addColorTexture(0,u)),(t=h.blitFramebuffer).colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),t.width===r.width&&t.height===r.height||(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||((e=bg).width=r.width,e.height=r.height),n||(n=e);var l=e.width===n.width&&e.height===n.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR)}}},t.prototype.disposeFramebuffer=function(t,e){var n=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(n){delete t.glFramebuffers[this.CONTEXT_UID];var r=this.managedFramebuffers.indexOf(t);r>=0&&this.managedFramebuffers.splice(r,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&n.blitFramebuffer.dispose()}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)},t.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.stencil=!0;var n=t.width,i=t.height,r=this.gl,s=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,s),e.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,e.multisample,r.DEPTH24_STENCIL8,n,i):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,n,i),e.stencil=s,r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Sm},t.prototype.destroy=function(){this.renderer=null},t}(),Ag={5126:4,5123:2,5121:1},Sg=function(){function t(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return t.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){var n=this.renderer.context.extensions.vertexArrayObject;Ad.PREFER_ENV===pf.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=function(){return n.createVertexArrayOES()},t.bindVertexArray=function(t){return n.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return n.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(2!==e.webGLVersion){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,n,r,s){return i.drawElementsInstancedANGLE(t,e,n,r,s)},t.drawArraysInstanced=function(t,e,n,r){return i.drawArraysInstancedANGLE(t,e,n,r)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var n=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID],r=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},r=!0);var s=i[e.program.id]||this.initGeometryVao(t,e,r);this._activeGeometry=t,this._activeVao!==s&&(this._activeVao=s,this.hasVao?n.bindVertexArray(s):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,n=0;n<t.buffers.length;n++){var i=t.buffers[n];e.update(i)}},t.prototype.checkCompatibility=function(t,e){var n=t.attributes,i=e.attributeData;for(var r in i)if(!n[r])throw new Error('shader and geometry incompatible, geometry missing the "'+r+'" attribute')},t.prototype.getSignature=function(t,e){var n=t.attributes,i=e.attributeData,r=["g",t.id];for(var s in n)i[s]&&r.push(s,i[s].location);return r.join("-")},t.prototype.initGeometryVao=function(t,e,n){void 0===n&&(n=!0);var i=this.gl,r=this.CONTEXT_UID,s=this.renderer.buffer,o=e.program;o.glPrograms[r]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);var a=this.getSignature(t,o),h=t.glVertexArrayObjects[this.CONTEXT_UID],u=h[a];if(u)return h[o.id]=u,u;var l=t.buffers,c=t.attributes,p={},d={};for(var f in l)p[f]=0,d[f]=0;for(var f in c)!c[f].size&&o.attributeData[f]?c[f].size=o.attributeData[f].size:c[f].size||console.warn("PIXI Geometry attribute '"+f+"' size cannot be determined (likely the bound shader does not have the attribute)"),p[c[f].buffer]+=c[f].size*Ag[c[f].type];for(var f in c){var m=c[f],_=m.size;void 0===m.stride&&(p[m.buffer]===_*Ag[m.type]?m.stride=0:m.stride=p[m.buffer]),void 0===m.start&&(m.start=d[m.buffer],d[m.buffer]+=_*Ag[m.type])}u=i.createVertexArray(),i.bindVertexArray(u);for(var g=0;g<l.length;g++){var v=l[g];s.bind(v),n&&v._glBuffers[r].refCount++}return this.activateVao(t,o),this._activeVao=u,h[o.id]=u,h[a]=u,u},t.prototype.disposeGeometry=function(t,e){var n;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,s=t.buffers,o=null===(n=this.renderer)||void 0===n?void 0:n.buffer;if(t.disposeRunner.remove(this),i){if(o)for(var a=0;a<s.length;a++){var h=s[a]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,0!==h.refCount||e||o.dispose(s[a],e))}if(!e)for(var u in i)if("g"===u[0]){var l=i[u];this._activeVao===l&&this.unbind(),r.deleteVertexArray(l)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)},t.prototype.activateVao=function(t,e){var n=this.gl,i=this.CONTEXT_UID,r=this.renderer.buffer,s=t.buffers,o=t.attributes;t.indexBuffer&&r.bind(t.indexBuffer);var a=null;for(var h in o){var u=o[h],l=s[u.buffer],c=l._glBuffers[i];if(e.attributeData[h]){a!==c&&(r.bind(l),a=c);var p=e.attributeData[h].location;if(n.enableVertexAttribArray(p),n.vertexAttribPointer(p,u.size,u.type||n.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(p,1)}}}},t.prototype.draw=function(t,e,n,i){var r=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?r.UNSIGNED_SHORT:r.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?r.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(n||0)*o,i||1):r.drawElements(t,e||s.indexBuffer.data.length,a,(n||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?r.drawArraysInstanced(t,n,e||s.getSize(),i||1):r.drawArrays(t,n,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t.prototype.destroy=function(){this.renderer=null},t}(),wg=function(){function t(t){void 0===t&&(t=null),this.type=Cf.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Ad.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null}return Object.defineProperty(t.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Cf.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},t.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},t}();function Rg(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}function Cg(t,e){var n=t.getShaderSource(e).split("\n").map((function(t,e){return e+": "+t})),i=t.getShaderInfoLog(e),r=i.split("\n"),s={},o=r.map((function(t){return parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))})).filter((function(t){return!(!t||s[t])&&(s[t]=!0,!0)})),a=[""];o.forEach((function(t){n[t-1]="%c"+n[t-1]+"%c",a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));var h=n.join("\n");a[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,a),console.groupEnd()}function Og(t){for(var e=new Array(t),n=0;n<e.length;n++)e[n]=!1;return e}function Ig(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Og(2*e);case"bvec3":return Og(3*e);case"bvec4":return Og(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Pg,Ng={},Mg=Ng;function Dg(){if(!Pg){Pg=Rf.MEDIUM;var t=function(){if(Mg===Ng||Mg&&Mg.isContextLost()){var t=document.createElement("canvas"),e=void 0;Ad.PREFER_ENV>=pf.WEBGL2&&(e=t.getContext("webgl2",{})),e||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),Mg=e}return Mg}();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Pg=e.precision?Rf.HIGH:Rf.MEDIUM}}return Pg}function Lg(t,e,n){if("precision"!==t.substring(0,9)){var i=e;return e===Rf.HIGH&&n!==Rf.HIGH&&(i=Rf.MEDIUM),"precision "+i+" float;\n"+t}return n!==Rf.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var Fg={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Ug(t){return Fg[t]}var Gg=null,Bg={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function kg(t,e){if(!Gg){var n=Object.keys(Bg);Gg={};for(var i=0;i<n.length;++i){var r=n[i];Gg[t[r]]=Bg[r]}}return Gg[e]}var Vg=[{test:function(t){return"float"===t.type&&1===t.size},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},{test:function(t){return("sampler2D"===t.type||"samplerCube"===t.type||"sampler2DArray"===t.type)&&1===t.size&&!t.isArray},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '},codeUbo:function(t){return"\n                var "+t+"_matrix = uv."+t+".toArray(true);\n\n                data[offset] = "+t+"_matrix[0];\n                data[offset+1] = "+t+"_matrix[1];\n                data[offset+2] = "+t+"_matrix[2];\n        \n                data[offset + 4] = "+t+"_matrix[3];\n                data[offset + 5] = "+t+"_matrix[4];\n                data[offset + 6] = "+t+"_matrix[5];\n        \n                data[offset + 8] = "+t+"_matrix[6];\n                data[offset + 9] = "+t+"_matrix[7];\n                data[offset + 10] = "+t+"_matrix[8];\n            "}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'},codeUbo:function(t){return"\n                v = uv."+t+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(t){return"vec2"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(t){return"\n                    v = uv."+t+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(t){return"vec4"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],Xg={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},jg={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Hg,$g=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Yg(t){for(var e="",n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+="if(test == "+n+".0){}");return e}var Wg=0,zg={},qg=function(){function t(e,n,i){void 0===i&&(i="pixi-shader"),this.id=Wg++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=n||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),zg[i]?(zg[i]++,i+="-"+zg[i]):zg[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=Lg(this.vertexSrc,Ad.PRECISION_VERTEX,Rf.HIGH),this.fragmentSrc=Lg(this.fragmentSrc,Ad.PRECISION_FRAGMENT,Dg())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(t,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),t.from=function(e,n,i){var r=e+n,s=dm[r];return s||(dm[r]=s=new t(e,n,i)),s},t}(),Zg=function(){function t(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof pg?e:new pg(e):new pg({})}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var n in e.uniforms){var i=e.uniforms[n];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},t.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(t.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),t.from=function(e,n,i){return new t(qg.from(e,n),i)},t}(),Kg=function(){function t(){this.data=0,this.blendMode=mf.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(t.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(t){!!(32&this.data)!==t&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==mf.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},t.for2d=function(){var e=new t;return e.depthTest=!1,e.blend=!0,e},t}(),Jg=function(t){function e(n,i,r){var s=this,o=qg.from(n||e.defaultVertexSrc,i||e.defaultFragmentSrc);return(s=t.call(this,o,r)||this).padding=0,s.resolution=Ad.FILTER_RESOLUTION,s.multisample=Ad.FILTER_MULTISAMPLE,s.enabled=!0,s.autoFit=!0,s.state=new Kg,s}return I_(e,t),e.prototype.apply=function(t,e,n,i,r){t.applyFilter(this,e,n,i)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),e}(Zg),Qg=new Pm,tv=function(){function t(t,e){this._texture=t,this.mapCoord=new Pm,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}return Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var n=this.mapCoord,i=0;i<t.length;i+=2){var r=t[i],s=t[i+1];e[i]=r*n.a+s*n.c+n.tx,e[i+1]=r*n.b+s*n.d+n.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var i=e.orig,r=e.trim;r&&(Qg.set(i.width/r.width,0,0,i.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(Qg));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},t}(),ev=function(t){function e(e,n,i){var r=this,s=null;return"string"!=typeof e&&void 0===n&&void 0===i&&(s=e,e=void 0,n=void 0,i=void 0),(r=t.call(this,e||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",n||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",i)||this).maskSprite=s,r.maskMatrix=new Pm,r}return I_(e,t),Object.defineProperty(e.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),e.prototype.apply=function(t,e,n,i){var r=this._maskSprite,s=r._texture;s.valid&&(s.uvMatrix||(s.uvMatrix=new tv(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,r).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=r.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,t.applyFilter(this,e,n,i))},e}(Jg),nv=function(){function t(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},t.prototype.push=function(t,e){var n=e;if(!n.isMaskData){var i=this.maskDataPool.pop()||new wg;i.pooled=!0,i.maskObject=e,n=i}var r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(r),n.autoDetect&&this.detect(n),n._target=t,n.type!==Cf.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case Cf.SCISSOR:this.renderer.scissor.push(n);break;case Cf.STENCIL:this.renderer.stencil.push(n);break;case Cf.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n)}n.type===Cf.SPRITE&&this.maskStack.push(n)},t.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){if(e.enabled)switch(e.type){case Cf.SCISSOR:this.renderer.scissor.pop();break;case Cf.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Cf.SPRITE:this.popSpriteMask(e)}if(e.reset(),e.pooled&&this.maskDataPool.push(e),0!==this.maskStack.length){var n=this.maskStack[this.maskStack.length-1];n.type===Cf.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}},t.prototype.detect=function(t){t.maskObject.isSprite?t.type=Cf.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Cf.SCISSOR:t.type=Cf.STENCIL},t.prototype.pushSpriteMask=function(t){var e,n,i=t.maskObject,r=t._target,s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex])||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new ev]);var o,a,h=this.renderer,u=h.renderTexture;if(u.current){var l=u.current;o=t.resolution||l.resolution,a=null!==(e=t.multisample)&&void 0!==e?e:l.multisample}else o=t.resolution||h.resolution,a=null!==(n=t.multisample)&&void 0!==n?n:h.multisample;s[0].resolution=o,s[0].multisample=a,s[0].maskSprite=i;var c=r.filterArea;r.filterArea=i.getBounds(!0),h.filter.push(r,s),r.filterArea=c,t._filters||this.alphaMaskIndex++},t.prototype.popSpriteMask=function(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},t.prototype.destroy=function(){this.renderer=null},t}(),iv=function(){function t(t){this.renderer=t,this.maskStack=[],this.glConst=0}return t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,n=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==n&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){this.renderer=null,this.maskStack=null},t}(),rv=new Pm,sv=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=WebGLRenderingContext.SCISSOR_TEST,n}return I_(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.calcScissorRect=function(t){if(!t._scissorRectLocal){var e=t._scissorRect,n=t.maskObject,i=this.renderer,r=i.renderTexture;n.renderable=!0;var s=n.getBounds();this.roundFrameToPixels(s,r.current?r.current.resolution:i.resolution,r.sourceFrame,r.destinationFrame,i.projection.transform),n.renderable=!1,e&&s.fit(e),t._scissorRectLocal=s}},e.isMatrixRotated=function(t){if(!t)return!1;var e=t.a,n=t.b,i=t.c,r=t.d;return(Math.abs(n)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(r)>1e-4)},e.prototype.testScissor=function(t){var n=t.maskObject;if(!n.isFastRect||!n.isFastRect())return!1;if(e.isMatrixRotated(n.worldTransform))return!1;if(e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);var i=t._scissorRectLocal;return i.width>0&&i.height>0},e.prototype.roundFrameToPixels=function(t,n,i,r,s){e.isMatrixRotated(s)||((s=s?rv.copyFrom(s):rv.identity()).translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.renderer.filter.transformAABB(s,t),t.fit(r),t.x=Math.round(t.x*n),t.y=Math.round(t.y*n),t.width=Math.round(t.width*n),t.height=Math.round(t.height*n))},e.prototype.push=function(t){t._scissorRectLocal||this.calcScissorRect(t);var e=this.renderer.gl;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t,e=this.maskStack[this.maskStack.length-1]._scissorRect;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)},e}(iv),ov=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=WebGLRenderingContext.STENCIL_TEST,n}return I_(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,n=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?e.disable(e.STENCIL_TEST):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e}(iv),av=function(){function t(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Pm,this.transform=null}return t.prototype.update=function(t,e,n,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);var r=this.renderer;r.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,r.globalUniforms.update(),r.shader.shader&&r.shader.syncUniformGroup(r.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,n,i){var r=this.projectionMatrix,s=i?-1:1;r.identity(),r.a=1/e.width*2,r.d=s*(1/e.height*2),r.tx=-1-e.x*r.a,r.ty=-s-e.y*r.d},t.prototype.setTransform=function(t){},t.prototype.destroy=function(){this.renderer=null},t}(),hv=new Sm,uv=new Sm,lv=function(){function t(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Sm,this.destinationFrame=new Sm,this.viewportFrame=new Sm}return t.prototype.bind=function(t,e,n){void 0===t&&(t=null);var i,r,s,o=this.renderer;this.current=t,t?(s=(i=t.baseTexture).resolution,e||(hv.width=t.frame.width,hv.height=t.frame.height,e=hv),n||(uv.x=t.frame.x,uv.y=t.frame.y,uv.width=e.width,uv.height=e.height,n=uv),r=i.framebuffer):(s=o.resolution,e||(hv.width=o.screen.width,hv.height=o.screen.height,e=hv),n||((n=hv).width=e.width,n.height=e.height));var a=this.viewportFrame;a.x=n.x*s,a.y=n.y*s,a.width=n.width*s,a.height=n.height*s,t||(a.y=o.view.height-(a.y+a.height)),a.ceil(),this.renderer.framebuffer.bind(r,a),this.renderer.projection.update(n,e,s,!r),t?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)},t.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor;var n=this.destinationFrame,i=this.current?this.current.baseTexture:this.renderer.screen,r=n.width!==i.width||n.height!==i.height;if(r){var s=this.viewportFrame,o=s.x,a=s.y,h=s.width,u=s.height;o=Math.round(o),a=Math.round(a),h=Math.round(h),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,a,h,u)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),r&&this.renderer.scissor.pop()},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t.prototype.destroy=function(){this.renderer=null},t}();function cv(t,e,n,i,r){n.buffer.update(r)}var pv={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},dv={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function fv(t,e){if(!t.autoManage)return{size:0,syncFunc:cv};for(var n=function(t,e){var n=[];for(var i in t)e[i]&&n.push(e[i]);return n.sort((function(t,e){return t.index-e.index})),n}(t.uniforms,e),i=function(t){for(var e=t.map((function(t){return{data:t,offset:0,dataLen:0,dirty:0}})),n=0,i=0,r=0,s=0;s<e.length;s++){var o=e[s];if(n=dv[o.data.type],o.data.size>1&&(n=Math.max(n,16)*o.data.size),o.dataLen=n,i%n!=0&&i<16){var a=i%n%16;i+=a,r+=a}i+n>16?(r=16*Math.ceil(r/16),o.offset=r,r+=n,i=n):(o.offset=r,i+=n,r+=n)}return{uboElements:e,size:r=16*Math.ceil(r/16)}}(n),r=i.uboElements,s=i.size,o=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],a=0;a<r.length;a++){for(var h=r[a],u=t.uniforms[h.data.name],l=h.data.name,c=!1,p=0;p<Vg.length;p++){var d=Vg[p];if(d.codeUbo&&d.test(h.data,u)){o.push("offset = "+h.offset/4+";",Vg[p].codeUbo(h.data.name,u)),c=!0;break}}if(!c)if(h.data.size>1){var f=Ug(h.data.type),m=Math.max(dv[h.data.type]/16,1),_=f/m,g=(4-_%4)%4;o.push("\n                cv = ud."+l+".value;\n                v = uv."+l+";\n                offset = "+h.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+h.data.size*m+"; i++)\n                {\n                    for(var j = 0; j < "+_+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+g+";\n                }\n\n                ")}else{var v=pv[h.data.type];o.push("\n                cv = ud."+l+".value;\n                v = uv."+l+";\n                offset = "+h.offset/4+";\n                "+v+";\n                ")}}return o.push("\n       renderer.buffer.update(buffer);\n    "),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join("\n"))}}var mv=function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},t}();function _v(t,e){var n=Rg(t,t.VERTEX_SHADER,e.vertexSrc),i=Rg(t,t.FRAGMENT_SHADER,e.fragmentSrc),r=t.createProgram();if(t.attachShader(r,n),t.attachShader(r,i),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)||function(t,e,n,i){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||Cg(t,n),t.getShaderParameter(i,t.COMPILE_STATUS)||Cg(t,i),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,r,n,i),e.attributeData=function(t,e){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),r=0;r<i;r++){var s=e.getActiveAttrib(t,r);if(0!==s.name.indexOf("gl_")){var o=kg(e,s.type),a={type:o,name:s.name,size:Ug(o),location:e.getAttribLocation(t,s.name)};n[s.name]=a}}return n}(r,t),e.uniformData=function(t,e){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=0;r<i;r++){var s=e.getActiveUniform(t,r),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),h=kg(e,s.type);n[o]={name:o,index:r,type:h,size:s.size,isArray:a,value:Ig(h,s.size)}}return n}(r,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){var s=Object.keys(e.attributeData);s.sort((function(t,e){return t>e?1:-1}));for(var o=0;o<s.length;o++)e.attributeData[s[o]].location=o,t.bindAttribLocation(r,o,s[o]);t.linkProgram(r)}t.deleteShader(n),t.deleteShader(i);var a={};for(var o in e.uniformData){var h=e.uniformData[o];a[o]={location:t.getUniformLocation(r,o),value:Ig(h.type,h.size)}}return new mv(r,a)}var gv=0,vv={textureCount:0,uboCount:0},yv=function(){function t(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=gv++}return t.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Hg)return Hg;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Hg=!0===t({a:"b"},"a","b")}catch(t){Hg=!1}return Hg}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var n=t.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),e||(vv.textureCount=0,vv.uboCount=0,this.syncUniformGroup(t.uniformGroup,vv)),i},t.prototype.setUniforms=function(t){var e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t,e){var n=this.getGlProgram();t.static&&t.dirtyId===n.uniformDirtyGroups[t.id]||(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))},t.prototype.syncUniforms=function(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){var n,i=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var r in t.uniforms){var s=e[r];if(s){for(var o=t.uniforms[r],a=!1,h=0;h<Vg.length;h++)if(Vg[h].test(s,o)){i.push(Vg[h].code(r,o)),a=!0;break}if(!a){var u=(1===s.size?Xg:jg)[s.type].replace("location",'ud["'+r+'"].location');i.push('\n            cu = ud["'+r+'"];\n            cv = cu.value;\n            v = uv["'+r+'"];\n            '+u+";")}}else(null===(n=t.uniforms[r])||void 0===n?void 0:n.group)&&(t.uniforms[r].ubo?i.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+r+", '"+r+"');\n                    "):i.push("\n                        renderer.shader.syncUniformGroup(uv."+r+", syncData);\n                    "))}return new Function("ud","uv","renderer","syncData",i.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},t.prototype.syncUniformBufferGroup=function(t,e){var n=this.getGlProgram();if(!t.static||0!==t.dirtyId||!n.uniformGroups[t.id]){t.dirtyId=0;var i=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),i(n.uniformData,t.uniforms,this.renderer,vv,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])},t.prototype.createSyncBufferGroup=function(t,e,n){var i=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var r=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(e.program,r,this.shader.uniformBindCount),this.shader.uniformBindCount++;var s=this.getSignature(t,this.shader.program.uniformData,"ubo"),o=this._uboCache[s];if(o||(o=this._uboCache[s]=fv(t,this.shader.program.uniformData)),t.autoManage){var a=new Float32Array(o.size/4);t.buffer.update(a)}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id]},t.prototype.getSignature=function(t,e,n){var i=t.uniforms,r=[n+"-"];for(var s in i)r.push(s),e[s]&&r.push(e[s].type);return r.join("-")},t.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateProgram=function(t){var e=this.gl,n=t.program,i=_v(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},t}();var Tv=function(){function t(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=mf.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Kg,this.defaultState.blend=!0}return t.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[mf.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.ADD]=[t.ONE,t.ONE],e[mf.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.NONE]=[0,0],e[mf.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[mf.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mf.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[mf.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[mf.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[mf.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[mf.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[mf.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[mf.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[mf.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[mf.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},t.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,n=0;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(n=0;n<this.checks.length;n++)this.checks[n](this,t)},t.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setDepthMask=function(t){this.gl.depthMask(t)},t.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},t.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}},t.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(t,e){var n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):e||-1===n||this.checks.splice(n,1)},t.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},t.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},t.prototype.destroy=function(){this.gl=null},t}(),Ev=function(){function t(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=Ad.GC_MAX_IDLE,this.checkCountMax=Ad.GC_MAX_CHECK_COUNT,this.mode=Ad.GC_MODE}return t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==wf.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,n=!1,i=0;i<e.length;i++){var r=e[i];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(t.destroyTexture(r,!0),e[i]=null,n=!0)}if(n){var s=0;for(i=0;i<e.length;i++)null!==e[i]&&(e[s++]=e[i]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.texture,n=t._texture;n&&!n.framebuffer&&e.destroyTexture(n);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},t.prototype.destroy=function(){this.renderer=null},t}();var bv=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=yf.UNSIGNED_BYTE,this.internalFormat=gf.RGBA,this.samplerType=0},xv=function(){function t(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new L_,this.hasIntegerTextures=!1}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){var e,n,i,r,s,o,a,h,u,l,c,p,d,f,m,_,g,v,y,T,E,b,x;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?((e={})[yf.UNSIGNED_BYTE]=((n={})[gf.RGBA]=t.RGBA8,n[gf.RGB]=t.RGB8,n[gf.RG]=t.RG8,n[gf.RED]=t.R8,n[gf.RGBA_INTEGER]=t.RGBA8UI,n[gf.RGB_INTEGER]=t.RGB8UI,n[gf.RG_INTEGER]=t.RG8UI,n[gf.RED_INTEGER]=t.R8UI,n[gf.ALPHA]=t.ALPHA,n[gf.LUMINANCE]=t.LUMINANCE,n[gf.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,n),e[yf.BYTE]=((i={})[gf.RGBA]=t.RGBA8_SNORM,i[gf.RGB]=t.RGB8_SNORM,i[gf.RG]=t.RG8_SNORM,i[gf.RED]=t.R8_SNORM,i[gf.RGBA_INTEGER]=t.RGBA8I,i[gf.RGB_INTEGER]=t.RGB8I,i[gf.RG_INTEGER]=t.RG8I,i[gf.RED_INTEGER]=t.R8I,i),e[yf.UNSIGNED_SHORT]=((r={})[gf.RGBA_INTEGER]=t.RGBA16UI,r[gf.RGB_INTEGER]=t.RGB16UI,r[gf.RG_INTEGER]=t.RG16UI,r[gf.RED_INTEGER]=t.R16UI,r[gf.DEPTH_COMPONENT]=t.DEPTH_COMPONENT16,r),e[yf.SHORT]=((s={})[gf.RGBA_INTEGER]=t.RGBA16I,s[gf.RGB_INTEGER]=t.RGB16I,s[gf.RG_INTEGER]=t.RG16I,s[gf.RED_INTEGER]=t.R16I,s),e[yf.UNSIGNED_INT]=((o={})[gf.RGBA_INTEGER]=t.RGBA32UI,o[gf.RGB_INTEGER]=t.RGB32UI,o[gf.RG_INTEGER]=t.RG32UI,o[gf.RED_INTEGER]=t.R32UI,o[gf.DEPTH_COMPONENT]=t.DEPTH_COMPONENT24,o),e[yf.INT]=((a={})[gf.RGBA_INTEGER]=t.RGBA32I,a[gf.RGB_INTEGER]=t.RGB32I,a[gf.RG_INTEGER]=t.RG32I,a[gf.RED_INTEGER]=t.R32I,a),e[yf.FLOAT]=((h={})[gf.RGBA]=t.RGBA32F,h[gf.RGB]=t.RGB32F,h[gf.RG]=t.RG32F,h[gf.RED]=t.R32F,h[gf.DEPTH_COMPONENT]=t.DEPTH_COMPONENT32F,h),e[yf.HALF_FLOAT]=((u={})[gf.RGBA]=t.RGBA16F,u[gf.RGB]=t.RGB16F,u[gf.RG]=t.RG16F,u[gf.RED]=t.R16F,u),e[yf.UNSIGNED_SHORT_5_6_5]=((l={})[gf.RGB]=t.RGB565,l),e[yf.UNSIGNED_SHORT_4_4_4_4]=((c={})[gf.RGBA]=t.RGBA4,c),e[yf.UNSIGNED_SHORT_5_5_5_1]=((p={})[gf.RGBA]=t.RGB5_A1,p),e[yf.UNSIGNED_INT_2_10_10_10_REV]=((d={})[gf.RGBA]=t.RGB10_A2,d[gf.RGBA_INTEGER]=t.RGB10_A2UI,d),e[yf.UNSIGNED_INT_10F_11F_11F_REV]=((f={})[gf.RGB]=t.R11F_G11F_B10F,f),e[yf.UNSIGNED_INT_5_9_9_9_REV]=((m={})[gf.RGB]=t.RGB9_E5,m),e[yf.UNSIGNED_INT_24_8]=((_={})[gf.DEPTH_STENCIL]=t.DEPTH24_STENCIL8,_),e[yf.FLOAT_32_UNSIGNED_INT_24_8_REV]=((g={})[gf.DEPTH_STENCIL]=t.DEPTH32F_STENCIL8,g),x=e):((v={})[yf.UNSIGNED_BYTE]=((y={})[gf.RGBA]=t.RGBA,y[gf.RGB]=t.RGB,y[gf.ALPHA]=t.ALPHA,y[gf.LUMINANCE]=t.LUMINANCE,y[gf.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,y),v[yf.UNSIGNED_SHORT_5_6_5]=((T={})[gf.RGB]=t.RGB,T),v[yf.UNSIGNED_SHORT_4_4_4_4]=((E={})[gf.RGBA]=t.RGBA,E),v[yf.UNSIGNED_SHORT_5_5_5_1]=((b={})[gf.RGBA]=t.RGBA,b),x=v),x}(t);var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var n=0;n<e;n++)this.boundTextures[n]=null;this.emptyTextures={};var i=new bv(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new bv(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(n=0;n<this.boundTextures.length;n++)this.bind(null,n)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var n=this.gl;if((t=null==t?void 0:t.castToBaseTexture())&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<n.length;i++)n[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[i]=null)},t.prototype.ensureSamplerType=function(t){var e=this,n=e.boundTextures,i=e.hasIntegerTextures,r=e.CONTEXT_UID;if(i)for(var s=t-1;s>=0;--s){var o=n[s];if(o)o._glTextures[r].samplerType!==Tf.FLOAT&&this.renderer.texture.unbind(o)}},t.prototype.initTexture=function(t){var e=new bv(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){var n,i;e.internalFormat=null!==(i=null===(n=this.internalFormats[t.type])||void 0===n?void 0:n[t.format])&&void 0!==i?i:t.format,2===this.webGLVersion&&t.type===yf.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var n=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(n,t,e))e.samplerType!==Tf.FLOAT&&(this.hasIntegerTextures=!0);else{var i=t.realWidth,r=t.realHeight,s=n.gl;(e.width!==i||e.height!==r||e.dirtyId<0)&&(e.width=i,e.height=r,s.texImage2D(t.target,0,e.internalFormat,i,r,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var n=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&om(this.managedTextures,i,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==xf.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=bf.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var n=this.gl;if(e.mipmap&&t.mipmap!==xf.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Ef.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===Ef.LINEAR){var r=Math.min(t.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Ef.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===Ef.LINEAR?n.LINEAR:n.NEAREST)},t.prototype.destroy=function(){this.renderer=null},t}(),Av={__proto__:null,FilterSystem:_g,BatchSystem:vg,ContextSystem:Tg,FramebufferSystem:xg,GeometrySystem:Sg,MaskSystem:nv,ScissorSystem:sv,StencilSystem:ov,ProjectionSystem:av,RenderTextureSystem:lv,ShaderSystem:yv,StateSystem:Tv,TextureGCSystem:Ev,TextureSystem:xv},Sv=new Pm,wv=function(t){function e(e,n){void 0===e&&(e=df.UNKNOWN);var i=t.call(this)||this;return n=Object.assign({},Ad.RENDER_OPTIONS,n),i.options=n,i.type=e,i.screen=new Sm(0,0,n.width,n.height),i.view=n.view||document.createElement("canvas"),i.resolution=n.resolution||Ad.RESOLUTION,i.useContextAlpha=n.useContextAlpha,i.autoDensity=!!n.autoDensity,i.preserveDrawingBuffer=n.preserveDrawingBuffer,i.clearBeforeRender=n.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,1],i._backgroundColorString="#000000",i.backgroundColor=n.backgroundColor||i._backgroundColor,i.backgroundAlpha=n.backgroundAlpha,void 0!==n.transparent&&(cm("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),i.useContextAlpha=n.transparent,i.backgroundAlpha=n.transparent?0:1),i._lastObjectRendered=null,i.plugins={},i}return I_(e,t),e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(e*this.resolution);var n=this.view.width/this.resolution,i=this.view.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.view.style.width=n+"px",this.view.style.height=i+"px"),this.emit("resize",n,i)},e.prototype.generateTexture=function(t,e,n,i){void 0===e&&(e={}),"number"==typeof e&&(cm("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),e={scaleMode:e,resolution:n,region:i});var r=e.region,s=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&(n[i[r]]=t[i[r]])}return n}(e,["region"]);0===(i=r||t.getLocalBounds(null,!0)).width&&(i.width=1),0===i.height&&(i.height=1);var o=Q_.create(P_({width:i.width,height:i.height},s));return Sv.tx=-i.x,Sv.ty=-i.y,this.render(t,{renderTexture:o,clear:!1,transform:Sv,skipUpdateTransform:!!t.parent}),o},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var n=this;n.plugins=null,n.type=df.UNKNOWN,n.view=null,n.screen=null,n._tempDisplayObjectParent=null,n.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=Zf(t),qf(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),e}(wd),Rv=function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},Cv=function(){function t(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}return t.prototype.destroy=function(){this.renderer=null},t.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},t.prototype.bind=function(t){var e=this.gl,n=this.CONTEXT_UID,i=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,i.buffer)},t.prototype.bindBufferBase=function(t,e){var n=this.gl,i=this.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var r=t._glBuffers[i]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,r.buffer)}},t.prototype.bindBufferRange=function(t,e,n){var i=this.gl,r=this.CONTEXT_UID;n=n||0;var s=t._glBuffers[r]||this.createGLBuffer(t);i.bindBufferRange(i.UNIFORM_BUFFER,e||0,s.buffer,256*n,256)},t.prototype.update=function(t){var e=this.gl,n=this.CONTEXT_UID,i=t._glBuffers[n];if(t._updateID!==i.updateID)if(i.updateID=t._updateID,e.bindBuffer(t.type,i.buffer),i.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{var r=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;i.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,r)}},t.prototype.dispose=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var n=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),n&&(e||i.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)},t.prototype.createGLBuffer=function(t){var e=this.CONTEXT_UID,n=this.gl;return t._glBuffers[e]=new Rv(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]},t}(),Ov=function(t){function e(n){var i=t.call(this,df.WEBGL,n)||this;return n=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new w_("destroy"),contextChange:new w_("contextChange"),reset:new w_("reset"),update:new w_("update"),postrender:new w_("postrender"),prerender:new w_("prerender"),resize:new w_("resize")},i.runners.contextChange.add(i),i.globalUniforms=new pg({projectionMatrix:new Pm},!0),i.addSystem(nv,"mask").addSystem(Tg,"context").addSystem(Tv,"state").addSystem(yv,"shader").addSystem(xv,"texture").addSystem(Cv,"buffer").addSystem(Sg,"geometry").addSystem(xg,"framebuffer").addSystem(sv,"scissor").addSystem(ov,"stencil").addSystem(av,"projection").addSystem(Ev,"textureGC").addSystem(_g,"filter").addSystem(lv,"renderTexture").addSystem(vg,"batch"),i.initPlugins(e.__plugins),i.multisample=void 0,n.context?i.context.initFromContext(n.context):i.context.initFromOptions({alpha:!!i.useContextAlpha,antialias:n.antialias,premultipliedAlpha:i.useContextAlpha&&"notMultiplied"!==i.useContextAlpha,stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,function(t){var e;if(!Wf){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var n=["\n %c %c %c PixiJS 6.3.0 - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=globalThis.console).log.apply(e,n)}else globalThis.console&&globalThis.console.log("PixiJS 6.3.0 - "+t+" - http://www.pixijs.com/");Wf=!0}}(2===i.context.webGLVersion?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return I_(e,t),e.create=function(t){if(void 0===Yf&&(Yf=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:Ad.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!globalThis.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!(!n||!n.getContextAttributes().stencil);if(n){var r=n.getExtension("WEBGL_lose_context");r&&r.loseContext()}return n=null,i}catch(t){return!1}}()),Yf)return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.contextChange=function(){var t,e=this.gl;if(1===this.context.webGLVersion){var n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}t>=Of.HIGH?this.multisample=Of.HIGH:t>=Of.MEDIUM?this.multisample=Of.MEDIUM:t>=Of.LOW?this.multisample=Of.LOW:this.multisample=Of.NONE},e.prototype.addSystem=function(t,e){var n=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var i in this[e]=n,this.runners)this.runners[i].add(n);return this},e.prototype.render=function(t,e){var n,i,r,s;if(e&&(e instanceof Q_?(cm("6.0.0","Renderer#render arguments changed, use options instead."),n=e,i=arguments[2],r=arguments[3],s=arguments[4]):(n=e.renderTexture,i=e.clear,r=e.transform,s=e.skipUpdateTransform)),this.renderingToScreen=!n,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(n||(this._lastObjectRendered=t),!s){var o=t.enableTempParent();t.updateTransform(),t.disableTempParent(o)}this.renderTexture.bind(n),this.batch.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),n&&n.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.generateTexture=function(e,n,i,r){void 0===n&&(n={});var s=t.prototype.generateTexture.call(this,e,n,i,r);return this.framebuffer.blit(),s},e.prototype.resize=function(e,n){t.prototype.resize.call(this,e,n),this.runners.resize.emit(this.screen.height,this.screen.width)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(e){for(var n in this.runners.destroy.emit(),this.runners)this.runners[n].destroy();t.prototype.destroy.call(this,e),this.gl=null},Object.defineProperty(e.prototype,"extract",{get:function(){return cm("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),e.registerPlugin=function(t,n){e.__plugins=e.__plugins||{},e.__plugins[t]=n},e}(wv);var Iv="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",Pv=function(){this.texArray=null,this.blend=0,this.type=_f.TRIANGLES,this.start=0,this.size=0,this.data=null},Nv=function(){function t(){this.elements=[],this.ids=[],this.count=0}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},t}(),Mv=function(){function t(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(t.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"]},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},t}(),Dv=function(t){function e(e){var n=t.call(this,e)||this;return n.shaderGenerator=null,n.geometryClass=null,n.vertexSize=null,n.state=Kg.for2d(),n.size=4*Ad.SPRITE_BATCH_SIZE,n._vertexCount=0,n._indexCount=0,n._bufferedElements=[],n._bufferedTextures=[],n._bufferSize=0,n._shader=null,n._packedGeometries=[],n._packedGeometryPoolSize=2,n._flushId=0,n._aBuffers={},n._iBuffers={},n.MAX_TEXTURES=1,n.renderer.on("prerender",n.onPrerender,n),e.runners.contextChange.add(n),n._dcIndex=0,n._aIndex=0,n._iIndex=0,n._attributeBuffer=null,n._indexBuffer=null,n._tempBoundTextures=[],n}return I_(e,t),e.prototype.contextChange=function(){var t=this.renderer.gl;Ad.PREFER_ENV===pf.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Ad.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=e.createShader(e.FRAGMENT_SHADER);;){var i=$g.replace(/%forloop%/gi,Yg(t));if(e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,n=e._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new Pv);for(;n.length<r;)n.push(new Nv);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,n=this.MAX_TEXTURES,i=e._textureArrayPool,r=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++L_._globalBatch,h=0,u=i[0],l=0;r.copyBoundTextures(s,n);for(var c=0;c<this._bufferSize;++c){var p=t[c];t[c]=null,p._batchEnabled!==a&&(u.count>=n&&(r.boundArray(u,s,a,n),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),p._batchEnabled=a,p.touched=o,u.elements[u.count++]=p)}u.count>0&&(r.boundArray(u,s,a,n),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(c=0;c<s.length;c++)s[c]=null;L_._globalBatch=a},e.prototype.buildDrawCalls=function(t,n,i){var r=this,s=r._bufferedElements,o=r._attributeBuffer,a=r._indexBuffer,h=r.vertexSize,u=e._drawCallPool,l=this._dcIndex,c=this._aIndex,p=this._iIndex,d=u[l];d.start=this._iIndex,d.texArray=t;for(var f=n;f<i;++f){var m=s[f],_=m._texture.baseTexture,g=Jf[_.alphaMode?1:0][m.blendMode];s[f]=null,n<f&&d.blend!==g&&(d.size=p-d.start,n=f,(d=u[++l]).texArray=t,d.start=p),this.packInterleavedGeometry(m,o,a,c,p),c+=m.vertexData.length/2*h,p+=m.indices.length,d.blend=g}n<i&&(d.size=p-d.start,++l),this._dcIndex=l,this._aIndex=c,this._iIndex=p},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this,e=t._packedGeometries,n=t._attributeBuffer,i=t._indexBuffer;Ad.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,n=this.renderer,i=n.gl,r=n.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,p=h.start,d=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=d,r.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*p)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),Ad.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=im(Math.ceil(t/8)),n=sm(e),i=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var r=this._aBuffers[i];return r||(this._aBuffers[i]=r=new Mv(i*this.vertexSize*4)),r},e.prototype.getIndexBuffer=function(t){var e=im(Math.ceil(t/12)),n=sm(e),i=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var r=this._iBuffers[n];return r||(this._iBuffers[n]=r=new Uint16Array(i)),r},e.prototype.packInterleavedGeometry=function(t,e,n,i,r){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),d=p<1&&t._texture.baseTexture.alphaMode?tm(t._tintRGB,p):t._tintRGB+(255*p<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=d,o[i++]=c;for(f=0;f<u.length;f++)n[r++]=a+u[f]},e._drawCallPool=[],e._textureArrayPool=[],e}(gg),Lv=function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=pg.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new qg(this.vertexSrc,i)}var r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Pm,default:this.defaultGroupCache[t]};return new Zg(this.programCache[t],r)},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+="if(vTextureId < "+n+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+n+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"},t}(),Fv=function(t){function e(e){void 0===e&&(e=!1);var n=t.call(this)||this;return n._buffer=new ig(null,e,!1),n._indexBuffer=new ig(null,e,!0),n.addAttribute("aVertexPosition",n._buffer,2,!1,yf.FLOAT).addAttribute("aTextureCoord",n._buffer,2,!1,yf.FLOAT).addAttribute("aColor",n._buffer,4,!0,yf.UNSIGNED_BYTE).addAttribute("aTextureId",n._buffer,1,!0,yf.FLOAT).addIndex(n._indexBuffer),n}return I_(e,t),e}(hg),Uv="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Gv="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Bv=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:Uv,fragment:Gv,geometryClass:Fv,vertexSize:6},t),n=e.vertex,i=e.fragment,r=e.vertexSize,s=e.geometryClass;return function(t){function e(e){var o=t.call(this,e)||this;return o.shaderGenerator=new Lv(n,i),o.geometryClass=s,o.vertexSize=r,o}return I_(e,t),e}(Dv)},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return Uv},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{get:function(){return Gv},enumerable:!1,configurable:!0}),t}(),kv=Bv.create(),Vv={},Xv=function(t){Object.defineProperty(Vv,t,{get:function(){return cm("6.0.0","PIXI.systems."+t+" has moved to PIXI."+t),$_[t]}})};for(var jv in $_)Xv(jv);var Hv={},$v=function(t){Object.defineProperty(Hv,t,{get:function(){return cm("6.0.0","PIXI.resources."+t+" has moved to PIXI."+t),Av[t]}})};for(var jv in Av)$v(jv);
/*!
     * @pixi/app - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/app is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */var Yv=function(){function t(e){var n=this;this.stage=new p_,e=Object.assign({forceCanvas:!1},e),this.renderer=function(t){return Ov.create(t)}(e),t._plugins.forEach((function(t){t.init.call(n,e)}))}return t.registerPlugin=function(e){t._plugins.push(e)},t.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(t.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e,n){var i=this,r=t._plugins.slice(0);r.reverse(),r.forEach((function(t){t.destroy.call(i)})),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null},t._plugins=[],t}(),Wv=function(){function t(){}return t.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame((function(){return e.resize()})))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var t,n;if(e.cancelResize(),e._resizeTo===globalThis.window)t=globalThis.innerWidth,n=globalThis.innerHeight;else{var i=e._resizeTo;t=i.clientWidth,n=i.clientHeight}e.renderer.resize(t,n)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},t.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},t}();Yv.registerPlugin(Wv);
/*!
     * @pixi/extract - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/extract is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
var zv=new Sm,qv=function(){function t(t){this.renderer=t}return t.prototype.image=function(t,e,n){var i=new Image;return i.src=this.base64(t,e,n),i},t.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},t.prototype.canvas=function(e){var n,i,r,s=this.renderer,o=!1,a=!1;e&&(e instanceof Q_?r=e:(r=this.renderer.generateTexture(e),a=!0)),r?(n=r.baseTexture.resolution,i=r.frame,o=!1,s.renderTexture.bind(r)):(n=this.renderer.resolution,o=!0,(i=zv).width=this.renderer.width,i.height=this.renderer.height,s.renderTexture.bind(null));var h=Math.floor(i.width*n+1e-4),u=Math.floor(i.height*n+1e-4),l=new _m(h,u,1),c=new Uint8Array(4*h*u),p=s.gl;p.readPixels(i.x*n,i.y*n,h,u,p.RGBA,p.UNSIGNED_BYTE,c);var d=l.context.getImageData(0,0,h,u);if(t.arrayPostDivide(c,d.data),l.context.putImageData(d,0,0),o){var f=new _m(l.width,l.height,1);f.context.scale(1,-1),f.context.drawImage(l.canvas,0,-u),l.destroy(),l=f}return a&&r.destroy(!0),l.canvas},t.prototype.pixels=function(e){var n,i,r,s=this.renderer,o=!1;e&&(e instanceof Q_?r=e:(r=this.renderer.generateTexture(e),o=!0)),r?(n=r.baseTexture.resolution,i=r.frame,s.renderTexture.bind(r)):(n=s.resolution,(i=zv).width=s.width,i.height=s.height,s.renderTexture.bind(null));var a=i.width*n,h=i.height*n,u=new Uint8Array(4*a*h),l=s.gl;return l.readPixels(i.x*n,i.y*n,a,h,l.RGBA,l.UNSIGNED_BYTE,u),o&&r.destroy(!0),t.arrayPostDivide(u,u),u},t.prototype.destroy=function(){this.renderer=null},t.arrayPostDivide=function(t,e){for(var n=0;n<t.length;n+=4){var i=e[n+3]=t[n+3];0!==i?(e[n]=Math.round(Math.min(255*t[n]/i,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/i,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/i,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}},t}(),Zv=function(){function t(t,e,n){void 0===e&&(e=!1),this._fn=t,this._once=e,this._thisArg=n,this._next=this._prev=this._owner=null}return t.prototype.detach=function(){return null!==this._owner&&(this._owner.detach(this),!0)},t}();function Kv(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var Jv=function(){function t(){this._head=this._tail=void 0}return t.prototype.handlers=function(t){void 0===t&&(t=!1);var e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n},t.prototype.has=function(t){if(!(t instanceof Zv))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},t.prototype.dispatch=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var i=this._head;if(!i)return!1;for(;i;)i._once&&this.detach(i),i._fn.apply(i._thisArg,e),i=i._next;return!0},t.prototype.add=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return Kv(this,new Zv(t,!1,e))},t.prototype.once=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return Kv(this,new Zv(t,!0,e))},t.prototype.detach=function(t){if(!(t instanceof Zv))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this},t.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},t}();function Qv(t,e){e=e||{};for(var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=n.parser[e.strictMode?"strict":"loose"].exec(t),r={},s=14;s--;)r[n.key[s]]=i[s]||"";return r[n.q.name]={},r[n.key[12]].replace(n.q.parser,(function(t,e,i){e&&(r[n.q.name][e]=i)})),r}var ty=!(!globalThis.XDomainRequest||"withCredentials"in new XMLHttpRequest),ey=null;function ny(){}function iy(t,e,n){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=n)}function ry(t){return t.toString().replace("object ","")}var sy=function(){function t(e,n,i){if(this._dequeue=ny,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,"string"!=typeof e||"string"!=typeof n)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===n.indexOf("data:")),this.name=e,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=ny,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Jv,this.onProgress=new Jv,this.onComplete=new Jv,this.onAfterMiddleware=new Jv}return t.setExtensionLoadType=function(e,n){iy(t._loadTypeMap,e,n)},t.setExtensionXhrType=function(e,n){iy(t._xhrTypeMap,e,n)},Object.defineProperty(t.prototype,"isDataUrl",{get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isComplete",{get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),t.prototype.complete=function(){this._clearEvents(),this._finish()},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.prototype.load=function(e){var n=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(n)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:ty&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t.prototype._hasFlag=function(t){return 0!=(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==globalThis.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==globalThis.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else{e=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;"use-credentials"===this.crossOrigin&&(e.withCredentials=!0),e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new globalThis.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},t.prototype._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var i=document.createElement("source");return i.src=e,i.type=n,i},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._onTimeout=function(){this.abort("Load timed out.")},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(ry(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(ry(t)+" Request timed out.")},t.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(ry(t)+" Request was aborted by the user.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,n="",i=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(n=e.responseText),0===i&&(n.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2===(i/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var r=new DOMParser;this.data=r.parseFromString(n,"text/xml")}else{var s=document.createElement("div");s.innerHTML=n,this.data=s}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||n;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";e=e||globalThis.location,ey||(ey=document.createElement("a")),ey.href=t;var n=Qv(ey.href,{strictMode:!0}),i=!n.port&&""===e.port||n.port===e.port,r=n.protocol?n.protocol+":":"";return n.host===e.hostname&&i&&r===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(t){void 0===t&&(t=this.url);var e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var i=t.indexOf("?"),r=t.indexOf("#"),s=Math.min(i>-1?i:t.length,r>-1?r:t.length);e=(t=t.substring(0,s)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},t}();function oy(){}function ay(t){return function(){for(var e=arguments,n=[],i=0;i<arguments.length;i++)n[i]=e[i];if(null===t)throw new Error("Callback was already called.");var r=t;t=null,r.apply(this,n)}}!function(t){var e,n,i,r;(e=t.STATUS_FLAGS||(t.STATUS_FLAGS={}))[e.NONE=0]="NONE",e[e.DATA_URL=1]="DATA_URL",e[e.COMPLETE=2]="COMPLETE",e[e.LOADING=4]="LOADING",(n=t.TYPE||(t.TYPE={}))[n.UNKNOWN=0]="UNKNOWN",n[n.JSON=1]="JSON",n[n.XML=2]="XML",n[n.IMAGE=3]="IMAGE",n[n.AUDIO=4]="AUDIO",n[n.VIDEO=5]="VIDEO",n[n.TEXT=6]="TEXT",(i=t.LOAD_TYPE||(t.LOAD_TYPE={}))[i.XHR=1]="XHR",i[i.IMAGE=2]="IMAGE",i[i.AUDIO=3]="AUDIO",i[i.VIDEO=4]="VIDEO",(r=t.XHR_RESPONSE_TYPE||(t.XHR_RESPONSE_TYPE={})).DEFAULT="text",r.BUFFER="arraybuffer",r.BLOB="blob",r.DOCUMENT="document",r.JSON="json",r.TEXT="text",t._loadTypeMap={gif:t.LOAD_TYPE.IMAGE,png:t.LOAD_TYPE.IMAGE,bmp:t.LOAD_TYPE.IMAGE,jpg:t.LOAD_TYPE.IMAGE,jpeg:t.LOAD_TYPE.IMAGE,tif:t.LOAD_TYPE.IMAGE,tiff:t.LOAD_TYPE.IMAGE,webp:t.LOAD_TYPE.IMAGE,tga:t.LOAD_TYPE.IMAGE,svg:t.LOAD_TYPE.IMAGE,"svg+xml":t.LOAD_TYPE.IMAGE,mp3:t.LOAD_TYPE.AUDIO,ogg:t.LOAD_TYPE.AUDIO,wav:t.LOAD_TYPE.AUDIO,mp4:t.LOAD_TYPE.VIDEO,webm:t.LOAD_TYPE.VIDEO},t._xhrTypeMap={xhtml:t.XHR_RESPONSE_TYPE.DOCUMENT,html:t.XHR_RESPONSE_TYPE.DOCUMENT,htm:t.XHR_RESPONSE_TYPE.DOCUMENT,xml:t.XHR_RESPONSE_TYPE.DOCUMENT,tmx:t.XHR_RESPONSE_TYPE.DOCUMENT,svg:t.XHR_RESPONSE_TYPE.DOCUMENT,tsx:t.XHR_RESPONSE_TYPE.DOCUMENT,gif:t.XHR_RESPONSE_TYPE.BLOB,png:t.XHR_RESPONSE_TYPE.BLOB,bmp:t.XHR_RESPONSE_TYPE.BLOB,jpg:t.XHR_RESPONSE_TYPE.BLOB,jpeg:t.XHR_RESPONSE_TYPE.BLOB,tif:t.XHR_RESPONSE_TYPE.BLOB,tiff:t.XHR_RESPONSE_TYPE.BLOB,webp:t.XHR_RESPONSE_TYPE.BLOB,tga:t.XHR_RESPONSE_TYPE.BLOB,json:t.XHR_RESPONSE_TYPE.JSON,text:t.XHR_RESPONSE_TYPE.TEXT,txt:t.XHR_RESPONSE_TYPE.TEXT,ttf:t.XHR_RESPONSE_TYPE.BUFFER,otf:t.XHR_RESPONSE_TYPE.BUFFER},t.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="}(sy||(sy={}));var hy=function(t,e){this.data=t,this.callback=e},uy=function(){function t(t,e){var n=this;if(void 0===e&&(e=1),this.workers=0,this.saturated=oy,this.unsaturated=oy,this.empty=oy,this.drain=oy,this.error=oy,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(t,e,i){if(i&&"function"!=typeof i)throw new Error("task callback must be a function");if(n.started=!0,null==t&&n.idle())setTimeout((function(){return n.drain()}),1);else{var r=new hy(t,"function"==typeof i?i:oy);e?n._tasks.unshift(r):n._tasks.push(r),setTimeout(n.process,1)}},this.process=function(){for(;!n.paused&&n.workers<n.concurrency&&n._tasks.length;){var t=n._tasks.shift();0===n._tasks.length&&n.empty(),n.workers+=1,n.workers===n.concurrency&&n.saturated(),n._worker(t.data,ay(n._next(t)))}},this._worker=t,0===e)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return t.prototype._next=function(t){var e=this;return function(){for(var n=arguments,i=[],r=0;r<arguments.length;r++)i[r]=n[r];e.workers-=1,t.callback.apply(t,i),null!=i[0]&&e.error(i[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},t.prototype.push=function(t,e){this._insert(t,!1,e)},t.prototype.kill=function(){this.workers=0,this.drain=oy,this.started=!1,this._tasks=[]},t.prototype.unshift=function(t,e){this._insert(t,!0,e)},t.prototype.length=function(){return this._tasks.length},t.prototype.running=function(){return this.workers},t.prototype.idle=function(){return this._tasks.length+this.workers===0},t.prototype.pause=function(){!0!==this.paused&&(this.paused=!0)},t.prototype.resume=function(){if(!1!==this.paused){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},t.eachSeries=function(t,e,n,i){var r=0,s=t.length;!function o(a){a||r===s?n&&n(a):i?setTimeout((function(){e(t[r++],o)}),1):e(t[r++],o)}()},t.queue=function(e,n){return new t(e,n)},t}(),ly=/(#[\w-]+)?$/,cy=function(){function t(e,n){var i=this;void 0===e&&(e=""),void 0===n&&(n=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e)},this.resources={},this.baseUrl=e,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e)},this._queue=uy.queue(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new Jv,this.onError=new Jv,this.onLoad=new Jv,this.onStart=new Jv,this.onComplete=new Jv;for(var r=0;r<t._plugins.length;++r){var s=t._plugins[r],o=s.pre,a=s.use;o&&this.pre(o),a&&this.use(a)}this._protected=!1}return t.prototype._add=function(t,e,n,i){if(this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new sy(t,e,n),"function"==typeof i&&this.resources[t].onAfterMiddleware.once(i),this.loading){for(var r=n.parentResource,s=[],o=0;o<r.children.length;++o)r.children[o].isComplete||s.push(r.children[o]);var a=r.progressChunk*(s.length+1)/(s.length+2);r.children.push(this.resources[t]),r.progressChunk=a;for(o=0;o<s.length;++o)s[o].progressChunk=a;this.resources[t].progressChunk=a}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},Object.defineProperty(t.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),t.prototype._prepareUrl=function(t){var e,n=Qv(t,{strictMode:!0});if(e=n.protocol||!n.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var i=ly.exec(e)[0];-1!==(e=e.slice(0,e.length-i.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=i}return e},t.prototype._loadResource=function(t,e){var n=this;t._dequeue=e,uy.eachSeries(this._beforeMiddleware,(function(e,i){e.call(n,t,(function(){i(t.isComplete?{}:null)}))}),(function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load())}),!0)},t.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),uy.eachSeries(this._afterMiddleware,(function(n,i){n.call(e,t,i)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},t.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(t,"shared",{get:function(){var e=t._shared;return e||((e=new t)._protected=!0,t._shared=e),e},enumerable:!1,configurable:!0}),t.registerPlugin=function(e){return t._plugins.push(e),e.add&&e.add(),t},t._plugins=[],t}();cy.prototype.add=function(t,e,n,i){if(Array.isArray(t)){for(var r=0;r<t.length;++r)this.add(t[r]);return this}if("object"==typeof t&&(n=t,i=e||n.callback||n.onComplete,e=n.url,t=n.name||n.key||n.url),"string"!=typeof e&&(i=n,n=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");return"function"==typeof n&&(i=n,n=null),this._add(t,e,n,i)};var py=function(){function t(){}return t.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?cy.shared:new cy},t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t}(),dy=function(){function t(){}return t.add=function(){sy.setExtensionLoadType("svg",sy.LOAD_TYPE.XHR),sy.setExtensionXhrType("svg",sy.XHR_RESPONSE_TYPE.TEXT)},t.use=function(t,e){if(!t.data||t.type!==sy.TYPE.IMAGE&&"svg"!==t.extension)e();else{var n=t.data,i=t.url,r=t.name,s=t.metadata;K_.fromLoader(n,i,r,s).then((function(n){t.texture=n,e()})).catch(e)}},t}();var fy,my,_y=self.URL||self.webkitURL;cy.registerPlugin({use:function(t,e){if(t.data){if(t.xhr&&t.xhrType===sy.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var n=_y.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=n,t.type=sy.TYPE.IMAGE,void(t.data.onload=function(){_y.revokeObjectURL(n),t.data.onload=null,e()})}}else{var i=t.xhr.getResponseHeader("content-type");if(i&&0===i.indexOf("image"))return t.data=new Image,t.data.src="data:"+i+";base64,"+function(t){for(var e="",n=0;n<t.length;){for(var i=[0,0,0],r=[0,0,0,0],s=0;s<i.length;++s)n<t.length?i[s]=255&t.charCodeAt(n++):i[s]=0;switch(r[0]=i[0]>>2,r[1]=(3&i[0])<<4|i[1]>>4,r[2]=(15&i[1])<<2|i[2]>>6,r[3]=63&i[2],n-(t.length-1)){case 2:r[3]=64,r[2]=64;break;case 1:r[3]=64}for(s=0;s<r.length;++s)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(r[s])}return e}(t.xhr.responseText),t.type=sy.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}}),cy.registerPlugin(dy),function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"}(my||(my={}));var gy=((fy={})[my.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,fy[my.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,fy[my.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,fy[my.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,fy[my.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,fy[my.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,fy[my.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,fy[my.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,fy[my.COMPRESSED_R11_EAC]=.5,fy[my.COMPRESSED_SIGNED_R11_EAC]=.5,fy[my.COMPRESSED_RG11_EAC]=1,fy[my.COMPRESSED_SIGNED_RG11_EAC]=1,fy[my.COMPRESSED_RGB8_ETC2]=.5,fy[my.COMPRESSED_RGBA8_ETC2_EAC]=1,fy[my.COMPRESSED_SRGB8_ETC2]=.5,fy[my.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,fy[my.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,fy[my.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,fy[my.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,fy[my.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,fy[my.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,fy[my.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,fy[my.COMPRESSED_RGB_ETC1_WEBGL]=.5,fy[my.COMPRESSED_RGB_ATC_WEBGL]=.5,fy[my.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,fy[my.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,fy),vy=function(t,e){return vy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},vy(t,e)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function yy(t,e){function n(){this.constructor=t}vy(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Ty(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var Ey,by,xy=function(t){function e(e,n){void 0===n&&(n={width:1,height:1,autoLoad:!0});var i,r,s=this;return"string"==typeof e?(i=e,r=new Uint8Array):(i=null,r=e),(s=t.call(this,r,n)||this).origin=i,s.buffer=r?new Mv(r):null,s.origin&&!1!==n.autoLoad&&s.load(),r&&r.length&&(s.loaded=!0,s.onBlobLoaded(s.buffer.rawBinaryData)),s}return yy(e,t),e.prototype.onBlobLoaded=function(t){},e.prototype.load=function(){return t=this,e=void 0,i=function(){var t;return Ty(this,(function(e){switch(e.label){case 0:return[4,fetch(this.origin)];case 1:return[4,e.sent().blob()];case 2:return[4,e.sent().arrayBuffer()];case 3:return t=e.sent(),this.data=new Uint32Array(t),this.buffer=new Mv(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),[2,this]}}))},new((n=Promise)||(n=Promise))((function(r,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function a(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(o,a)}h((i=i.apply(t,e||[])).next())}));var t,e,n,i},e}(M_),Ay=function(t){function e(n,i){var r=t.call(this,n,i)||this;return r.format=i.format,r.levels=i.levels||1,r._width=i.width,r._height=i.height,r._extension=e._formatToExtension(r.format),(i.levelBuffers||r.buffer)&&(r._levelBuffers=i.levelBuffers||e._createLevelBuffers(n instanceof Uint8Array?n:r.buffer.uint8View,r.format,r.levels,4,4,r.width,r.height)),r}return yy(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;if(!t.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var r=0,s=this.levels;r<s;r++){var o=this._levelBuffers[r],a=o.levelID,h=o.levelWidth,u=o.levelHeight,l=o.levelBuffer;i.compressedTexImage2D(i.TEXTURE_2D,a,this.format,h,u,0,l)}return!0},e.prototype.onBlobLoaded=function(){this._levelBuffers=e._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},e._formatToExtension=function(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},e._createLevelBuffers=function(t,e,n,i,r,s,o){for(var a=new Array(n),h=t.byteOffset,u=s,l=o,c=u+i-1&~(i-1),p=l+r-1&~(r-1),d=c*p*gy[e],f=0;f<n;f++)a[f]={levelID:f,levelWidth:n>1?u:c,levelHeight:n>1?l:p,levelBuffer:new Uint8Array(t.buffer,h,d)},h+=d,d=(c=(u=u>>1||1)+i-1&~(i-1))*(p=(l=l>>1||1)+r-1&~(r-1))*gy[e];return a},e}(xy),Sy=function(){function t(){}return t.use=function(e,n){var i=e.data;if(e.type===sy.TYPE.JSON&&i&&i.cacheID&&i.textures){for(var r=i.textures,s=void 0,o=void 0,a=0,h=r.length;a<h;a++){var u=r[a],l=u.src,c=u.format;if(c||(o=l),t.textureFormats[c]){s=l;break}}if(!(s=s||o))return void n(new Error("Cannot load compressed-textures in "+e.url+", make sure you provide a fallback"));if(s===e.url)return void n(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var p={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},d=$f.resolve(e.url.replace(this.baseUrl,""),s),f=i.cacheID;this.add(f,d,p,(function(t){if(t.error)n(t.error);else{var i=t.texture,r=void 0===i?null:i,s=t.textures,o=void 0===s?{}:s;Object.assign(e,{texture:r,textures:o}),n()}}))}else n()},t.add=function(){var e=document.createElement("canvas").getContext("webgl");if(e){var n={s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};for(var i in t.textureExtensions=n,t.textureFormats={},n){var r=n[i];r&&Object.assign(t.textureFormats,Object.getPrototypeOf(r))}}else console.warn("WebGL not available for compressed textures. Silently failing.")},t}();function wy(t,e,n){var i={textures:{},texture:null};return e?(e.map((function(t){return new K_(new L_(t,Object.assign({mipmap:xf.OFF,alphaMode:Af.NO_PREMULTIPLIED_ALPHA},n)))})).forEach((function(e,n){var r=e.baseTexture,s=t+"-"+(n+1);L_.addToCache(r,s),K_.addToCache(e,s),0===n&&(L_.addToCache(r,t),K_.addToCache(e,t),i.texture=e),i.textures[s]=e})),i):i}sy.setExtensionXhrType("dds",sy.XHR_RESPONSE_TYPE.BUFFER);var Ry,Cy,Oy=124,Iy=3,Py=4,Ny=7,My=19,Dy=2,Ly=0,Fy=1,Uy=2,Gy=3;!function(t){t[t.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",t[t.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",t[t.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",t[t.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",t[t.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",t[t.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",t[t.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",t[t.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",t[t.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",t[t.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",t[t.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",t[t.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",t[t.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",t[t.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",t[t.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",t[t.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",t[t.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",t[t.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",t[t.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",t[t.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",t[t.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",t[t.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",t[t.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",t[t.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",t[t.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",t[t.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",t[t.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",t[t.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",t[t.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",t[t.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",t[t.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",t[t.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",t[t.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",t[t.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",t[t.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",t[t.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",t[t.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",t[t.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",t[t.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",t[t.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",t[t.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",t[t.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",t[t.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",t[t.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",t[t.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",t[t.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",t[t.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",t[t.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",t[t.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",t[t.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",t[t.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",t[t.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",t[t.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",t[t.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",t[t.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",t[t.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",t[t.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",t[t.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",t[t.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",t[t.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",t[t.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",t[t.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",t[t.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",t[t.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",t[t.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",t[t.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",t[t.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",t[t.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",t[t.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",t[t.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",t[t.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",t[t.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",t[t.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",t[t.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",t[t.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",t[t.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",t[t.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",t[t.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",t[t.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",t[t.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",t[t.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",t[t.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",t[t.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",t[t.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",t[t.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",t[t.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",t[t.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",t[t.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",t[t.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",t[t.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",t[t.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",t[t.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",t[t.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",t[t.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",t[t.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",t[t.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",t[t.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",t[t.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",t[t.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",t[t.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",t[t.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",t[t.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",t[t.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",t[t.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",t[t.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",t[t.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",t[t.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",t[t.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",t[t.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",t[t.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",t[t.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",t[t.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"}(Ry||(Ry={})),function(t){t[t.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",t[t.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",t[t.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(Cy||(Cy={}));var By,ky,Vy,Xy=((Ey={})[827611204]=my.COMPRESSED_RGBA_S3TC_DXT1_EXT,Ey[861165636]=my.COMPRESSED_RGBA_S3TC_DXT3_EXT,Ey[894720068]=my.COMPRESSED_RGBA_S3TC_DXT5_EXT,Ey),jy=((by={})[Ry.DXGI_FORMAT_BC1_TYPELESS]=my.COMPRESSED_RGBA_S3TC_DXT1_EXT,by[Ry.DXGI_FORMAT_BC1_UNORM]=my.COMPRESSED_RGBA_S3TC_DXT1_EXT,by[Ry.DXGI_FORMAT_BC2_TYPELESS]=my.COMPRESSED_RGBA_S3TC_DXT3_EXT,by[Ry.DXGI_FORMAT_BC2_UNORM]=my.COMPRESSED_RGBA_S3TC_DXT3_EXT,by[Ry.DXGI_FORMAT_BC3_TYPELESS]=my.COMPRESSED_RGBA_S3TC_DXT5_EXT,by[Ry.DXGI_FORMAT_BC3_UNORM]=my.COMPRESSED_RGBA_S3TC_DXT5_EXT,by[Ry.DXGI_FORMAT_BC1_UNORM_SRGB]=my.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,by[Ry.DXGI_FORMAT_BC2_UNORM_SRGB]=my.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,by[Ry.DXGI_FORMAT_BC3_UNORM_SRGB]=my.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,by),Hy=function(){function t(){}return t.use=function(e,n){if("dds"===e.extension&&e.data)try{Object.assign(e,wy(e.name||e.url,t.parse(e.data),e.metadata))}catch(t){return void n(t)}n()},t.parse=function(t){var e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");var n=new Uint32Array(t,0,Oy/Uint32Array.BYTES_PER_ELEMENT),i=n[Iy],r=n[Py],s=n[Ny],o=new Uint32Array(t,My*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),a=o[1];if(4&a){var h=o[Dy];if(808540228!==h){var u=Xy[h],l=new Uint8Array(t,128);return[new Ay(l,{format:u,width:r,height:i,levels:s})]}var c=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),p=c[Ly],d=c[Fy],f=c[Uy],m=c[Gy],_=jy[p];if(void 0===_)throw new Error("DDSLoader cannot parse texture data with DXGI format "+p);if(4===f)throw new Error("DDSLoader does not support cubemap textures");if(d===Cy.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var g=new Array;if(1===m)g.push(new Uint8Array(t,148));else{for(var v=gy[_],y=0,T=r,E=i,b=0;b<s;b++){y+=Math.max(1,T+3&-4)*Math.max(1,E+3&-4)*v,T>>>=1,E>>>=1}var x=148;for(b=0;b<m;b++)g.push(new Uint8Array(t,x,y)),x+=y}return g.map((function(t){return new Ay(t,{format:_,width:r,height:i,levels:s})}))}if(64&a)throw new Error("DDSLoader does not support uncompressed texture data.");if(512&a)throw new Error("DDSLoader does not supported YUV uncompressed texture data.");if(131072&a)throw new Error("DDSLoader does not support single-channel (lumninance) texture data!");if(2&a)throw new Error("DDSLoader does not support single-channel (alpha) texture data!");throw new Error("DDSLoader failed to load a texture file due to an unknown reason!")},t}();sy.setExtensionXhrType("ktx",sy.XHR_RESPONSE_TYPE.BUFFER);var $y=[171,75,84,88,32,49,49,187,13,10,26,10],Yy=12,Wy=16,zy=24,qy=28,Zy=36,Ky=40,Jy=44,Qy=48,tT=52,eT=56,nT=60,iT=((By={})[yf.UNSIGNED_BYTE]=1,By[yf.UNSIGNED_SHORT]=2,By[yf.INT]=4,By[yf.UNSIGNED_INT]=4,By[yf.FLOAT]=4,By[yf.HALF_FLOAT]=8,By),rT=((ky={})[gf.RGBA]=4,ky[gf.RGB]=3,ky[gf.RG]=2,ky[gf.RED]=1,ky[gf.LUMINANCE]=1,ky[gf.LUMINANCE_ALPHA]=2,ky[gf.ALPHA]=1,ky),sT=((Vy={})[yf.UNSIGNED_SHORT_4_4_4_4]=2,Vy[yf.UNSIGNED_SHORT_5_5_5_1]=2,Vy[yf.UNSIGNED_SHORT_5_6_5]=2,Vy),oT=function(){function t(){}return t.use=function(e,n){if("ktx"===e.extension&&e.data)try{var i=e.name||e.url,r=t.parse(i,e.data),s=r.compressed,o=r.uncompressed;if(s)Object.assign(e,wy(i,s,e.metadata));else if(o){var a={};o.forEach((function(t,e){var n=new K_(new L_(t.resource,{mipmap:xf.OFF,alphaMode:Af.NO_PREMULTIPLIED_ALPHA,type:t.type,format:t.format})),r=i+"-"+(e+1);L_.addToCache(n.baseTexture,r),K_.addToCache(n,r),0===e&&(a[i]=n,L_.addToCache(n.baseTexture,i),K_.addToCache(n,i)),a[r]=n})),Object.assign(e,{textures:a})}}catch(t){return void n(t)}n()},t.parse=function(e,n){var i=new DataView(n);if(!t.validate(e,i))return null;var r=67305985===i.getUint32(Yy,!0),s=i.getUint32(Wy,r),o=i.getUint32(zy,r),a=i.getUint32(qy,r),h=i.getUint32(Zy,r),u=i.getUint32(Ky,r)||1,l=i.getUint32(Jy,r)||1,c=i.getUint32(Qy,r)||1,p=i.getUint32(tT,r),d=i.getUint32(eT,r),f=i.getUint32(nT,r);if(0===u||1!==l)throw new Error("Only 2D textures are supported");if(1!==p)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==c)throw new Error("WebGL does not support array textures");var m,_=h+3&-4,g=u+3&-4,v=new Array(c),y=h*u;if(0===s&&(y=_*g),void 0===(m=0!==s?iT[s]?iT[s]*rT[o]:sT[s]:gy[a]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var T=y*m,E=h,b=u,x=_,A=g,S=64+f,w=0;w<d;w++){for(var R=i.getUint32(S,r),C=S+4,O=0;O<c;O++){var I=v[O];I||(I=v[O]=new Array(d)),I[w]={levelID:w,levelWidth:d>1||0!==s?E:x,levelHeight:d>1||0!==s?b:A,levelBuffer:new Uint8Array(n,C,T)},C+=T}S=(S+=R+4)%4!=0?S+4-S%4:S,T=(x=(E=E>>1||1)+4-1&-4)*(A=(b=b>>1||1)+4-1&-4)*m}return 0!==s?{uncompressed:v.map((function(e){var n=e[0].levelBuffer,i=!1;return s===yf.FLOAT?n=new Float32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4):s===yf.UNSIGNED_INT?(i=!0,n=new Uint32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)):s===yf.INT&&(i=!0,n=new Int32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)),{resource:new M_(n,{width:e[0].levelWidth,height:e[0].levelHeight}),type:s,format:i?t.convertFormatToInteger(o):o}}))}:{compressed:v.map((function(t){return new Ay(null,{format:a,width:h,height:u,levels:d,levelBuffers:t})}))}},t.validate=function(t,e){for(var n=0;n<$y.length;n++)if(e.getUint8(n)!==$y[n])return console.error(t+" is not a valid *.ktx file!"),!1;return!0},t.convertFormatToInteger=function(t){switch(t){case gf.RGBA:return gf.RGBA_INTEGER;case gf.RGB:return gf.RGB_INTEGER;case gf.RG:return gf.RG_INTEGER;case gf.RED:return gf.RED_INTEGER;default:return t}},t}(),aT=function(t,e){return aT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},aT(t,e)};function hT(t,e){function n(){this.constructor=t}aT(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}!function(t){function e(e,n,i,r){void 0===e&&(e=1500),void 0===i&&(i=16384),void 0===r&&(r=!1);var s=t.call(this)||this;return i>16384&&(i=16384),s._properties=[!1,!0,!1,!1,!1],s._maxSize=e,s._batchSize=i,s._buffers=null,s._bufferUpdateIDs=[],s._updateID=0,s.interactiveChildren=!1,s.blendMode=mf.NORMAL,s.autoResize=r,s.roundPixels=!0,s.baseTexture=null,s.setProperties(n),s._tint=0,s.tintRgb=new Float32Array(4),s.tint=16777215,s}hT(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,qf(t,this.tintRgb)},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}(p_);var uT,lT,cT=function(){function t(t,e,n){this.geometry=new hg,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<t.length;++i){var r=t[i];r={attributeName:r.attributeName,size:r.size,uploadFunction:r.uploadFunction,type:r.type||yf.FLOAT,offset:r.offset},e[i]?this.dynamicProperties.push(r):this.staticProperties.push(r)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new ig(function(t,e){void 0===e&&(e=null);var n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+n);for(var i=0,r=0;i<n;i+=6,r+=4)e[i+0]=r+0,e[i+1]=r+1,e[i+2]=r+2,e[i+3]=r+0,e[i+4]=r+2,e[i+5]=r+3;return e}(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n){(o=this.dynamicProperties[n]).offset=e,e+=o.size,this.dynamicStride+=o.size}var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new ig(this.dynamicData,!1,!1);var r=0;this.staticStride=0;for(n=0;n<this.staticProperties.length;++n){(o=this.staticProperties[n]).offset=r,r+=o.size,this.staticStride+=o.size}var s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new ig(this.staticData,!0,!1);for(n=0;n<this.dynamicProperties.length;++n){var o=this.dynamicProperties[n];t.addAttribute(o.attributeName,this.dynamicBuffer,0,o.type===yf.UNSIGNED_BYTE,o.type,4*this.dynamicStride,4*o.offset)}for(n=0;n<this.staticProperties.length;++n){o=this.staticProperties[n];t.addAttribute(o.attributeName,this.staticBuffer,0,o.type===yf.UNSIGNED_BYTE,o.type,4*this.staticStride,4*o.offset)}},t.prototype.uploadDynamic=function(t,e,n){for(var i=0;i<this.dynamicProperties.length;i++){var r=this.dynamicProperties[i];r.uploadFunction(t,e,n,r.type===yf.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,r.offset)}this.dynamicBuffer._updateID++},t.prototype.uploadStatic=function(t,e,n){for(var i=0;i<this.staticProperties.length;i++){var r=this.staticProperties[i];r.uploadFunction(t,e,n,r.type===yf.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,r.offset)}this.staticBuffer._updateID++},t.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},t}(),pT=function(t){function e(e){var n=t.call(this,e)||this;return n.shader=null,n.properties=null,n.tempMatrix=new Pm,n.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:n.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:n.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:n.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:n.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:yf.UNSIGNED_BYTE,uploadFunction:n.uploadTint,offset:0}],n.shader=Zg.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),n.state=Kg.for2d(),n}return hT(e,t),e.prototype.render=function(t){var e=t.children,n=t._maxSize,i=t._batchSize,r=this.renderer,s=e.length;if(0!==s){s>n&&!t.autoResize&&(s=n);var o=t._buffers;o||(o=t._buffers=this.generateBuffers(t));var a=e[0]._texture.baseTexture;this.state.blendMode=Qf(t.blendMode,a.alphaMode),r.state.set(this.state);var h,u,l,c,p=r.gl,d=t.worldTransform.copyTo(this.tempMatrix);d.prepend(r.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=(h=t.tintRgb,u=t.worldAlpha,l=this.shader.uniforms.uColor,c=a.alphaMode,l=l||new Float32Array(4),c||void 0===c?(l[0]=h[0]*u,l[1]=h[1]*u,l[2]=h[2]*u):(l[0]=h[0],l[1]=h[1],l[2]=h[2]),l[3]=u,l),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);for(var f=!1,m=0,_=0;m<s;m+=i,_+=1){var g=s-m;g>i&&(g=i),_>=o.length&&o.push(this._generateOneMoreBuffer(t));var v=o[_];v.uploadDynamic(e,m,g);var y=t._bufferUpdateIDs[_]||0;(f=f||v._updateID<y)&&(v._updateID=t._updateID,v.uploadStatic(e,m,g)),r.geometry.bind(v.geometry),p.drawElements(p.TRIANGLES,6*g,p.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var e=[],n=t._maxSize,i=t._batchSize,r=t._properties,s=0;s<n;s+=i)e.push(new cT(this.properties,r,i));return e},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,n=t._properties;return new cT(this.properties,n,e)},e.prototype.uploadVertices=function(t,e,n,i,r,s){for(var o=0,a=0,h=0,u=0,l=0;l<n;++l){var c=t[e+l],p=c._texture,d=c.scale.x,f=c.scale.y,m=p.trim,_=p.orig;m?(o=(a=m.x-c.anchor.x*_.width)+m.width,h=(u=m.y-c.anchor.y*_.height)+m.height):(o=_.width*(1-c.anchor.x),a=_.width*-c.anchor.x,h=_.height*(1-c.anchor.y),u=_.height*-c.anchor.y),i[s]=a*d,i[s+1]=u*f,i[s+r]=o*d,i[s+r+1]=u*f,i[s+2*r]=o*d,i[s+2*r+1]=h*f,i[s+3*r]=a*d,i[s+3*r+1]=h*f,s+=4*r}},e.prototype.uploadPosition=function(t,e,n,i,r,s){for(var o=0;o<n;o++){var a=t[e+o].position;i[s]=a.x,i[s+1]=a.y,i[s+r]=a.x,i[s+r+1]=a.y,i[s+2*r]=a.x,i[s+2*r+1]=a.y,i[s+3*r]=a.x,i[s+3*r+1]=a.y,s+=4*r}},e.prototype.uploadRotation=function(t,e,n,i,r,s){for(var o=0;o<n;o++){var a=t[e+o].rotation;i[s]=a,i[s+r]=a,i[s+2*r]=a,i[s+3*r]=a,s+=4*r}},e.prototype.uploadUvs=function(t,e,n,i,r,s){for(var o=0;o<n;++o){var a=t[e+o]._texture._uvs;a?(i[s]=a.x0,i[s+1]=a.y0,i[s+r]=a.x1,i[s+r+1]=a.y1,i[s+2*r]=a.x2,i[s+2*r+1]=a.y2,i[s+3*r]=a.x3,i[s+3*r+1]=a.y3,s+=4*r):(i[s]=0,i[s+1]=0,i[s+r]=0,i[s+r+1]=0,i[s+2*r]=0,i[s+2*r+1]=0,i[s+3*r]=0,i[s+3*r+1]=0,s+=4*r)}},e.prototype.uploadTint=function(t,e,n,i,r,s){for(var o=0;o<n;++o){var a=t[e+o],h=a._texture.baseTexture.alphaMode>0,u=a.alpha,l=u<1&&h?tm(a._tintRGB,u):a._tintRGB+(255*u<<24);i[s]=l,i[s+r]=l,i[s+2*r]=l,i[s+3*r]=l,s+=4*r}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e}(gg);!function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"}(uT||(uT={})),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(lT||(lT={}));var dT={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},fT=function(){function t(){this.color=16777215,this.alpha=1,this.texture=K_.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=K_.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),mT=function(t,e){return mT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},mT(t,e)};function _T(t,e){function n(){this.constructor=t}mT(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function gT(t,e){var n,i;void 0===e&&(e=!1);var r=t.length;if(!(r<6)){for(var s=0,o=0,a=t[r-2],h=t[r-1];o<r;o+=2){var u=t[o],l=t[o+1];s+=(u-a)*(l+h),a=u,h=l}if(!e&&s>0||e&&s<=0){var c=r/2;for(o=c+c%2;o<r;o+=2){var p=r-o-2,d=r-o-1,f=o,m=o+1;n=[t[f],t[p]],t[p]=n[0],t[f]=n[1],i=[t[m],t[d]],t[d]=i[0],t[m]=i[1]}}}}var vT={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var n=t.points,i=t.holes,r=e.points,s=e.indices;if(n.length>=6){gT(n,!1);for(var o=[],a=0;a<i.length;a++){var h=i[a];gT(h.points,!0),o.push(n.length/2),n=n.concat(h.points)}var u=tf(n,o,2);if(!u)return;var l=r.length/2;for(a=0;a<u.length;a+=3)s.push(u[a]+l),s.push(u[a+1]+l),s.push(u[a+2]+l);for(a=0;a<n.length;a++)r.push(n[a])}}},yT={build:function(t){var e,n,i,r,s,o,a=t.points;if(t.type===ym.CIRC){var h=t.shape;e=h.x,n=h.y,s=o=h.radius,i=r=0}else if(t.type===ym.ELIP){var u=t.shape;e=u.x,n=u.y,s=u.width,o=u.height,i=r=0}else{var l=t.shape,c=l.width/2,p=l.height/2;e=l.x+c,n=l.y+p,i=c-(s=o=Math.max(0,Math.min(l.radius,Math.min(c,p)))),r=p-o}var d=Math.ceil(2.3*Math.sqrt(s+o)),f=8*d+(i?4:0)+(r?4:0);if(a.length=f,0!==f){if(0===d)return a.length=8,a[0]=a[6]=e+i,a[1]=a[3]=n+r,a[2]=a[4]=e-i,void(a[5]=a[7]=n-r);var m=0,_=4*d+(i?2:0)+2,g=_,v=f,y=e+(S=i+s),T=e-S,E=n+(w=r);if(a[m++]=y,a[m++]=E,a[--_]=E,a[--_]=T,r){var b=n-w;a[g++]=T,a[g++]=b,a[--v]=b,a[--v]=y}for(var x=1;x<d;x++){var A=Math.PI/2*(x/d);y=e+(S=i+Math.cos(A)*s),T=e-S,E=n+(w=r+Math.sin(A)*o),b=n-w;a[m++]=y,a[m++]=E,a[--_]=E,a[--_]=T,a[g++]=T,a[g++]=b,a[--v]=b,a[--v]=y}var S,w;y=e+(S=i),T=e-S,E=n+(w=r+o),b=n-w;a[m++]=y,a[m++]=E,a[--v]=b,a[--v]=y,i&&(a[m++]=T,a[m++]=E,a[--v]=b,a[--v]=T)}},triangulate:function(t,e){var n,i,r=t.points,s=e.points,o=e.indices,a=s.length/2,h=a;if(t.type!==ym.RREC){var u=t.shape;n=u.x,i=u.y}else{var l=t.shape;n=l.x+l.width/2,i=l.y+l.height/2}var c=t.matrix;s.push(t.matrix?c.a*n+c.c*i+c.tx:n,t.matrix?c.b*n+c.d*i+c.ty:i),a++,s.push(r[0],r[1]);for(var p=2;p<r.length;p+=2)s.push(r[p],r[p+1]),o.push(a++,h,a);o.push(h+1,h,a)}};function TT(t,e,n){return t+(e-t)*n}function ET(t,e,n,i,r,s,o){void 0===o&&(o=[]);for(var a=o,h=0,u=0,l=0,c=0,p=0,d=0,f=0,m=0;f<=20;++f)h=TT(t,n,m=f/20),u=TT(e,i,m),l=TT(n,r,m),c=TT(i,s,m),p=TT(h,l,m),d=TT(u,c,m),0===f&&a[a.length-2]===p&&a[a.length-1]===d||a.push(p,d);return a}var bT={build:function(t){if(VT.nextRoundedRectBehavior)yT.build(t);else{var e=t.shape,n=t.points,i=e.x,r=e.y,s=e.width,o=e.height,a=Math.max(0,Math.min(e.radius,Math.min(s,o)/2));n.length=0,a?(ET(i,r+a,i,r,i+a,r,n),ET(i+s-a,r,i+s,r,i+s,r+a,n),ET(i+s,r+o-a,i+s,r+o,i+s-a,r+o,n),ET(i+a,r+o,i,r+o,i,r+o-a,n)):n.push(i,r,i+s,r,i+s,r+o,i,r+o)}},triangulate:function(t,e){if(VT.nextRoundedRectBehavior)yT.triangulate(t,e);else{for(var n=t.points,i=e.points,r=e.indices,s=i.length/2,o=tf(n,null,2),a=0,h=o.length;a<h;a+=3)r.push(o[a]+s),r.push(o[a+1]+s),r.push(o[a+2]+s);for(a=0,h=n.length;a<h;a++)i.push(n[a],n[++a])}}};function xT(t,e,n,i,r,s,o,a){var h,u;o?(h=i,u=-n):(h=-i,u=n);var l=t-n*r+h,c=e-i*r+u,p=t+n*s+h,d=e+i*s+u;return a.push(l,c),a.push(p,d),2}function AT(t,e,n,i,r,s,o,a){var h=n-t,u=i-e,l=Math.atan2(h,u),c=Math.atan2(r-t,s-e);a&&l<c?l+=2*Math.PI:!a&&l>c&&(c+=2*Math.PI);var p=l,d=c-l,f=Math.abs(d),m=Math.sqrt(h*h+u*u),_=1+(15*f*Math.sqrt(m)/Math.PI>>0),g=d/_;if(p+=g,a){o.push(t,e),o.push(n,i);for(var v=1,y=p;v<_;v++,y+=g)o.push(t,e),o.push(t+Math.sin(y)*m,e+Math.cos(y)*m);o.push(t,e),o.push(r,s)}else{o.push(n,i),o.push(t,e);for(v=1,y=p;v<_;v++,y+=g)o.push(t+Math.sin(y)*m,e+Math.cos(y)*m),o.push(t,e);o.push(r,s),o.push(t,e)}return 2*_}function ST(t,e){t.lineStyle.native?function(t,e){var n=0,i=t.shape,r=t.points||i.points,s=i.type!==ym.POLY||i.closeStroke;if(0!==r.length){var o=e.points,a=e.indices,h=r.length/2,u=o.length/2,l=u;for(o.push(r[0],r[1]),n=1;n<h;n++)o.push(r[2*n],r[2*n+1]),a.push(l,l+1),l++;s&&a.push(l,u)}}(t,e):function(t,e){var n=t.shape,i=t.points||n.points.slice(),r=e.closePointEps;if(0!==i.length){var s=t.lineStyle,o=new xm(i[0],i[1]),a=new xm(i[i.length-2],i[i.length-1]),h=n.type!==ym.POLY||n.closeStroke,u=Math.abs(o.x-a.x)<r&&Math.abs(o.y-a.y)<r;if(h){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));var l=.5*(o.x+a.x),c=.5*(a.y+o.y);i.unshift(l,c),i.push(l,c)}var p=e.points,d=i.length/2,f=i.length,m=p.length/2,_=s.width/2,g=_*_,v=s.miterLimit*s.miterLimit,y=i[0],T=i[1],E=i[2],b=i[3],x=0,A=0,S=-(T-b),w=y-E,R=0,C=0,O=Math.sqrt(S*S+w*w);S/=O,w/=O,S*=_,w*=_;var I=s.alignment,P=2*(1-I),N=2*I;h||(s.cap===lT.ROUND?f+=AT(y-S*(P-N)*.5,T-w*(P-N)*.5,y-S*P,T-w*P,y+S*N,T+w*N,p,!0)+2:s.cap===lT.SQUARE&&(f+=xT(y,T,S,w,P,N,!0,p))),p.push(y-S*P,T-w*P),p.push(y+S*N,T+w*N);for(var M=1;M<d-1;++M){y=i[2*(M-1)],T=i[2*(M-1)+1],E=i[2*M],b=i[2*M+1],x=i[2*(M+1)],A=i[2*(M+1)+1],S=-(T-b),w=y-E,S/=O=Math.sqrt(S*S+w*w),w/=O,S*=_,w*=_,R=-(b-A),C=E-x,R/=O=Math.sqrt(R*R+C*C),C/=O,R*=_,C*=_;var D=E-y,L=T-b,F=E-x,U=A-b,G=L*F-U*D,B=G<0;if(Math.abs(G)<.1)p.push(E-S*P,b-w*P),p.push(E+S*N,b+w*N);else{var k=(-S+y)*(-w+b)-(-S+E)*(-w+T),V=(-R+x)*(-C+b)-(-R+E)*(-C+A),X=(D*V-F*k)/G,j=(U*k-L*V)/G,H=(X-E)*(X-E)+(j-b)*(j-b),$=E+(X-E)*P,Y=b+(j-b)*P,W=E-(X-E)*N,z=b-(j-b)*N,q=B?P:N;H<=Math.min(D*D+L*L,F*F+U*U)+q*q*g?s.join===uT.BEVEL||H/g>v?(B?(p.push($,Y),p.push(E+S*N,b+w*N),p.push($,Y),p.push(E+R*N,b+C*N)):(p.push(E-S*P,b-w*P),p.push(W,z),p.push(E-R*P,b-C*P),p.push(W,z)),f+=2):s.join===uT.ROUND?B?(p.push($,Y),p.push(E+S*N,b+w*N),f+=AT(E,b,E+S*N,b+w*N,E+R*N,b+C*N,p,!0)+4,p.push($,Y),p.push(E+R*N,b+C*N)):(p.push(E-S*P,b-w*P),p.push(W,z),f+=AT(E,b,E-S*P,b-w*P,E-R*P,b-C*P,p,!1)+4,p.push(E-R*P,b-C*P),p.push(W,z)):(p.push($,Y),p.push(W,z)):(p.push(E-S*P,b-w*P),p.push(E+S*N,b+w*N),s.join===uT.BEVEL||H/g>v||(s.join===uT.ROUND?f+=B?AT(E,b,E+S*N,b+w*N,E+R*N,b+C*N,p,!0)+2:AT(E,b,E-S*P,b-w*P,E-R*P,b-C*P,p,!1)+2:(B?(p.push(W,z),p.push(W,z)):(p.push($,Y),p.push($,Y)),f+=2)),p.push(E-R*P,b-C*P),p.push(E+R*N,b+C*N),f+=2)}}y=i[2*(d-2)],T=i[2*(d-2)+1],E=i[2*(d-1)],S=-(T-(b=i[2*(d-1)+1])),w=y-E,S/=O=Math.sqrt(S*S+w*w),w/=O,S*=_,w*=_,p.push(E-S*P,b-w*P),p.push(E+S*N,b+w*N),h||(s.cap===lT.ROUND?f+=AT(E-S*(P-N)*.5,b-w*(P-N)*.5,E-S*P,b-w*P,E+S*N,b+w*N,p,!1)+2:s.cap===lT.SQUARE&&(f+=xT(E,b,S,w,P,N,!1,p)));var Z=e.indices,K=dT.epsilon*dT.epsilon;for(M=m;M<f+m-2;++M)y=p[2*M],T=p[2*M+1],E=p[2*(M+1)],b=p[2*(M+1)+1],x=p[2*(M+2)],A=p[2*(M+2)+1],Math.abs(y*(b-A)+E*(A-T)+x*(T-b))<K||Z.push(M,M+1,M+2)}}(t,e)}var wT,RT=function(){function t(){}return t.curveTo=function(t,e,n,i,r,s){var o=s[s.length-2],a=s[s.length-1]-e,h=o-t,u=i-e,l=n-t,c=Math.abs(a*l-h*u);if(c<1e-8||0===r)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var p=a*a+h*h,d=u*u+l*l,f=a*u+h*l,m=r*Math.sqrt(p)/c,_=r*Math.sqrt(d)/c,g=m*f/p,v=_*f/d,y=m*l+_*h,T=m*u+_*a,E=h*(_+g),b=a*(_+g),x=l*(m+v),A=u*(m+v);return{cx:y+t,cy:T+e,radius:r,startAngle:Math.atan2(b-T,E-y),endAngle:Math.atan2(A-T,x-y),anticlockwise:h*u>l*a}},t.arc=function(t,e,n,i,r,s,o,a,h){for(var u=o-s,l=dT._segmentsCount(Math.abs(u)*r,40*Math.ceil(Math.abs(u)/Tm)),c=u/(2*l),p=2*c,d=Math.cos(c),f=Math.sin(c),m=l-1,_=m%1/m,g=0;g<=m;++g){var v=c+s+p*(g+_*g),y=Math.cos(v),T=-Math.sin(v);h.push((d*y+f*T)*r+n,(d*-T+f*y)*r+i)}},t}(),CT=function(){function t(){}return t.curveLength=function(t,e,n,i,r,s,o,a){for(var h=0,u=0,l=0,c=0,p=0,d=0,f=0,m=0,_=0,g=0,v=0,y=t,T=e,E=1;E<=10;++E)g=y-(m=(f=(d=(p=1-(u=E/10))*p)*p)*t+3*d*u*n+3*p*(l=u*u)*r+(c=l*u)*o),v=T-(_=f*e+3*d*u*i+3*p*l*s+c*a),y=m,T=_,h+=Math.sqrt(g*g+v*v);return h},t.curveTo=function(e,n,i,r,s,o,a){var h=a[a.length-2],u=a[a.length-1];a.length-=2;var l=dT._segmentsCount(t.curveLength(h,u,e,n,i,r,s,o)),c=0,p=0,d=0,f=0,m=0;a.push(h,u);for(var _=1,g=0;_<=l;++_)d=(p=(c=1-(g=_/l))*c)*c,m=(f=g*g)*g,a.push(d*h+3*p*g*e+3*c*f*i+m*s,d*u+3*p*g*n+3*c*f*r+m*o)},t}(),OT=function(){function t(){}return t.curveLength=function(t,e,n,i,r,s){var o=t-2*n+r,a=e-2*i+s,h=2*n-2*t,u=2*i-2*e,l=4*(o*o+a*a),c=4*(o*h+a*u),p=h*h+u*u,d=2*Math.sqrt(l+c+p),f=Math.sqrt(l),m=2*l*f,_=2*Math.sqrt(p),g=c/f;return(m*d+f*c*(d-_)+(4*p*l-c*c)*Math.log((2*f+g+d)/(g+_)))/(4*m)},t.curveTo=function(e,n,i,r,s){for(var o=s[s.length-2],a=s[s.length-1],h=dT._segmentsCount(t.curveLength(o,a,e,n,i,r)),u=0,l=0,c=1;c<=h;++c){var p=c/h;u=o+(e-o)*p,l=a+(n-a)*p,s.push(u+(e+(i-e)*p-u)*p,l+(n+(r-n)*p-l)*p)}},t}(),IT=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),PT=((wT={})[ym.POLY]=vT,wT[ym.CIRC]=yT,wT[ym.ELIP]=yT,wT[ym.RECT]={build:function(t){var e=t.shape,n=e.x,i=e.y,r=e.width,s=e.height,o=t.points;o.length=0,o.push(n,i,n+r,i,n+r,i+s,n,i+s)},triangulate:function(t,e){var n=t.points,i=e.points,r=i.length/2;i.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},wT[ym.RREC]=bT,wT),NT=[],MT=[],DT=function(){function t(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=i,this.type=t.type}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),LT=new xm,FT=new Vm,UT=function(t){function e(){var e=t.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new Vm,e.boundsDirty=-1,e}return _T(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),MT.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),NT.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null);var r=new DT(t,e,n,i);return this.graphicsData.push(r),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var n=new DT(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,n=0;n<e.length;++n){var i=e[n];if(i.fillStyle.visible&&(i.shape&&(i.matrix?i.matrix.applyInverse(t,LT):LT.copyFrom(t),i.shape.contains(LT.x,LT.y)))){var r=!1;if(i.holes)for(var s=0;s<i.holes.length;s++){if(i.holes[s].shape.contains(LT.x,LT.y)){r=!0;break}}if(!r)return!0}}return!1},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,n=this.graphicsData,i=null,r=null;this.batches.length>0&&(r=(i=this.batches[this.batches.length-1]).style);for(var s=this.shapeIndex;s<n.length;s++){this.shapeIndex++;var o=n[s],a=o.fillStyle,h=o.lineStyle;PT[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(a.visible||h.visible)&&this.processHoles(o.holes);for(var u=0;u<2;u++){var l=0===u?a:h;if(l.visible){var c=l.texture.baseTexture,p=this.indices.length,d=this.points.length/2;c.wrapMode=bf.REPEAT,0===u?this.processFill(o):this.processLine(o);var f=this.points.length/2-d;0!==f&&(i&&!this._compareStyles(r,l)&&(i.end(p,d),i=null),i||((i=NT.pop()||new IT).begin(l,p,d),this.batches.push(i),r=l),this.addUvs(this.points,e,l.texture,d,f,l.matrix))}}}var m=this.indices.length,_=this.points.length/2;if(i&&i.end(m,_),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var g=_>65535&&t;this.indicesUint16=g?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var n=this.graphicsData[t],i=n.fillStyle,r=n.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(r&&!r.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,n=t.length;e<n;e++)for(var i=t[e],r=0;r<i.size;r++){var s=i.start+r;this.indicesUint16[s]=this.indicesUint16[s]-i.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,n=0;n<t.length;n++)if(t[n].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++L_._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),MT.push(this.drawCalls[e]);this.drawCalls.length=0;var n=this.colors,i=this.textureIds,r=MT.pop();r||((r=new Pv).texArray=new Nv),r.texArray.count=0,r.start=0,r.size=0,r.type=_f.TRIANGLES;var s=0,o=null,a=0,h=!1,u=_f.TRIANGLES,l=0;this.drawCalls.push(r);for(e=0;e<this.batches.length;e++){var c=this.batches[e],p=c.style,d=p.texture.baseTexture;h!==!!p.native&&(u=(h=!!p.native)?_f.LINES:_f.TRIANGLES,o=null,s=8,t++),o!==d&&(o=d,d._batchEnabled!==t&&(8===s&&(t++,s=0,r.size>0&&((r=MT.pop())||((r=new Pv).texArray=new Nv),this.drawCalls.push(r)),r.start=l,r.size=0,r.texArray.count=0,r.type=u),d.touched=1,d._batchEnabled=t,d._batchLocation=s,d.wrapMode=bf.REPEAT,r.texArray.elements[r.texArray.count++]=d,s++)),r.size+=c.size,l+=c.size,a=d._batchLocation,this.addColors(n,p.color,p.alpha,c.attribSize,c.attribStart),this.addTextureIds(i,a,c.attribSize,c.attribStart)}L_._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,n=this.colors,i=this.textureIds,r=new ArrayBuffer(3*t.length*4),s=new Float32Array(r),o=new Uint32Array(r),a=0,h=0;h<t.length/2;h++)s[a++]=t[2*h],s[a++]=t[2*h+1],s[a++]=e[2*h],s[a++]=e[2*h+1],o[a++]=n[h],s[a++]=i[h];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?vT.triangulate(t,this):PT[t.type].triangulate(t,this)},e.prototype.processLine=function(t){ST(t,this);for(var e=0;e<t.holes.length;e++)ST(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var n=t[e];PT[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=FT,n=Pm.IDENTITY;this._bounds.clear(),e.clear();for(var i=0;i<this.graphicsData.length;i++){var r=this.graphicsData[i],s=r.shape,o=r.type,a=r.lineStyle,h=r.matrix||Pm.IDENTITY,u=0;if(a&&a.visible&&(u=a.width*Math.max(0,a.alignment)),n!==h&&(e.isEmpty()||(t.addBoundsMatrix(e,n),e.clear()),n=h),o===ym.RECT||o===ym.RREC){var l=s;e.addFramePad(l.x,l.y,l.x+l.width,l.y+l.height,u,u)}else if(o===ym.CIRC){var c=s;e.addFramePad(c.x,c.y,c.x,c.y,c.radius+u,c.radius+u)}else if(o===ym.ELIP){var p=s;e.addFramePad(p.x,p.y,p.x,p.y,p.width+u,p.height+u)}else{var d=s;t.addVerticesMatrix(n,d.points,0,d.points.length,u,u)}}e.isEmpty()||t.addBoundsMatrix(e,n),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var n=0;n<t.length/2;n++){var i=t[2*n],r=t[2*n+1];t[2*n]=e.a*i+e.c*r+e.tx,t[2*n+1]=e.b*i+e.d*r+e.ty}},e.prototype.addColors=function(t,e,n,i,r){void 0===r&&(r=0);var s=tm((e>>16)+(65280&e)+((255&e)<<16),n);t.length=Math.max(t.length,r+i);for(var o=0;o<i;o++)t[r+o]=s},e.prototype.addTextureIds=function(t,e,n,i){void 0===i&&(i=0),t.length=Math.max(t.length,i+n);for(var r=0;r<n;r++)t[i+r]=e},e.prototype.addUvs=function(t,e,n,i,r,s){void 0===s&&(s=null);for(var o=0,a=e.length,h=n.frame;o<r;){var u=t[2*(i+o)],l=t[2*(i+o)+1];if(s){var c=s.a*u+s.c*l+s.tx;l=s.b*u+s.d*l+s.ty,u=c}o++,e.push(u/h.width,l/h.height)}var p=n.baseTexture;(h.width<p.width||h.height<p.height)&&this.adjustUvs(e,n,a,r)},e.prototype.adjustUvs=function(t,e,n,i){for(var r=e.baseTexture,s=1e-6,o=n+2*i,a=e.frame,h=a.width/r.width,u=a.height/r.height,l=a.x/a.width,c=a.y/a.height,p=Math.floor(t[n]+s),d=Math.floor(t[n+1]+s),f=n+2;f<o;f+=2)p=Math.min(p,Math.floor(t[f]+s)),d=Math.min(d,Math.floor(t[f+1]+s));l-=p,c-=d;for(f=n;f<o;f+=2)t[f]=(t[f]+l)*h,t[f+1]=(t[f+1]+c)*u},e.BATCHABLE_SIZE=100,e}(Fv),GT=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=lT.BUTT,e.join=uT.MITER,e.miterLimit=10,e}return _T(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(fT),BT=new Float32Array(3),kT={},VT=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this)||this;return n.shader=null,n.pluginName="batch",n.currentPath=null,n.batches=[],n.batchTint=-1,n.batchDirty=-1,n.vertexData=null,n._fillStyle=new fT,n._lineStyle=new GT,n._matrix=null,n._holeMode=!1,n.state=Kg.for2d(),n._geometry=e||new UT,n._geometry.refCount++,n._transformID=-1,n.tint=16777215,n.blendMode=mf.NORMAL,n}return _T(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,e,n,i,r){return void 0===t&&(t=null),void 0===e&&(e=0),void 0===n&&(n=1),void 0===i&&(i=.5),void 0===r&&(r=!1),"number"==typeof t&&(t={width:t,color:e,alpha:n,alignment:i,native:r}),this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:K_.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:lT.BUTT,join:uT.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Cm,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Cm,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,i=n[n.length-2],r=n[n.length-1];return i===t&&r===e||n.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,n,i){this._initCurve();var r=this.currentPath.points;return 0===r.length&&this.moveTo(0,0),OT.curveTo(t,e,n,i,r),this},e.prototype.bezierCurveTo=function(t,e,n,i,r,s){return this._initCurve(),CT.curveTo(t,e,n,i,r,s,this.currentPath.points),this},e.prototype.arcTo=function(t,e,n,i,r){this._initCurve(t,e);var s=this.currentPath.points,o=RT.curveTo(t,e,n,i,r,s);if(o){var a=o.cx,h=o.cy,u=o.radius,l=o.startAngle,c=o.endAngle,p=o.anticlockwise;this.arc(a,h,u,l,c,p)}return this},e.prototype.arc=function(t,e,n,i,r,s){if(void 0===s&&(s=!1),i===r)return this;if(!s&&r<=i?r+=Tm:s&&i<=r&&(i+=Tm),0===r-i)return this;var o=t+Math.cos(i)*n,a=e+Math.sin(i)*n,h=this._geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var l=Math.abs(u[u.length-2]-o),c=Math.abs(u[u.length-1]-a);l<h&&c<h||u.push(o,a)}else this.moveTo(o,a),u=this.currentPath.points;return RT.arc(o,a,t,e,n,i,r,s,u),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:K_.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:K_.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,n,i){return this.drawShape(new Sm(t,e,n,i))},e.prototype.drawRoundedRect=function(t,e,n,i,r){return this.drawShape(new Om(t,e,n,i,r))},e.prototype.drawCircle=function(t,e,n){return this.drawShape(new wm(t,e,n))},e.prototype.drawEllipse=function(t,e,n,i){return this.drawShape(new Rm(t,e,n,i))},e.prototype.drawPolygon=function(){for(var t,e=arguments,n=[],i=0;i<arguments.length;i++)n[i]=e[i];var r=!0,s=n[0];s.points?(r=s.closeStroke,t=s.points):t=Array.isArray(n[0])?n[0]:n;var o=new Cm(t);return o.closeStroke=r,this.drawShape(o),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==ym.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var e=this._geometry,n=t.context.supports.uint32Indices;e.updateBatches(n),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(var i=0;i<n;i++){var r=t.batches[i],s=r.style.color,o=new Float32Array(this.vertexData.buffer,4*r.attribStart*2,2*r.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*r.attribStart*2,2*r.attribSize),h={vertexData:o,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*r.start,r.size),uvs:a,_batchRGB:qf(s),_tintRGB:s,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[i]=h}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,n=this.batches.length;e<n;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),n=this._geometry,i=this.tint,r=this.worldAlpha,s=e.uniforms,o=n.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(i>>16&255)/255*r,s.tint[1]=(i>>8&255)/255*r,s.tint[2]=(255&i)/255*r,s.tint[3]=r,t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(var a=0,h=o.length;a<h;a++)this._renderDrawCallDirect(t,n.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var n=e.texArray,i=e.type,r=e.size,s=e.start,o=n.count,a=0;a<o;a++)t.texture.bind(n.elements[a],a);t.geometry.draw(i,r,s)},e.prototype._resolveDirectShader=function(t){var e=this.shader,n=this.pluginName;if(!e){if(!kT[n]){for(var i=t.plugins.batch.MAX_TEXTURES,r=new Int32Array(i),s=0;s<i;s++)r[s]=s;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Pm,default:pg.from({uSamplers:r},!0)},a=t.plugins[n]._shader.program;kT[n]=new Zg(a,o)}e=kT[n]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,n=e.minX,i=e.minY,r=e.maxX,s=e.maxY;this._bounds.addFrame(this.transform,n,i,r,s)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=qf(this.tint,BT),e=0;e<this.batches.length;e++){var n=this.batches[e],i=n._batchRGB,r=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);n._tintRGB=(r>>16)+(65280&r)+((255&r)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,n=e.a,i=e.b,r=e.c,s=e.d,o=e.tx,a=e.ty,h=this._geometry.points,u=this.vertexData,l=0,c=0;c<h.length;c+=2){var p=h[c],d=h[c+1];u[l++]=n*p+r*d+o,u[l++]=s*d+i*p+a}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},e.nextRoundedRectBehavior=!1,e._TEMP_POINT=new xm,e}(p_),XT=function(t,e){return XT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},XT(t,e)};var jT,HT=new xm,$T=new Uint16Array([0,1,2,0,2,3]),WT=function(t){function e(e){var n=t.call(this)||this;return n._anchor=new Im(n._onAnchorUpdate,n,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=mf.NORMAL,n._cachedTint=16777215,n.uvs=null,n.texture=e||K_.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.indices=$T,n.pluginName="batch",n.isSprite=!0,n._roundPixels=Ad.ROUND_PIXELS,n}return function(t,e){function n(){this.constructor=t}XT(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=am(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=am(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,n=e.a,i=e.b,r=e.c,s=e.d,o=e.tx,a=e.ty,h=this.vertexData,u=t.trim,l=t.orig,c=this._anchor,p=0,d=0,f=0,m=0;if(u?(p=(d=u.x-c._x*l.width)+u.width,f=(m=u.y-c._y*l.height)+u.height):(p=(d=-c._x*l.width)+l.width,f=(m=-c._y*l.height)+l.height),h[0]=n*d+r*m+o,h[1]=s*m+i*d+a,h[2]=n*p+r*m+o,h[3]=s*m+i*p+a,h[4]=n*p+r*f+o,h[5]=s*f+i*p+a,h[6]=n*d+r*f+o,h[7]=s*f+i*d+a,this._roundPixels)for(var _=Ad.RESOLUTION,g=0;g<h.length;++g)h[g]=Math.round((h[g]*_|0)/_)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,n=t.orig,i=this._anchor,r=this.transform.worldTransform,s=r.a,o=r.b,a=r.c,h=r.d,u=r.tx,l=r.ty,c=-i._x*n.width,p=c+n.width,d=-i._y*n.height,f=d+n.height;e[0]=s*c+a*d+u,e[1]=h*d+o*c+l,e[2]=s*p+a*d+u,e[3]=h*d+o*p+l,e[4]=s*p+a*f+u,e[5]=h*f+o*p+l,e[6]=s*c+a*f+u,e[7]=h*f+o*c+l},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new Vm),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Sm),e=this._localBoundsRect),this._localBounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,HT);var e=this._texture.orig.width,n=this._texture.orig.height,i=-e*this.anchor.x,r=0;return HT.x>=i&&HT.x<i+e&&(r=-n*this.anchor.y,HT.y>=r&&HT.y<r+n)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var n="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!n)}this._texture=null},e.from=function(t,n){return new e(t instanceof K_?t:K_.from(t,n))},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=am(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=am(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||K_.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(p_),zT=function(t,e){return zT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},zT(t,e)};!function(t){t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"}(jT||(jT={}));var qT={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:jT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},ZT=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],KT=function(){function t(t){this.styleID=0,this.reset(),tE(this,t,t)}return t.prototype.clone=function(){var e={};return tE(e,this,qT),new t(e)},t.prototype.reset=function(){tE(this,qT,qT)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=QT(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=QT(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=QT(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var i=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&ZT.indexOf(i)<0&&(i='"'+i+'"'),e[n]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}();function JT(t){return"number"==typeof t?Zf(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function QT(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=JT(t[e]);return t}return JT(t)}function tE(t,e,n){for(var i in n)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i]}var eE=function(){function t(t,e,n,i,r,s,o,a,h){this.text=t,this.style=e,this.width=n,this.height=i,this.lines=r,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h}return t.measureText=function(e,n,i,r){void 0===r&&(r=t._canvas),i=null==i?n.wordWrap:i;var s=n.toFontString(),o=t.measureFont(s);0===o.fontSize&&(o.fontSize=n.fontSize,o.ascent=n.fontSize);var a=r.getContext("2d");a.font=s;for(var h=(i?t.wordWrap(e,n,r):e).split(/(?:\r\n|\r|\n)/),u=new Array(h.length),l=0,c=0;c<h.length;c++){var p=a.measureText(h[c]).width+(h[c].length-1)*n.letterSpacing;u[c]=p,l=Math.max(l,p)}var d=l+n.strokeThickness;n.dropShadow&&(d+=n.dropShadowDistance);var f=n.lineHeight||o.fontSize+n.strokeThickness,m=Math.max(f,o.fontSize+n.strokeThickness)+(h.length-1)*(f+n.leading);return n.dropShadow&&(m+=n.dropShadowDistance),new t(e,n,d,m,h,u,f+n.leading,l,o)},t.wordWrap=function(e,n,i){void 0===i&&(i=t._canvas);for(var r=i.getContext("2d"),s=0,o="",a="",h=Object.create(null),u=n.letterSpacing,l=n.whiteSpace,c=t.collapseSpaces(l),p=t.collapseNewlines(l),d=!c,f=n.wordWrapWidth+u,m=t.tokenize(e),_=0;_<m.length;_++){var g=m[_];if(t.isNewline(g)){if(!p){a+=t.addLine(o),d=!c,o="",s=0;continue}g=" "}if(c){var v=t.isBreakingSpace(g),y=t.isBreakingSpace(o[o.length-1]);if(v&&y)continue}var T=t.getFromCache(g,u,h,r);if(T>f)if(""!==o&&(a+=t.addLine(o),o="",s=0),t.canBreakWords(g,n.breakWords))for(var E=t.wordWrapSplit(g),b=0;b<E.length;b++){for(var x=E[b],A=1;E[b+A];){var S=E[b+A],w=x[x.length-1];if(t.canBreakChars(w,S,g,b,n.breakWords))break;x+=S,A++}b+=x.length-1;var R=t.getFromCache(x,u,h,r);R+s>f&&(a+=t.addLine(o),d=!1,o="",s=0),o+=x,s+=R}else{o.length>0&&(a+=t.addLine(o),o="",s=0);var C=_===m.length-1;a+=t.addLine(g,!C),d=!1,o="",s=0}else T+s>f&&(d=!1,a+=t.addLine(o),o="",s=0),(o.length>0||!t.isBreakingSpace(g)||d)&&(o+=g,s+=T)}return a+=t.addLine(o,!1)},t.addLine=function(e,n){return void 0===n&&(n=!0),e=t.trimRight(e),e=n?e+"\n":e},t.getFromCache=function(t,e,n,i){var r=n[t];if("number"!=typeof r){var s=t.length*e;r=i.measureText(t).width+s,n[t]=r}return r},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var n=e.length-1;n>=0;n--){var i=e[n];if(!t.isBreakingSpace(i))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e,n){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var n=[],i="";if("string"!=typeof e)return n;for(var r=0;r<e.length;r++){var s=e[r],o=e[r+1];t.isBreakingSpace(s,o)||t.isNewline(s)?(""!==i&&(n.push(i),i=""),n.push(s)):i+=s}return""!==i&&n.push(i),n},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,n,i,r){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var n={ascent:0,descent:0,fontSize:0},i=t._canvas,r=t._context;r.font=e;var s=t.METRICS_STRING+t.BASELINE_SYMBOL,o=Math.ceil(r.measureText(s).width),a=Math.ceil(r.measureText(t.BASELINE_SYMBOL).width),h=Math.ceil(t.HEIGHT_MULTIPLIER*a);a=a*t.BASELINE_MULTIPLIER|0,i.width=o,i.height=h,r.fillStyle="#f00",r.fillRect(0,0,o,h),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(s,0,a);var u=r.getImageData(0,0,o,h).data,l=u.length,c=4*o,p=0,d=0,f=!1;for(p=0;p<a;++p){for(var m=0;m<c;m+=4)if(255!==u[d+m]){f=!0;break}if(f)break;d+=c}for(n.ascent=a-p,d=l-c,f=!1,p=h;p>a;--p){for(m=0;m<c;m+=4)if(255!==u[d+m]){f=!0;break}if(f)break;d-=c}return n.descent=p-a,n.fontSize=n.ascent+n.descent,t._fonts[e]=n,n},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},t}(),nE=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();nE.width=nE.height=10,eE._canvas=nE,eE._context=nE.getContext("2d"),eE._fonts={},eE.METRICS_STRING="|ÉqÅ",eE.BASELINE_SYMBOL="M",eE.BASELINE_MULTIPLIER=1.4,eE.HEIGHT_MULTIPLIER=2,eE._newlines=[10,13],eE._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var iE={texture:!0,children:!1,baseTexture:!0},rE=function(t){function e(e,n,i){var r=this,s=!1;i||(i=document.createElement("canvas"),s=!0),i.width=3,i.height=3;var o=K_.from(i);return o.orig=new Sm,o.trim=new Sm,(r=t.call(this,o)||this)._ownCanvas=s,r.canvas=i,r.context=r.canvas.getContext("2d"),r._resolution=Ad.RESOLUTION,r._autoResolution=!0,r._text=null,r._style=null,r._styleListener=null,r._font="",r.text=e,r.style=n,r.localStyleID=-1,r}return function(t,e){function n(){this.constructor=t}zT(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.updateText=function(t){var n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),this.dirty||!t){this._font=this._style.toFontString();var i,r,s=this.context,o=eE.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=o.width,h=o.height,u=o.lines,l=o.lineHeight,c=o.lineWidths,p=o.maxLineWidth,d=o.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,a)+2*n.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,h)+2*n.padding)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.lineWidth=n.strokeThickness,s.textBaseline=n.textBaseline,s.lineJoin=n.lineJoin,s.miterLimit=n.miterLimit;for(var f=n.dropShadow?2:1,m=0;m<f;++m){var _=n.dropShadow&&0===m,g=_?Math.ceil(Math.max(1,h)+2*n.padding):0,v=g*this._resolution;if(_){s.fillStyle="black",s.strokeStyle="black";var y=n.dropShadowColor,T=qf("number"==typeof y?y:Kf(y)),E=n.dropShadowBlur*this._resolution,b=n.dropShadowDistance*this._resolution;s.shadowColor="rgba("+255*T[0]+","+255*T[1]+","+255*T[2]+","+n.dropShadowAlpha+")",s.shadowBlur=E,s.shadowOffsetX=Math.cos(n.dropShadowAngle)*b,s.shadowOffsetY=Math.sin(n.dropShadowAngle)*b+v}else s.fillStyle=this._generateFillStyle(n,u,o),s.strokeStyle=n.stroke,s.shadowColor="black",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;var x=(l-d.fontSize)/2;(!e.nextLineHeightBehavior||l-d.fontSize<0)&&(x=0);for(var A=0;A<u.length;A++)i=n.strokeThickness/2,r=n.strokeThickness/2+A*l+d.ascent+x,"right"===n.align?i+=p-c[A]:"center"===n.align&&(i+=(p-c[A])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(u[A],i+n.padding,r+n.padding-g,!0),n.fill&&this.drawLetterSpacing(u[A],i+n.padding,r+n.padding-g)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,n,i,r){void 0===r&&(r=!1);var s=this._style.letterSpacing,o=e.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(0===s||o)return o&&(this.context.letterSpacing=s,this.context.textLetterSpacing=s),void(r?this.context.strokeText(t,n,i):this.context.fillText(t,n,i));for(var a=n,h=Array.from?Array.from(t):t.split(""),u=this.context.measureText(t).width,l=0,c=0;c<h.length;++c){var p=h[c];r?this.context.strokeText(p,a,i):this.context.fillText(p,a,i);for(var d="",f=c+1;f<h.length;++f)d+=h[f];a+=u-(l=this.context.measureText(d).width)+s,u=l}},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=function(t){var e,n,i,r=t.width,s=t.height,o=t.getContext("2d"),a=o.getImageData(0,0,r,s).data,h=a.length,u={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(n=e/4%r,i=~~(e/4/r),null===u.top&&(u.top=i),(null===u.left||n<u.left)&&(u.left=n),(null===u.right||u.right<n)&&(u.right=n+1),(null===u.bottom||u.bottom<i)&&(u.bottom=i));return null!==u.top&&(r=u.right-u.left,s=u.bottom-u.top+1,l=o.getImageData(u.left,u.top,r,s)),{height:s,width:r,data:l}}(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var n=this._texture,i=this._style,r=i.trim?0:i.padding,s=n.baseTexture;n.trim.width=n._frame.width=t.width/this._resolution,n.trim.height=n._frame.height=t.height/this._resolution,n.trim.x=-r,n.trim.y=-r,n.orig.width=n._frame.width-2*r,n.orig.height=n._frame.height-2*r,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),n.updateUvs(),this._recursivePostUpdateTransform(),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,e,n){var i,r=t.fill;if(!Array.isArray(r))return r;if(1===r.length)return r[0];var s=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,a=this.canvas.width/this._resolution-s-2*o,h=this.canvas.height/this._resolution-s-2*o,u=r.slice(),l=t.fillGradientStops.slice();if(!l.length)for(var c=u.length+1,p=1;p<c;++p)l.push(p/c);if(u.unshift(r[0]),l.unshift(0),u.push(r[r.length-1]),l.push(1),t.fillGradientType===jT.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,o,a/2,h+o);var d=n.fontProperties.fontSize+t.strokeThickness;for(p=0;p<e.length;p++){var f=n.lineHeight*(p-1)+d,m=n.lineHeight*p,_=m;p>0&&f>m&&(_=(m+f)/2);var g=m+d,v=n.lineHeight*(p+1),y=g;p+1<e.length&&v<g&&(y=(g+v)/2);for(var T=(y-_)/h,E=0;E<u.length;E++){var b=0;b="number"==typeof l[E]?l[E]:E/u.length;var x=Math.min(1,Math.max(0,_/h+b*T));x=Number(x.toFixed(5)),i.addColorStop(x,u[E])}}}else{i=this.context.createLinearGradient(o,h/2,a+o,h/2);var A=u.length+1,S=1;for(p=0;p<u.length;p++){var w=void 0;w="number"==typeof l[p]?l[p]:S/A,i.addColorStop(w,u[p]),S++}}return i},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},iE,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=am(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=am(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof KT?t:new KT(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.nextLineHeightBehavior=!1,e.experimentalLetterSpacing=!1,e}(WT);
/*!
     * @pixi/prepare - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/prepare is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
Ad.UPLOADS_PER_FRAME=4;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var sE=function(t,e){return sE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},sE(t,e)};var oE=function(){function t(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();function aE(t,e){var n=!1;if(t&&t._textures&&t._textures.length)for(var i=0;i<t._textures.length;i++)if(t._textures[i]instanceof K_){var r=t._textures[i].baseTexture;-1===e.indexOf(r)&&(e.push(r),n=!0)}return n}function hE(t,e){if(t.baseTexture instanceof L_){var n=t.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function uE(t,e){if(t._texture&&t._texture instanceof K_){var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function lE(t,e){return e instanceof rE&&(e.updateText(!0),!0)}function cE(t,e){if(e instanceof KT){var n=e.toFontString();return eE.measureFont(n),!0}return!1}function pE(t,e){if(t instanceof rE){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function dE(t,e){return t instanceof KT&&(-1===e.indexOf(t)&&e.push(t),!0)}var fE=function(){function t(t){var e=this;this.limiter=new oE(Ad.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(pE),this.registerFindHook(dE),this.registerFindHook(aE),this.registerFindHook(hE),this.registerFindHook(uE),this.registerUploadHook(lE),this.registerUploadHook(cE)}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,__.system.addOnce(this.tick,this,d_.UTILITY))):e&&e()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)__.system.addOnce(this.tick,this,d_.UTILITY);else{this.ticking=!1;var r=this.completes.slice(0);this.completes.length=0;for(n=0,i=r.length;n<i;n++)r[n]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof p_)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},t.prototype.destroy=function(){this.ticking&&__.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();function mE(t,e){return e instanceof L_&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function _E(t,e){if(!(e instanceof VT))return!1;var n=e.geometry;e.finishPoly(),n.updateBatches();for(var i=n.batches,r=0;r<i.length;r++){var s=i[r].style.texture;s&&mE(t,s.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function gE(t,e){return t instanceof VT&&(e.push(t),!0)}var vE=function(t){function e(e){var n=t.call(this,e)||this;return n.uploadHookHelper=n.renderer,n.registerFindHook(gE),n.registerUploadHook(mE),n.registerUploadHook(_E),n}return function(t,e){function n(){this.constructor=t}sE(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(fE),yE=function(){function t(t,e,n){void 0===n&&(n=null),this._texture=t instanceof K_?t:null,this.baseTexture=t instanceof L_?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var i=this.baseTexture.resource;this.resolution=this._updateResolution(n||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return t.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,n=vm(t,null);return null===n&&(n=void 0!==e?parseFloat(e):1),1!==n&&this.baseTexture.setResolution(n),n},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var n=e,i=t.BATCH_SIZE;n-e<i&&n<this._frameKeys.length;){var r=this._frameKeys[n],s=this._frames[r],o=s.frame;if(o){var a=null,h=null,u=!1!==s.trimmed&&s.sourceSize?s.sourceSize:s.frame,l=new Sm(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);a=s.rotated?new Sm(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):new Sm(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),!1!==s.trimmed&&s.spriteSourceSize&&(h=new Sm(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new K_(this.baseTexture,a,l,h,s.rotated?2:0,s.anchor),K_.addToCache(this.textures[r],r)}n++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var n=0;n<t[e].length;n++){var i=t[e][n];this.animations[e].push(this.textures[i])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())}),0)},t.prototype.destroy=function(t){var e;for(var n in void 0===t&&(t=!1),this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},t.BATCH_SIZE=1e3,t}(),TE=function(){function t(){}return t.use=function(e,n){var i,r,s=this,o=e.name+"_image";if(e.data&&e.type===sy.TYPE.JSON&&e.data.frames&&!s.resources[o]){var a=null===(r=null===(i=e.data)||void 0===i?void 0:i.meta)||void 0===r?void 0:r.related_multi_packs;if(Array.isArray(a))for(var h=function(t){if("string"!=typeof t)return"continue";var n=t.replace(".json",""),i=$f.resolve(e.url.replace(s.baseUrl,""),t);if(s.resources[n]||Object.values(s.resources).some((function(t){return $f.format($f.parse(t.url))===i})))return"continue";var r={crossOrigin:e.crossOrigin,loadType:sy.LOAD_TYPE.XHR,xhrType:sy.XHR_RESPONSE_TYPE.JSON,parentResource:e,metadata:e.metadata};s.add(n,i,r)},u=0,l=a;u<l.length;u++){h(l[u])}var c={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},p=t.getResourcePath(e,s.baseUrl);s.add(o,p,c,(function(t){if(t.error)n(t.error);else{var i=new yE(t.texture,e.data,e.url);i.parse((function(){e.spritesheet=i,e.textures=i.textures,n()}))}}))}else n()},t.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:$f.resolve(t.url.replace(e,""),t.data.meta.image)},t}(),EE=function(t,e){return EE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},EE(t,e)};
/*!
     * @pixi/spritesheet - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/spritesheet is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */function bE(t,e){function n(){this.constructor=t}EE(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var xE=new xm;!function(t){function e(e,n,i){void 0===n&&(n=100),void 0===i&&(i=100);var r=t.call(this,e)||this;return r.tileTransform=new km,r._width=n,r._height=i,r.uvMatrix=r.texture.uvMatrix||new tv(e),r.pluginName="tilingSprite",r.uvRespectAnchor=!1,r}bE(e,t),Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,n,i)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Sm),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,xE);var e=this._width,n=this._height,i=-e*this.anchor._x;if(xE.x>=i&&xE.x<i+e){var r=-n*this.anchor._y;if(xE.y>=r&&xE.y<r+n)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,n){return new e(t instanceof K_?t:K_.from(t,n),n.width,n.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0})}(WT);var AE="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",SE=new Pm,wE=function(t){function e(e){var n=t.call(this,e)||this;return e.runners.contextChange.add(n),n.quad=new lg,n.state=Kg.for2d(),n}return bE(e,t),e.prototype.contextChange=function(){var t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Zg.from(AE,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",e),this.shader=t.context.webGLVersion>1?Zg.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",e):Zg.from(AE,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",e)},e.prototype.render=function(t){var e=this.renderer,n=this.quad,i=n.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y);var r=t.uvRespectAnchor?t.anchor.x:0,s=t.uvRespectAnchor?t.anchor.y:0;(i=n.uvs)[0]=i[6]=-r,i[1]=i[3]=-s,i[2]=i[4]=1-r,i[5]=i[7]=1-s,n.invalidate();var o=t._texture,a=o.baseTexture,h=t.tileTransform.localTransform,u=t.uvMatrix,l=a.isPowerOfTwo&&o.frame.width===a.width&&o.frame.height===a.height;l&&(a._glTextures[e.CONTEXT_UID]?l=a.wrapMode!==bf.CLAMP:a.wrapMode===bf.CLAMP&&(a.wrapMode=bf.REPEAT));var c=l?this.simpleShader:this.shader,p=o.width,d=o.height,f=t._width,m=t._height;SE.set(h.a*p/f,h.b*p/m,h.c*d/f,h.d*d/m,h.tx/f,h.ty/m),SE.invert(),l?SE.prepend(u.mapCoord):(c.uniforms.uMapCoord=u.mapCoord.toArray(!0),c.uniforms.uClampFrame=u.uClampFrame,c.uniforms.uClampOffset=u.uClampOffset),c.uniforms.uTransform=SE.toArray(!0),c.uniforms.uColor=em(t.tint,t.worldAlpha,c.uniforms.uColor,a.alphaMode),c.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),c.uniforms.uSampler=o,e.shader.bind(c),e.geometry.bind(n),this.state.blendMode=Qf(t.blendMode,a.alphaMode),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e}(gg),RE=function(t,e){return RE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},RE(t,e)};function CE(t,e){function n(){this.constructor=t}RE(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var OE=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}(),IE=new xm,PE=new Cm,NE=function(t){function e(e,n,i,r){void 0===r&&(r=_f.TRIANGLES);var s=t.call(this)||this;return s.geometry=e,s.shader=n,s.state=i||Kg.for2d(),s.drawMode=r,s.start=0,s.size=0,s.uvs=null,s.indices=null,s.vertexData=new Float32Array(1),s.vertexDirty=-1,s._transformID=-1,s._roundPixels=Ad.ROUND_PIXELS,s.batchUvs=null,s}return CE(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},set:function(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===_f.TRIANGLES&&n.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;var i=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[i]),t.plugins[i].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var i=this.transform.worldTransform,r=i.a,s=i.b,o=i.c,a=i.d,h=i.tx,u=i.ty,l=this.vertexData,c=0;c<l.length/2;c++){var p=e[2*c],d=e[2*c+1];l[2*c]=r*p+o*d+h,l[2*c+1]=s*p+a*d+u}if(this._roundPixels){var f=Ad.RESOLUTION;for(c=0;c<l.length;++c)l[c]=Math.round((l[c]*f|0)/f)}this.vertexDirty=n}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new OE(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,IE);for(var e=this.geometry.getBuffer("aVertexPosition").data,n=PE.points,i=this.geometry.getIndex().data,r=i.length,s=4===this.drawMode?3:1,o=0;o+2<r;o+=s){var a=2*i[o],h=2*i[o+1],u=2*i[o+2];if(n[0]=e[a],n[1]=e[a+1],n[2]=e[h],n[3]=e[h+1],n[4]=e[u],n[5]=e[u+1],PE.contains(IE.x,IE.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(p_),ME=function(t){function e(e,n){var i=this,r={uSampler:e,alpha:1,uTextureMatrix:Pm.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n)).uniforms&&Object.assign(r,n.uniforms),(i=t.call(this,n.program||qg.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),r)||this)._colorDirty=!1,i.uvMatrix=new tv(e),i.batchable=void 0===n.program,i.pluginName=n.pluginName,i.tint=n.tint,i.alpha=n.alpha,i}return CE(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;em(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(Zg),DE=function(t){function e(e,n,i){var r=t.call(this)||this,s=new ig(e),o=new ig(n,!0),a=new ig(i,!0,!0);return r.addAttribute("aVertexPosition",s,2,!1,yf.FLOAT).addAttribute("aTextureCoord",o,2,!1,yf.FLOAT).addIndex(a),r._updateId=-1,r}return CE(e,t),Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(hg),LE=function(t,e){return LE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},LE(t,e)};var FE=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]},UE=function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var i in e){var r=e[i].match(/^[a-z]+/gm)[0],s=e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(var a in s){var h=s[a].split("="),u=h[0],l=h[1].replace(/"/gm,""),c=parseFloat(l),p=isNaN(c)?l:c;o[u]=p}n[r].push(o)}var d=new FE;return n.info.forEach((function(t){return d.info.push({face:t.face,size:parseInt(t.size,10)})})),n.common.forEach((function(t){return d.common.push({lineHeight:parseInt(t.lineHeight,10)})})),n.page.forEach((function(t){return d.page.push({id:parseInt(t.id,10),file:t.file})})),n.char.forEach((function(t){return d.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})})),n.kerning.forEach((function(t){return d.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})})),n.distanceField.forEach((function(t){return d.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType})})),d},t}(),GE=function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new FE,n=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),r=t.getElementsByTagName("page"),s=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),a=t.getElementsByTagName("distanceField"),h=0;h<n.length;h++)e.info.push({face:n[h].getAttribute("face"),size:parseInt(n[h].getAttribute("size"),10)});for(h=0;h<i.length;h++)e.common.push({lineHeight:parseInt(i[h].getAttribute("lineHeight"),10)});for(h=0;h<r.length;h++)e.page.push({id:parseInt(r[h].getAttribute("id"),10)||0,file:r[h].getAttribute("file")});for(h=0;h<s.length;h++){var u=s[h];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(h=0;h<o.length;h++)e.kerning.push({first:parseInt(o[h].getAttribute("first"),10),second:parseInt(o[h].getAttribute("second"),10),amount:parseInt(o[h].getAttribute("amount"),10)});for(h=0;h<a.length;h++)e.distanceField.push({fieldType:a[h].getAttribute("fieldType"),distanceRange:parseInt(a[h].getAttribute("distanceRange"),10)});return e},t}(),BE=function(){function t(){}return t.test=function(t){if("string"==typeof t&&t.indexOf("<font>")>-1){var e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return GE.test(e)}return!1},t.parse=function(t){var e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return GE.parse(e)},t}(),kE=[UE,GE,BE];function VE(t){for(var e=0;e<kE.length;e++)if(kE[e].test(t))return kE[e];return null}function XE(t,e,n,i,r,s,o){var a=n.text,h=n.fontProperties;e.translate(i,r),e.scale(s,s);var u=o.strokeThickness/2,l=-o.strokeThickness/2;if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=function(t,e,n,i,r,s){var o,a=n.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];var h=n.dropShadow?n.dropShadowDistance:0,u=n.padding||0,l=t.width/i-h-2*u,c=t.height/i-h-2*u,p=a.slice(),d=n.fillGradientStops.slice();if(!d.length)for(var f=p.length+1,m=1;m<f;++m)d.push(m/f);if(p.unshift(a[0]),d.unshift(0),p.push(a[a.length-1]),d.push(1),n.fillGradientType===jT.LINEAR_VERTICAL){o=e.createLinearGradient(l/2,u,l/2,c+u);var _=0,g=(s.fontProperties.fontSize+n.strokeThickness)/c;for(m=0;m<r.length;m++)for(var v=s.lineHeight*m,y=0;y<p.length;y++){var T=v/c+("number"==typeof d[y]?d[y]:y/p.length)*g,E=Math.max(_,T);E=Math.min(E,1),o.addColorStop(E,p[y]),_=E}}else{o=e.createLinearGradient(u,c/2,l+u,c/2);var b=p.length+1,x=1;for(m=0;m<p.length;m++){var A=void 0;A="number"==typeof d[m]?d[m]:x/b,o.addColorStop(A,p[m]),x++}}return o}(t,e,o,s,[a],n),e.strokeStyle=o.stroke,o.dropShadow){var c=o.dropShadowColor,p=qf("number"==typeof c?c:Kf(c)),d=o.dropShadowBlur*s,f=o.dropShadowDistance*s;e.shadowColor="rgba("+255*p[0]+","+255*p[1]+","+255*p[2]+","+o.dropShadowAlpha+")",e.shadowBlur=d,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,l+n.lineHeight-h.descent),o.fill&&e.fillText(a,u,l+n.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function jE(t){return Array.from?Array.from(t):t.split("")}function HE(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}var $E=function(){function t(t,e,n){var i,r,s=t.info[0],o=t.common[0],a=t.page[0],h=t.distanceField[0],u=vm(a.file),l={};this._ownsTextures=n,this.font=s.face,this.size=s.size,this.lineHeight=o.lineHeight/u,this.chars={},this.pageTextures=l;for(var c=0;c<t.page.length;c++){var p=t.page[c],d=p.id,f=p.file;l[d]=e instanceof Array?e[c]:e[f],(null==h?void 0:h.fieldType)&&"none"!==h.fieldType&&(l[d].baseTexture.alphaMode=Af.NO_PREMULTIPLIED_ALPHA)}for(c=0;c<t.char.length;c++){var m=t.char[c],_=(d=m.id,m.page),g=t.char[c],v=g.x,y=g.y,T=g.width,E=g.height,b=g.xoffset,x=g.yoffset,A=g.xadvance;y/=u,T/=u,E/=u,b/=u,x/=u,A/=u;var S=new Sm((v/=u)+l[_].frame.x/u,y+l[_].frame.y/u,T,E);this.chars[d]={xOffset:b,yOffset:x,xAdvance:A,kerning:{},texture:new K_(l[_].baseTexture,S),page:_}}for(c=0;c<t.kerning.length;c++){var w=t.kerning[c],R=w.first,C=w.second,O=w.amount;R/=u,C/=u,O/=u,this.chars[C]&&(this.chars[C].kerning[R]=O)}this.distanceFieldRange=null==h?void 0:h.distanceRange,this.distanceFieldType=null!==(r=null===(i=null==h?void 0:h.fieldType)||void 0===i?void 0:i.toLowerCase())&&void 0!==r?r:"none"}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},t.install=function(e,n,i){var r;if(e instanceof FE)r=e;else{var s=VE(e);if(!s)throw new Error("Unrecognized data format for font.");r=s.parse(e)}n instanceof K_&&(n=[n]);var o=new t(r,n,i);return t.available[o.font]=o,o},t.uninstall=function(e){var n=t.available[e];if(!n)throw new Error("No font found named '"+e+"'");n.destroy(),delete t.available[e]},t.from=function(e,n,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var r=Object.assign({},t.defaultOptions,i),s=r.chars,o=r.padding,a=r.resolution,h=r.textureWidth,u=r.textureHeight,l=function(t){"string"==typeof t&&(t=[t]);for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];if(Array.isArray(r)){if(2!==r.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+r.length+".");var s=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(var a=s,h=o;a<=h;a++)e.push(String.fromCharCode(a))}else e.push.apply(e,jE(r))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(s),c=n instanceof KT?n:new KT(n),p=h,d=new FE;d.info[0]={face:c.fontFamily,size:c.fontSize},d.common[0]={lineHeight:c.fontSize};for(var f,m,_,g=0,v=0,y=0,T=[],E=0;E<l.length;E++){f||((f=document.createElement("canvas")).width=h,f.height=u,m=f.getContext("2d"),_=new L_(f,{resolution:a}),T.push(new K_(_)),d.page.push({id:T.length-1,file:""}));var b=eE.measureText(l[E],c,!1,f),x=b.width,A=Math.ceil(b.height),S=Math.ceil(("italic"===c.fontStyle?2:1)*x);if(v>=u-A*a){if(0===v)throw new Error("[BitmapFont] textureHeight "+u+"px is too small for "+c.fontSize+"px fonts");--E,f=null,m=null,_=null,v=0,g=0,y=0}else if(y=Math.max(A+b.fontProperties.descent,y),S*a+g>=p)--E,v+=y*a,v=Math.ceil(v),g=0,y=0;else{XE(f,m,b,g,v,a,c);var w=HE(b.text);d.char.push({id:w,page:T.length-1,x:g/a,y:v/a,width:S,height:A,xoffset:0,yoffset:0,xadvance:Math.ceil(x-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),g+=(S+2*o)*a,g=Math.ceil(g)}}E=0;for(var R=l.length;E<R;E++)for(var C=l[E],O=0;O<R;O++){var I=l[O],P=m.measureText(C).width,N=m.measureText(I).width,M=m.measureText(C+I).width-(P+N);M&&d.kerning.push({first:HE(C),second:HE(I),amount:M})}var D=new t(d,T,!0);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=D,D},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}(),YE=[],WE=[],zE=[];!function(t){function e(n,i){void 0===i&&(i={});var r=t.call(this)||this;r._tint=16777215;var s=Object.assign({},e.styleDefaults,i),o=s.align,a=s.tint,h=s.maxWidth,u=s.letterSpacing,l=s.fontName,c=s.fontSize;if(!$E.available[l])throw new Error('Missing BitmapFont "'+l+'"');return r._activePagesMeshData=[],r._textWidth=0,r._textHeight=0,r._align=o,r._tint=a,r._fontName=l,r._fontSize=c||$E.available[l].size,r._text=n,r._maxWidth=h,r._maxLineHeight=0,r._letterSpacing=u,r._anchor=new Im((function(){r.dirty=!0}),r,0,0),r._roundPixels=Ad.ROUND_PIXELS,r.dirty=!0,r._textureCache={},r}(function(t,e){function n(){this.constructor=t}LE(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),e.prototype.updateText=function(){for(var t,e=$E.available[this._fontName],n=this._fontSize/e.size,i=new xm,r=[],s=[],o=[],a=jE(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),h=this._maxWidth*e.size/this._fontSize,u="none"===e.distanceFieldType?YE:WE,l=null,c=0,p=0,d=0,f=-1,m=0,_=0,g=0,v=0,y=0;y<a.length;y++){var T=HE(k=a[y]);if(/(?:\s)/.test(k)&&(f=y,m=c,v++),"\r"!==k&&"\n"!==k){var E=e.chars[T];if(E){l&&E.kerning[l]&&(i.x+=E.kerning[l]);var b=zE.pop()||{texture:K_.EMPTY,line:0,charCode:0,prevSpaces:0,position:new xm};b.texture=E.texture,b.line=d,b.charCode=T,b.position.x=i.x+E.xOffset+this._letterSpacing/2,b.position.y=i.y+E.yOffset,b.prevSpaces=v,r.push(b),c=b.position.x+Math.max(E.xAdvance,E.texture.orig.width),i.x+=E.xAdvance+this._letterSpacing,g=Math.max(g,E.yOffset+E.texture.height),l=T,-1!==f&&h>0&&i.x>h&&(om(r,1+f-++_,1+y-f),y=f,f=-1,s.push(m),o.push(r.length>0?r[r.length-1].prevSpaces:0),p=Math.max(p,m),d++,i.x=0,i.y+=e.lineHeight,l=null,v=0)}}else s.push(c),o.push(-1),p=Math.max(p,c),++d,++_,i.x=0,i.y+=e.lineHeight,l=null,v=0}var x=a[a.length-1];"\r"!==x&&"\n"!==x&&(/(?:\s)/.test(x)&&(c=m),s.push(c),p=Math.max(p,c),o.push(-1));var A=[];for(y=0;y<=d;y++){var S=0;"right"===this._align?S=p-s[y]:"center"===this._align?S=(p-s[y])/2:"justify"===this._align&&(S=o[y]<0?0:(p-s[y])/o[y]),A.push(S)}var w=r.length,R={},C=[],O=this._activePagesMeshData;for(y=0;y<O.length;y++)u.push(O[y]);for(y=0;y<w;y++){var I=(X=r[y].texture).baseTexture.uid;if(!R[I]){if(!(q=u.pop())){var P=new DE,N=void 0,M=void 0;"none"===e.distanceFieldType?(N=new ME(K_.EMPTY),M=mf.NORMAL):(N=new ME(K_.EMPTY,{program:qg.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r\n\r\n}\r\n"),uniforms:{uFWidth:0}}),M=mf.NORMAL_NPM);var D=new NE(P,N);D.blendMode=M,q={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:D,vertices:null,uvs:null,indices:null}}q.index=0,q.indexCount=0,q.vertexCount=0,q.uvsCount=0,q.total=0;var L=this._textureCache;L[I]=L[I]||new K_(X.baseTexture),q.mesh.texture=L[I],q.mesh.tint=this._tint,C.push(q),R[I]=q}R[I].total++}for(y=0;y<O.length;y++)-1===C.indexOf(O[y])&&this.removeChild(O[y].mesh);for(y=0;y<C.length;y++)C[y].mesh.parent!==this&&this.addChild(C[y].mesh);for(var y in this._activePagesMeshData=C,R){var F=(q=R[y]).total;if(!((null===(t=q.indices)||void 0===t?void 0:t.length)>6*F)||q.vertices.length<2*NE.BATCHABLE_SIZE)q.vertices=new Float32Array(8*F),q.uvs=new Float32Array(8*F),q.indices=new Uint16Array(6*F);else for(var U=q.total,G=q.vertices,B=4*U*2;B<G.length;B++)G[B]=0;q.mesh.size=6*F}for(y=0;y<w;y++){var k,V=(k=r[y]).position.x+A[k.line]*("justify"===this._align?k.prevSpaces:1);this._roundPixels&&(V=Math.round(V));var X,j=V*n,H=k.position.y*n,$=R[(X=k.texture).baseTexture.uid],Y=X.frame,W=X._uvs,z=$.index++;$.indices[6*z+0]=0+4*z,$.indices[6*z+1]=1+4*z,$.indices[6*z+2]=2+4*z,$.indices[6*z+3]=0+4*z,$.indices[6*z+4]=2+4*z,$.indices[6*z+5]=3+4*z,$.vertices[8*z+0]=j,$.vertices[8*z+1]=H,$.vertices[8*z+2]=j+Y.width*n,$.vertices[8*z+3]=H,$.vertices[8*z+4]=j+Y.width*n,$.vertices[8*z+5]=H+Y.height*n,$.vertices[8*z+6]=j,$.vertices[8*z+7]=H+Y.height*n,$.uvs[8*z+0]=W.x0,$.uvs[8*z+1]=W.y0,$.uvs[8*z+2]=W.x1,$.uvs[8*z+3]=W.y1,$.uvs[8*z+4]=W.x2,$.uvs[8*z+5]=W.y2,$.uvs[8*z+6]=W.x3,$.uvs[8*z+7]=W.y3}for(var y in this._textWidth=p*n,this._textHeight=(i.y+e.lineHeight)*n,R){var q=R[y];if(0!==this.anchor.x||0!==this.anchor.y)for(var Z=0,K=this._textWidth*this.anchor.x,J=this._textHeight*this.anchor.y,Q=0;Q<q.total;Q++)q.vertices[Z++]-=K,q.vertices[Z++]-=J,q.vertices[Z++]-=K,q.vertices[Z++]-=J,q.vertices[Z++]-=K,q.vertices[Z++]-=J,q.vertices[Z++]-=K,q.vertices[Z++]-=J;this._maxLineHeight=g*n;var tt=q.mesh.geometry.getBuffer("aVertexPosition"),et=q.mesh.geometry.getBuffer("aTextureCoord"),nt=q.mesh.geometry.getIndex();tt.data=q.vertices,et.data=q.uvs,nt.data=q.indices,tt.update(),et.update(),nt.update()}for(y=0;y<r.length;y++)zE.push(r[y])},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype._render=function(e){var n=$E.available[this._fontName],i=n.distanceFieldRange,r=n.distanceFieldType,s=n.size;if("none"!==r)for(var o=this.worldTransform,a=o.a,h=o.b,u=o.c,l=o.d,c=Math.sqrt(a*a+h*h),p=Math.sqrt(u*u+l*l),d=(Math.abs(c)+Math.abs(p))/2,f=this._fontSize/s,m=0,_=this._activePagesMeshData;m<_.length;m++){_[m].mesh.shader.uniforms.uFWidth=d*i*f*e.resolution}t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!$E.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),e.prototype.destroy=function(e){var n=this._textureCache;for(var i in n){n[i].destroy(),delete n[i]}this._textureCache=null,t.prototype.destroy.call(this,e)},e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0}}(p_);var qE=function(){function t(){}return t.add=function(){sy.setExtensionXhrType("fnt",sy.XHR_RESPONSE_TYPE.TEXT)},t.use=function(e,n){var i=VE(e.data);if(i)for(var r=t.getBaseUrl(this,e),s=i.parse(e.data),o={},a=function(t){o[t.metadata.pageFile]=t.texture,Object.keys(o).length===s.page.length&&(e.bitmapFont=$E.install(s,o,!0),n())},h=0;h<s.page.length;++h){var u=s.page[h].file,l=r+u,c=!1;for(var p in this.resources){var d=this.resources[p];if(d.url===l){d.metadata.pageFile=u,d.texture?a(d):d.onAfterMiddleware.add(a),c=!0;break}}if(!c){var f={crossOrigin:e.crossOrigin,loadType:sy.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},e.metadata.imageMetadata),parentResource:e};this.add(l,f,a)}}else n()},t.getBaseUrl=function(e,n){var i=n.isDataUrl?"":t.dirname(n.url);return n.isDataUrl&&("."===i&&(i=""),e.baseUrl&&i&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(i+="/")),(i=i.replace(e.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/"),i},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},t}(),ZE=function(t,e){return ZE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},ZE(t,e)};
/*!
     * @pixi/filter-alpha - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/filter-alpha is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */!function(t){function e(e){void 0===e&&(e=1);var n=t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return n.alpha=e,n}(function(t,e){function n(){this.constructor=t}ZE(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0})}(Jg);
/*!
     * @pixi/filter-blur - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/filter-blur is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var KE=function(t,e){return KE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},KE(t,e)};function JE(t,e){function n(){this.constructor=t}KE(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var QE,tb,eb,nb,ib,rb,sb,ob,ab,hb,ub,lb,cb,pb,db,fb,mb,_b,gb,vb={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},yb=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(QE||(QE={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(tb||(tb={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(eb||(eb={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(nb||(nb={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(ib||(ib={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(rb||(rb={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(sb||(sb={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(ob||(ob={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(ab||(ab={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(hb||(hb={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(ub||(ub={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(lb||(lb={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(cb||(cb={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(pb||(pb={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(db||(db={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(fb||(fb={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(mb||(mb={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(_b||(_b={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(gb||(gb={}));var Tb=function(t){function e(e,n,i,r,s){void 0===n&&(n=8),void 0===i&&(i=4),void 0===r&&(r=Ad.FILTER_RESOLUTION),void 0===s&&(s=5);var o=this,a=function(t,e){var n,i=Math.ceil(t/2),r="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";n=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<t;o++){var a=n.replace("%index%",o.toString());s+=a=a.replace("%sampleIndex%",o-(i-1)+".0"),s+="\n"}return(r=r.replace("%blur%",s)).replace("%size%",t.toString())}(s,e),h=function(t){for(var e,n=vb[t],i=n.length,r=yb,s="",o=0;o<t;o++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o.toString());e=o,o>=i&&(e=t-o-1),s+=a=a.replace("%value%",n[e].toString()),s+="\n"}return(r=r.replace("%blur%",s)).replace("%size%",t.toString())}
/*!
     * @pixi/constants - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/constants is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */(s);return(o=t.call(this,a,h)||this).horizontal=e,o.resolution=r,o._quality=0,o.quality=i,o.blur=n,o}return JE(e,t),e.prototype.apply=function(t,e,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,n,i);else{var r=t.getFilterTexture(),s=t.renderer,o=e,a=r;this.state.blend=!1,t.applyFilter(this,o,a,pb.CLEAR);for(var h=1;h<this.passes-1;h++){t.bindAndClear(o,pb.BLIT),this.uniforms.uSampler=a;var u=a;a=o,o=u,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,n,i),t.returnFilterTexture(r)}},Object.defineProperty(e.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),e}(Jg);!function(t){function e(e,n,i,r){void 0===e&&(e=8),void 0===n&&(n=4),void 0===i&&(i=Ad.FILTER_RESOLUTION),void 0===r&&(r=5);var s=t.call(this)||this;return s.blurXFilter=new Tb(!0,e,n,i,r),s.blurYFilter=new Tb(!1,e,n,i,r),s.resolution=i,s.quality=n,s.blur=e,s.repeatEdgePixels=!1,s}JE(e,t),e.prototype.apply=function(t,e,n,i){var r=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(r&&s){var o=t.getFilterTexture();this.blurXFilter.apply(t,e,o,pb.CLEAR),this.blurYFilter.apply(t,o,n,i),t.returnFilterTexture(o)}else s?this.blurYFilter.apply(t,e,n,i):this.blurXFilter.apply(t,e,n,i)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0})}(Jg);
/*!
     * @pixi/filter-color-matrix - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/filter-color-matrix is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var Eb=function(t,e){return Eb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Eb(t,e)};var bb=function(t){function e(){var e=this,n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=t.call(this,Iv,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",n)||this).alpha=1,e}return function(t,e){function n(){this.constructor=t}Eb(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n},e.prototype._multiply=function(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.tint=function(t,e){var n=[(t>>16&255)/255,0,0,0,0,0,(t>>8&255)/255,0,0,0,0,0,(255&t)/255,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.greyscale=function(t,e){var n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var n=Math.cos(t),i=Math.sin(t),r=1/3,s=(0,Math.sqrt)(r),o=[n+(1-n)*r,r*(1-n)-s*i,r*(1-n)+s*i,0,0,r*(1-n)+s*i,n+r*(1-n),r*(1-n)-s*i,0,0,r*(1-n)-s*i,r*(1-n)+s*i,n+r*(1-n),0,0,0,0,0,1,0];this._loadMatrix(o,e)},e.prototype.contrast=function(t,e){var n=(t||0)+1,i=-.5*(n-1),r=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var n=2*t/3+1,i=-.5*(n-1),r=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,n,i,r){var s=((n=n||16770432)>>16&255)/255,o=(n>>8&255)/255,a=(255&n)/255,h=((i=i||3375104)>>16&255)/255,u=(i>>8&255)/255,l=(255&i)/255,c=[.3,.59,.11,0,0,s,o,a,t=t||.2,0,h,u,l,e=e||.15,0,s-h,o-u,a-l,0,0];this._loadMatrix(c,r)},e.prototype.night=function(t,e){var n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.predator=function(t,e){var n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(Jg);bb.prototype.grayscale=bb.prototype.greyscale;
/*!
     * @pixi/filter-displacement - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/filter-displacement is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var xb=function(t,e){return xb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},xb(t,e)};!function(t){function e(e,n){var i=this,r=new Pm;return e.renderable=!1,(i=t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,i.maskMatrix=r,null==n&&(n=20),i.scale=new xm(n,n),i}(function(t,e){function n(){this.constructor=t}xb(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),e.prototype.apply=function(t,e,n,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var r=this.maskSprite.worldTransform,s=Math.sqrt(r.a*r.a+r.b*r.b),o=Math.sqrt(r.c*r.c+r.d*r.d);0!==s&&0!==o&&(this.uniforms.rotation[0]=r.a/s,this.uniforms.rotation[1]=r.b/s,this.uniforms.rotation[2]=r.c/o,this.uniforms.rotation[3]=r.d/o),t.applyFilter(this,e,n,i)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0})}(Jg);
/*!
     * @pixi/filter-fxaa - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/filter-fxaa is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var Ab=function(t,e){return Ab=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Ab(t,e)};!function(t){function e(){return t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this}(function(t,e){function n(){this.constructor=t}Ab(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t)}(Jg);
/*!
     * @pixi/filter-noise - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/filter-noise is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var Sb=function(t,e){return Sb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Sb(t,e)};var wb,Rb,Cb,Ob,Ib,Pb,Nb,Mb,Db,Lb,Fb,Ub,Gb,Bb,kb,Vb,Xb,jb,Hb;!function(t){function e(e,n){void 0===e&&(e=.5),void 0===n&&(n=Math.random());var i=t.call(this,Iv,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return i.noise=e,i.seed=n,i}(function(t,e){function n(){this.constructor=t}Sb(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0})}(Jg),function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(wb||(wb={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(Rb||(Rb={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(Cb||(Cb={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Ob||(Ob={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Ib||(Ib={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Pb||(Pb={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Nb||(Nb={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Mb||(Mb={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(Db||(Db={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Lb||(Lb={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Fb||(Fb={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(Ub||(Ub={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Gb||(Gb={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(Bb||(Bb={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(kb||(kb={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Vb||(Vb={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Xb||(Xb={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(jb||(jb={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Hb||(Hb={}));var $b=new Pm;u_.prototype._cacheAsBitmap=!1,u_.prototype._cacheData=null,u_.prototype._cacheAsBitmapResolution=null,u_.prototype._cacheAsBitmapMultisample=jb.NONE;var Yb=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(u_.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new Yb),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),u_.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},u_.prototype._initCachedDisplayObject=function(t){var e;if(!this._cacheData||!this._cacheData.sprite){var n=this.alpha;this.alpha=1,t.batch.flush();var i=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var r=this.filters[0].padding;i.pad(r)}i.ceil(Ad.RESOLUTION);var s=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),a=t.renderTexture.destinationFrame.clone(),h=t.projection.transform,u=Q_.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:null!==(e=this.cacheAsBitmapMultisample)&&void 0!==e?e:t.multisample}),l="cacheAsBitmap_"+um();this._cacheData.textureCacheId=l,L_.addToCache(u.baseTexture,l),K_.addToCache(u,l);var c=this.transform.localTransform.copyTo($b).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:u,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=h,t.renderTexture.bind(s,o,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;var p=new WT(u);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-i.x/i.width,p.anchor.y=-i.y/i.height,p.alpha=n,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=p.containsPoint.bind(p)}},u_.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},u_.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(null,!0),n=this.alpha;this.alpha=1;var i=t.context,r=t._projTransform;e.ceil(Ad.RESOLUTION);var s=Q_.create({width:e.width,height:e.height}),o="cacheAsBitmap_"+um();this._cacheData.textureCacheId=o,L_.addToCache(s.baseTexture,o),K_.addToCache(s,o);var a=$b;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=e.x,a.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:s,clear:!0,transform:a,skipUpdateTransform:!1}),t.context=i,t._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;var h=new WT(s);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=n,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}},u_.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},u_.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},u_.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,L_.removeFromCache(this._cacheData.textureCacheId),K_.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},u_.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},
/*!
     * @pixi/mixin-get-child-by-name - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/mixin-get-child-by-name is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
u_.prototype.name=null,p_.prototype.getChildByName=function(t,e){for(var n=0,i=this.children.length;n<i;n++)if(this.children[n].name===t)return this.children[n];if(e)for(n=0,i=this.children.length;n<i;n++){if(this.children[n].getChildByName){var r=this.children[n].getChildByName(t,!0);if(r)return r}}return null},
/*!
     * @pixi/mixin-get-global-position - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/mixin-get-global-position is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
u_.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new xm),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};
/*!
     * @pixi/mesh-extras - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/mesh-extras is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var Wb=function(t,e){return Wb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Wb(t,e)};function zb(t,e){function n(){this.constructor=t}Wb(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var qb=function(t){function e(e,n,i,r){void 0===e&&(e=100),void 0===n&&(n=100),void 0===i&&(i=10),void 0===r&&(r=10);var s=t.call(this)||this;return s.segWidth=i,s.segHeight=r,s.width=e,s.height=n,s.build(),s}return zb(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],n=[],i=[],r=this.segWidth-1,s=this.segHeight-1,o=this.width/r,a=this.height/s,h=0;h<t;h++){var u=h%this.segWidth,l=h/this.segWidth|0;e.push(u*o,l*a),n.push(u/r,l/s)}var c=r*s;for(h=0;h<c;h++){var p=h%r,d=h/r|0,f=d*this.segWidth+p,m=d*this.segWidth+p+1,_=(d+1)*this.segWidth+p,g=(d+1)*this.segWidth+p+1;i.push(f,m,_,m,g,_)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(i),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(DE),Zb=function(t){function e(e,n,i){void 0===e&&(e=200),void 0===i&&(i=0);var r=t.call(this,new Float32Array(4*n.length),new Float32Array(4*n.length),new Uint16Array(6*(n.length-1)))||this;return r.points=n,r._width=e,r.textureScale=i,r.build(),r}return zb(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),i=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),n.data=new Float32Array(4*t.length),i.data=new Uint16Array(6*(t.length-1)));var r=n.data,s=i.data;r[0]=0,r[1]=0,r[2]=0,r[3]=1;for(var o=0,a=t[0],h=this._width*this.textureScale,u=t.length,l=0;l<u;l++){var c=4*l;if(this.textureScale>0){var p=a.x-t[l].x,d=a.y-t[l].y,f=Math.sqrt(p*p+d*d);a=t[l],o+=f/h}else o=l/(u-1);r[c]=o,r[c+1]=0,r[c+2]=o,r[c+3]=1}var m=0;for(l=0;l<u-1;l++){c=2*l;s[m++]=c,s[m++]=c+1,s[m++]=c+2,s[m++]=c+2,s[m++]=c+1,s[m++]=c+3}n.update(),i.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,n=t[0],i=0,r=0,s=this.buffers[0].data,o=t.length,a=0;a<o;a++){var h=t[a],u=4*a;r=-((e=a<t.length-1?t[a+1]:h).x-n.x),i=e.y-n.y;var l=Math.sqrt(i*i+r*r),c=this.textureScale>0?this.textureScale*this._width/2:this._width/2;i/=l,r/=l,i*=c,r*=c,s[u]=h.x+i,s[u+1]=h.y+r,s[u+2]=h.x-i,s[u+3]=h.y-r,n=h}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(DE);!function(t){function e(e,n,i){void 0===i&&(i=0);var r=this,s=new Zb(e.height,n,i),o=new ME(e);return i>0&&(e.baseTexture.wrapMode=bf.REPEAT),(r=t.call(this,s,o)||this).autoUpdate=!0,r}zb(e,t),e.prototype._render=function(e){var n=this.geometry;(this.autoUpdate||n._width!==this.shader.texture.height)&&(n._width=this.shader.texture.height,n.update()),t.prototype._render.call(this,e)}}(NE);var Kb=function(t){function e(e,n,i){var r=this,s=new qb(e.width,e.height,n,i),o=new ME(K_.WHITE);return(r=t.call(this,s,o)||this).texture=e,r.autoResize=!0,r}return zb(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry,e=this.shader.texture,n=e.width,i=e.height;!this.autoResize||t.width===n&&t.height===i||(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},e.prototype.destroy=function(e){this.shader.texture.off("update",this.textureUpdated,this),t.prototype.destroy.call(this,e)},e}(NE);!function(t){function e(e,n,i,r,s){void 0===e&&(e=K_.EMPTY);var o=this,a=new DE(n,i,r);a.getBuffer("aVertexPosition").static=!1;var h=new ME(e);return(o=t.call(this,a,h,null,s)||this).autoUpdate=!0,o}zb(e,t),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)}}(NE);!function(t){function e(e,n,i,r,s){void 0===n&&(n=10),void 0===i&&(i=10),void 0===r&&(r=10),void 0===s&&(s=10);var o=t.call(this,K_.WHITE,4,4)||this;return o._origWidth=e.orig.width,o._origHeight=e.orig.height,o._width=o._origWidth,o._height=o._origHeight,o._leftWidth=n,o._rightWidth=r,o._topHeight=i,o._bottomHeight=s,o.texture=e,o}zb(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,n=this._topHeight+this._bottomHeight,i=this._height>n?1:this._height/n;return Math.min(e,i)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var n=1/this._origWidth,i=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=i*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-i*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}(Kb);
/*!
     * @pixi/sprite-animated - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * @pixi/sprite-animated is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var Jb=function(t,e){return Jb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Jb(t,e)};!function(t){function e(e,n){void 0===n&&(n=!0);var i=t.call(this,e[0]instanceof K_?e[0]:e[0].texture)||this;return i._textures=null,i._durations=null,i._autoUpdate=n,i._isConnectedToTicker=!1,i.animationSpeed=1,i.loop=!0,i.updateAnchor=!1,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i._playing=!1,i._previousFrame=null,i.textures=e,i}(function(t,e){function n(){this.constructor=t}Jb(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(__.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(__.shared.add(this.update,this,d_.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){if(this._playing){var e=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];var r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())}},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var n=[],i=0;i<t.length;++i)n.push(K_.from(t[i]));return new e(n)},e.fromImages=function(t){for(var n=[],i=0;i<t.length;++i)n.push(K_.from(t[i]));return new e(n)},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof K_)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(__.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(__.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0})}(WT),
/*!
     * pixi.js - v6.3.0
     * Compiled Wed, 23 Mar 2022 18:58:56 UTC
     *
     * pixi.js is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
Ov.registerPlugin("accessibility",f_),Ov.registerPlugin("extract",qv),Ov.registerPlugin("interaction",S_),Ov.registerPlugin("particle",pT),Ov.registerPlugin("prepare",vE),Ov.registerPlugin("batch",kv),Ov.registerPlugin("tilingSprite",wE),cy.registerPlugin(qE),cy.registerPlugin(Sy),cy.registerPlugin(Hy),cy.registerPlugin(oT),cy.registerPlugin(TE),Yv.registerPlugin(g_),Yv.registerPlugin(py);const Qb="Tone is not ready",tx=t=>`Tone sound buffer ${t.type} is not loaded.`,ex=t=>`Tone music buffer ${t.supportedMusic} is not loaded.`,nx=t=>`Missing sound ${t.type} on sound assets.`,ix=t=>`Missing music ${t.supportedMusic} on sound assets.`;const rx=new Map([[xh.QUACK,new Mo("/sounds/quack.mp3")],[xh.DICE_ROLL,new Mo("/sounds/dice_roll.mp3")],[xh.ERROR,new Mo("/sounds/error.mp3")],[xh.HYPERLIKE,new Mo("/sounds/hyperlike.mp3")],[xh.SHOOT,new Mo("/sounds/shoot.mp3")],[xh.WHISTLE,new Mo("/sounds/whistle.mp3")],[xh.POUFFF,new Mo("/sounds/poufff.mp3")],[xh.APPLAUSE,new Mo("/sounds/applause.mp3")],[xh.TICK,new Mo("/sounds/tick.mp3")]]),sx=new Map([[nh.MAIN,new Mo("/music/Ken_Hamm-Buckbreak.mp3")]]),ox=new Map([[rh.BAR,"/textures/bar.png"],[rh.STOOL,"/textures/stool.png"],[rh.PLAYER,"/textures/player.png"],[rh.TABLE,"/textures/table.png"]]),ax=new Yv,hx=new class extends class{constructor(){this.drawingZone={width:18,height:18},this.offset={width:6,height:6}}relativePositionToAbsolutePosition(t,e){const n=this.retrieveScaleRatio(e);return{x:t.x*n.width+this.offset.width*n.width,y:t.y*n.height+this.offset.height*n.height}}absolutePositionToRelativePosition(t,e){const n=this.retrieveScaleRatio(e);return{width:t.x/n.width-this.offset.width/n.width,height:t.y/n.height-this.offset.height/n.height}}retrieveScaleRatio(t){return{width:t.width/this.drawingZone.width,height:t.height/this.drawingZone.height}}}{constructor(t,e,n,i){super(),this.supportedSounds=t,this.supportedMusics=e,this.pixiApplication=n,this.textureSources=i,this.pixiEntities=new Map,this.musicVolumeFader=new ma(Go(1)).toDestination(),this.soundVolumeFader=new ma(Go(1)).toDestination(),this.currentView=Z.NONE,this.toneReady=!1}changeVideoExtractVolumeLevel(t){return Mt.set(t),Promise.resolve()}unMuteMusic(){return console.log("UNMUTE",this.musicVolumeBeforeMute),void 0===this.musicVolumeBeforeMute?Promise.reject(new Error("musicVolumeBeforeMute is undefined.")):(t=>(this.musicVolumeFader.volume.value=t,this.musicVolumeBeforeMute=void 0,Promise.resolve()))(this.musicVolumeBeforeMute)}muteMusic(){return this.musicVolumeBeforeMute=this.musicVolumeFader.volume.value,console.log("MUTE",this.musicVolumeBeforeMute),this.musicVolumeFader.volume.value=Go(0),Promise.resolve()}changeVideoExtract(t){return Nt.set(t),Promise.resolve()}addingViewToDom(t){return t.appendChild(this.pixiApplication.view),Promise.resolve()}changeResolution(t){return this.resizePixiAppRenderer(this.conserveAspectRatio(t)).then((()=>this.updateInterfaceStates())).catch((t=>Promise.reject(t)))}resizePixiAppRenderer(t){return this.pixiApplication.renderer.resize(t.width,t.height),Promise.resolve()}updateInterfaceStates(){return Promise.all([...this.pixiEntities.values()].map((t=>this.updatePixiEntityGraphically(t)))).then((()=>this.pixiApplication.stage.sortChildren())).catch((t=>Promise.reject(t)))}updatePixiEntityGraphically(t){return Promise.all([this.updatePixiEntityAbsolutePosition(t),this.updatePixiEntitySize(t)]).then((()=>Promise.resolve())).catch((t=>Promise.reject(t)))}updatePixiEntitySize(t){const e=this.retrieveResolution();t.pixiSprite.width=e.width/this.drawingZone.width*t.size.width,t.pixiSprite.height=e.height/this.drawingZone.height*t.size.height}retrieveResolution(){return{width:this.pixiApplication.renderer.view.width,height:this.pixiApplication.renderer.view.height}}updatePixiEntityAbsolutePosition(t){const e=this.relativePositionToAbsolutePosition(t.position,this.retrieveResolution());return t.pixiSprite.x=e.x,t.pixiSprite.y=e.y,t.pixiSprite.zIndex=t.spriteType===rh.PLAYER?1:0,t.spriteType===rh.PLAYER&&console.log(t.position),Promise.resolve()}conserveAspectRatio(t){const e=t.width/this.drawingZone.width-t.height/this.drawingZone.height;return e>0&&(t.width=(t.width/this.drawingZone.width-Math.abs(e))*this.drawingZone.width),e<0&&(t.height=(t.height/this.drawingZone.height-Math.abs(e))*this.drawingZone.height),t}changeGamePhase(t){return Pt.set(t),Promise.resolve()}removeEntityInterfaceState(t){return this.pixiEntities.delete(t),Promise.resolve()}updateEntityInterfaceState(t,e){const n=this.pixiEntities.get(t);return(n?this.updatePixiEntity(n,e):this.createPixiEntity(t,e)).then((()=>this.pixiApplication.stage.sortChildren())).catch((t=>Promise.reject(t)))}createPixiEntity(t,e){const n=this.textureSources.get(e.spriteType);if(!n)return Promise.reject(new Error(`Missing texture for sprite type '${e.spriteType}''`));const i=this.pixiApplication.stage.addChild(WT.from(n));this.pixiEntities.set(t,{position:e.position,size:e.size,spriteType:e.spriteType,pixiSprite:i});const r=this.pixiEntities.get(t);return r?this.updatePixiEntityGraphically(r):Promise.reject(new Error((t=>`Entity id '${t} missing on pixiEntities'`)(t)))}updatePixiEntity(t,e){return t.position=e.position,t.spriteType=e.spriteType,this.updatePixiEntityGraphically(t)}disableAutoplay(){return It.set(!1),Promise.resolve()}enableAutoplay(){return It.set(!0),Promise.resolve()}changeMusicVolumeLevel(t){return this.musicVolumeFader.volume.value=Go(t/100),Ct.set(t),Promise.resolve()}changeSoundVolumeLevel(t){return this.soundVolumeFader.volume.value=Go(t/100),Ot.set(t),Promise.resolve()}load(){return console.log("Tone loading..."),Mo.loaded().then((()=>(console.log("Tone loaded."),this.toneReady=!0,console.log("Tone starting..."),Fo.resume()))).then((()=>(console.log("Tone started."),Promise.resolve()))).catch((t=>Promise.reject(t)))}playMusic(t){console.log("PLAY_MUSIC",t.supportedMusic);const e=this.supportedMusics.get(t.supportedMusic);return this.toneReady?e?e.loaded?this.onMusicReadyToPlay(t,e):Promise.reject(new Error(ex(t))):Promise.reject(new Error(ix(t))):Promise.reject(new Error(Qb))}playSound(t){console.log("PLAY_SOUND",t.type);const e=this.supportedSounds.get(t.type);return this.toneReady?e?e.loaded?this.onSoundReadyToPlay(t.type,e):Promise.reject(new Error(tx(t))):Promise.reject(new Error(nx(t))):Promise.reject(new Error(Qb))}retrieveCurrentView(){return Promise.resolve(this.currentView)}notify(t){return console.log("NOTIFY",t.message),Promise.resolve()}updateCleavage(t){return console.log("UPDATE_CLEAVAGE",t),wt.set(t),Promise.resolve()}changeView(t){return console.log("CHANGE_VIEW",t),this.currentView=t,Rt.set(t),Promise.resolve()}onMusicReadyToPlay(t,e){console.log("PLAYING_MUSIC",t.supportedMusic);const n=new Ba(e).connect(this.musicVolumeFader);return n.loop=!0,n.start(),Promise.resolve()}onSoundReadyToPlay(t,e){console.log("PLAYING_SOUND",t);return new Ba(e).connect(this.soundVolumeFader).start(),Promise.resolve()}}(rx,sx,ax,ox),ux=new class extends class{onEvents(t){return Promise.all(t.map((t=>this.onEvent(t)))).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}onEvent(t){return this.controller?this.controller.executeEvent(t):Promise.reject(new Error("Controller not configured."))}configureController(t){this.controller=t}}{sendEvents(t){return Promise.all(t.map((t=>this.sendEvent(t)))).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}sendEvent(t){return console.log("NEW EVENT",t),this.onEvent(t)}},lx={chat:new class{constructor(t,e=!1){this.eventBus=t,this.twitchClientDebug=e,this.isClientConnected=!1,this.tmiClient=null,this.channel=null}sendMessage(t){return null===this.tmiClient?Promise.reject(new Error(bl)):this.channel?this.isClientConnected?this.sendTmiMessage(this.tmiClient,this.channel,t):Promise.reject(new Error(Sl)):Promise.reject(new Error(xl(t.message)))}connect(t,e,n){const i={identity:{username:t,password:e},options:{debug:this.twitchClientDebug}},r=new Tl.Client(i);return this.tmiClient=r,this.clientEvents(),this.tmiClient.connect().then((([t,e])=>(this.isClientConnected=!0,r.join(n)))).then((t=>{console.log("channel join - promise resolved"),this.channel=n})).catch((t=>Promise.reject(t)))}sendMessageToPlayer(t){return null===this.tmiClient?Promise.reject(new Error(bl)):this.channel?this.isClientConnected?this.sendTmiMessage(this.tmiClient,this.channel,t):Promise.reject(new Error(Sl)):Promise.reject(new Error(xl(t.message)))}sendTmiMessage(t,e,n){const i=n.message.split("\n");return n instanceof Eh&&(i[0]=Il(new Eh(n.username,i[0]))),Promise.all(i.map((n=>t.say(e,n)))).then((t=>Promise.resolve())).catch((t=>Promise.reject(t)))}disconnect(){return null===this.tmiClient?Promise.reject(new Error(bl)):this.channel?this.isClientConnected?this.tmiClient.part(this.channel).then((t=>(console.info(Cl),null===this.tmiClient?Promise.reject(new Error(bl)):this.tmiClient.disconnect()))).then((([t,e])=>(console.log(Ol,"host :",t,"port :",e),this.isClientConnected=!1,this.tmiClient=null,this.channel=null,Promise.resolve()))).catch((t=>Promise.reject(t))):Promise.reject(new Error(Sl)):Promise.reject(new Error(xl("")))}isConnected(){return Promise.resolve(this.isClientConnected)}clientEvents(){if(null===this.tmiClient)throw new Error(bl);this.tmiClient.on("join",((t,e,n)=>{console.log(Pl(t,e))})),this.tmiClient.on("part",((t,e,n)=>{console.log(Nl(t,e)),this.eventBus.sendEvent(new lh(e))})),this.tmiClient.on("connected",((t,e)=>{console.log(wl(t,e))})),this.tmiClient.on("connecting",((t,e)=>{console.log(Al(t,e))})),this.tmiClient.on("disconnected",(t=>{console.log(Ol,"Reason :",t)})),this.tmiClient.on("message",((t,e,n,i)=>{console.log(Rl,{channel:t,userstate:e,message:n}),e.username&&this.sendPlayerMessageEventOnEventBus(new El(e.username,n))}))}sendPlayerMessageEventOnEventBus(t){this.eventBus.sendEvent(t)}}(ux),event:ux,interface:hx,random:new class{randomIntegerOnRange(t,e){return t=Math.ceil(t),e=Math.floor(e),Promise.resolve(Math.floor(Math.random()*(e-t+1))+t)}},date:new class{retrieveCurrentDate(){return Promise.resolve(new Date)}},globalCleavageDrawPile:new class{constructor(t,e,n){const i=`${t}://${e}${n?`:${parseInt(n).toString()}`:""}`;this.backendApiInstance=dp.create({baseURL:i}),console.log(`${this.constructor.name} with backend base url: ${i}`)}drawGlobalCleavage(){return this.backendApiInstance.get(cp.GLOBAL_CLEAVAGE_DRAWPILE_DRAW).then((t=>Promise.resolve(t.data?new Th(t.data):void 0))).catch((t=>Promise.reject(t)))}save(t){return this.backendApiInstance.post(cp.GLOBAL_CLEAVAGE_DRAWPILE_SAVE,t).then((t=>Promise.resolve(t.data))).catch((t=>Promise.reject(t)))}}("http","localhost","8080"),uuid:new class{nextId(){return Promise.resolve(Ep())}}},cx=new class{constructor(){this.videoExtracts=[],this.equalityVideoChoice="equality"}retreiveEqualityVideoExtracts(){return Promise.resolve(this.videoExtracts.filter((t=>t.choice===this.equalityVideoChoice)))}retreiveVideoExtractsByChoice(t){return Promise.resolve(this.videoExtracts.filter((e=>e.choice===t)))}hasVideoExtract(t){return Promise.resolve(this.videoExtracts.some((e=>e.choice===t)))}hasEqualityVideoExtract(){return Promise.resolve(this.videoExtracts.some((t=>t.choice===this.equalityVideoChoice)))}};cx.videoExtracts=[{choice:"Gôche",percentage:100,youtubeVideoId:"6Q5-qVUMqfQ"},{choice:"Gôche",percentage:90,youtubeVideoId:"zRunanIYOp4",startExtractSeconds:0,endExtractSeconds:8},{choice:"Gôche",percentage:80,youtubeVideoId:"BJFPfTNwILo",startExtractSeconds:68.2,endExtractSeconds:79.8},{choice:"Gôche",percentage:55,youtubeVideoId:"Fi1RkSesW-g",startExtractSeconds:45.3,endExtractSeconds:58.8},{choice:"Drouate",percentage:100,youtubeVideoId:"YBpfClfbf0Y",startExtractSeconds:240,endExtractSeconds:245},{choice:"Drouate",percentage:95,youtubeVideoId:"YBpfClfbf0Y",startExtractSeconds:340,endExtractSeconds:352.7},{choice:"Drouate",percentage:90,youtubeVideoId:"YBpfClfbf0Y",startExtractSeconds:182,endExtractSeconds:185.2},{choice:"Drouate",percentage:85,youtubeVideoId:"YBpfClfbf0Y",startExtractSeconds:591,endExtractSeconds:600},{choice:"Drouate",percentage:80,youtubeVideoId:"tab9tkIGmTQ"},{choice:"Drouate",percentage:77,youtubeVideoId:"Fi1RkSesW-g",startExtractSeconds:181.2,endExtractSeconds:190},{choice:"Drouate",percentage:78,youtubeVideoId:"Yn1aa5ICqVg",startExtractSeconds:145,endExtractSeconds:175},{choice:"Drouate",percentage:75,youtubeVideoId:"YBpfClfbf0Y",startExtractSeconds:591,endExtractSeconds:600},{choice:"equality",percentage:50,youtubeVideoId:"h_XoaD35CXE"},{choice:"equality",percentage:50,youtubeVideoId:"vSYVilGoFkU"},{choice:"equality",percentage:50,youtubeVideoId:"OIwF3y1MuHI"},{choice:"equality",percentage:50,youtubeVideoId:"NutaRBYWu6g"},{choice:"equality",percentage:50,youtubeVideoId:"RKT_zJ1oKN0",startExtractSeconds:0,endExtractSeconds:20.6},{choice:"equality",percentage:50,youtubeVideoId:"DCIQGLaWDzE"},{choice:"equality",percentage:50,youtubeVideoId:"jS8ws01T6m0"},{choice:"equality",percentage:50,youtubeVideoId:"Fi1RkSesW-g",startExtractSeconds:274,endExtractSeconds:277.2},{choice:"equality",percentage:50,youtubeVideoId:"MZPyBG-wPKY"},{choice:"equality",percentage:50,youtubeVideoId:"Fi1RkSesW-g",startExtractSeconds:362.6,endExtractSeconds:367},{choice:"equality",percentage:50,youtubeVideoId:"aPpkxg-KDik"},{choice:"equality",percentage:50,youtubeVideoId:"ZwHZki1T7So"},{choice:"equality",percentage:50,youtubeVideoId:"wV4wepiucf4"},{choice:"equality",percentage:50,youtubeVideoId:"3w5cwBrvtf4"},{choice:"equality",percentage:50,youtubeVideoId:"FpAisqJ6IZc"},{choice:"equality",percentage:50,youtubeVideoId:"Wgwp0waFRxA"},{choice:"equality",percentage:50,youtubeVideoId:"cYcRAeRHPdw",startExtractSeconds:7.95,endExtractSeconds:12.1},{choice:"Non",percentage:80,youtubeVideoId:"aEgL1yNlxRw",startExtractSeconds:103.4,endExtractSeconds:108.1},{choice:"Oh que non!",percentage:80,youtubeVideoId:"aEgL1yNlxRw",startExtractSeconds:103.4,endExtractSeconds:108.1}];const px={videoExtracts:cx,publicCleavageDrawPile:new class{constructor(){this.publicCleavages=[]}isCleavageExistByTitle(t){return Promise.resolve(this.publicCleavages.some((e=>e.title===t.title)))}addCleavage(t){return this.publicCleavages.push(t),Promise.resolve()}nextCleavage(){return Promise.resolve(this.publicCleavages.shift())}},currentCleavage:new class{hasCleavage(){return Promise.resolve(!!this.cleavage)}load(){return this.cleavage?Promise.resolve(this.cleavage):Promise.reject(new Error("Cleavage is undefined."))}save(t){return this.cleavage=t,Promise.resolve()}},player:new class{constructor(){this.currentPlayers=new Map}playerByUsername(t){const e=this.currentPlayers.get(t);return e?Promise.resolve(e):Promise.reject(new Error(`Player with username '${t}' not found.`))}hasPlayer(t){return Promise.resolve(this.currentPlayers.has(t))}loadAllPlayers(){return Promise.resolve([...this.currentPlayers.values()])}remove(t){return this.currentPlayers.delete(t.username),Promise.resolve()}save(t){return this.currentPlayers.set(t.username,t),Promise.resolve()}},autoplay:new class{constructor(){this.autoplayInterval=0}configureNextAutoPlay(t){return this.nextCleavageDate=t||void 0,Promise.resolve()}configureAutoplayInterval(t){return this.autoplayInterval=t,Promise.resolve()}retreiveAutoplayInterval(){return Promise.resolve(this.autoplayInterval)}retrieveNextAutoPlayDate(){return this.nextCleavageDate?Promise.resolve(this.nextCleavageDate):Promise.reject(new Error("next autoplay date is undefined."))}hasAutoplay(){return Promise.resolve(void 0!==this.nextCleavageDate)}},gamePhase:new class{constructor(){this.currentGamePhase=At.NONE}changeGamePhase(t){return this.currentGamePhase=t,Promise.resolve()}retrieveCurrentGamePhase(){return Promise.resolve(this.currentGamePhase)}},bar:new class{constructor(){this.availableTableStools=[],this.occupiedTableStools=new Map,this.availableBarStools=[],this.occupiedBarStools=new Map,this.tables=[],this.tableDirection=ih.RIGHT,this.bar={id:"0",position:{x:0,y:0},size:{height:0,width:0}}}addAvailableBarStool(t){return this.availableBarStools.push(t),Promise.resolve()}installBar(t){return this.bar=t,Promise.resolve()}freeBarStool(t){const e=this.occupiedBarStools.get(t);return e?(this.occupiedBarStools.delete(t),this.availableBarStools.push(e),Promise.resolve()):Promise.reject(new Error(`Occupied bar stool with user ${t} not found.`))}nextOccupiedBarStool(){const t=[...this.occupiedBarStools.keys()].at(0),e=t?this.occupiedBarStools.get(t):void 0;return t&&e?Promise.resolve({username:t,stool:e}):Promise.resolve(void 0)}retrieveTableById(t){const e=this.tables.find((e=>e.id===t));return e?Promise.resolve(e):Promise.reject(new Error(`Table with id '${t}' missing on ${this.constructor.name}`))}addAvailableTableStool(t){return this.availableTableStools.push(t),Promise.resolve()}updateTableDirection(t){return this.tableDirection=t,Promise.resolve()}retreiveTableDirection(){return Promise.resolve(this.tableDirection)}retrieveBar(){return Promise.resolve(this.bar)}retrieveTables(){return Promise.resolve(this.tables)}addTable(t){return this.tables.push(t),Promise.resolve()}setOccupiedBarStool(t,e){return this.occupiedBarStools.set(t,e),Promise.resolve()}setOccupiedTableStool(t,e){return this.occupiedTableStools.set(t,e),Promise.resolve()}nextAvailableTableStool(){const t=this.availableTableStools.shift();return t?Promise.resolve(t):Promise.reject(new Error("No table stool available."))}nextAvailableBarStool(){const t=this.availableBarStools.shift();return t?Promise.resolve(t):Promise.reject(new Error("No bar stool available."))}hasAvailableTableStool(){return Promise.resolve(this.availableTableStools.length>0)}hasAvailableBarStool(){return Promise.resolve(this.availableBarStools.length>0)}}},dx=new class{constructor(t,e){this.gateways=t,this.repositories=e}start(){return console.log("Application starting..."),this.gateways.interface.load().then((()=>{const t={videoExtract:new Nh(this.repositories.videoExtracts,this.gateways.interface,this.gateways.random),chat:new vh(this.gateways.chat,this.gateways.interface),event:new Sh(this.gateways.event),cleavage:new Ah(this.repositories.publicCleavageDrawPile,this.gateways.globalCleavageDrawPile,this.repositories.currentCleavage,this.gateways.chat,this.repositories.gamePhase),interface:new Rh(this.gateways.interface),player:new Ph(this.repositories.player,this.gateways.event),autoplay:new sh(this.repositories.autoplay,this.gateways.date),bar:new fh(this.repositories.bar,this.gateways.event,this.gateways.uuid)};this.gateways.event.configureController(new Mu(t)),St.subscribe((t=>{t&&this.gateways.event.sendEvent(t)})),St.set(new Mh),console.log("Application started.");return setInterval((()=>this.gateways.event.sendEvent(new Dh)),1e3*5),Promise.resolve()})).catch((t=>console.error(t)))}addingViewToDom(t){return this.gateways.interface.addingViewToDom(t)}changeResolution(t){return this.gateways.interface.changeResolution(t)}}(lx,px);function fx(e){let n,i,r,s,o,a,p,f;return{c(){n=c("main"),i=c("h1"),i.textContent="Le jeu du clivage",r=d(),s=c("p"),s.textContent="Un jeu open source et gratuit inspiré du jeu d'Usul et Cotentin de l'émission Mediapart - Ouvrez Les Guillemets nommé \"Le jeu du clivage\".",o=d(),a=c("h2"),a.textContent="<<< cliquer n'importe où pour lancer le jeu >>>",_(i,"class","text-no-emphasis sm:text-4xl text-lg"),_(s,"class","text-no-emphasis w-full md:w-1/2 p-3 sm:text-lg text-sm font-light"),_(a,"class","text-no-emphasis sm:text-2xl text-xs font-light animate-pulse "),_(n,"class","bg-dark-background h-full w-full flex flex-col items-center justify-evenly p-3 text-center")},m(t,l){u(t,n,l),h(n,i),h(n,r),h(n,s),h(n,o),h(n,a),p||(f=m(n,"click",e[0]),p=!0)},p:t,i:t,o:t,d(t){t&&l(n),p=!1,f()}}}function mx(t){let e=!1;const n=()=>(e=!0,dx.start().then((()=>Promise.resolve())).catch((t=>(e=!1,Promise.reject(t)))));return[()=>e?Promise.resolve():n()]}class _x extends q{constructor(t){super(),z(this,t,mx,fx,s,{})}}const gx=new Map([[xh.APPLAUSE,"Benjamin Bohec"],[xh.DICE_ROLL,"Benjamin Bohec"],[xh.ERROR,"Windows XP - Error"],[xh.HYPERLIKE,"Kaamelott - Perceval"],[xh.POUFFF,"Piff the Magic Dragon"],[xh.QUACK,"Benjamin Bohec"],[xh.SHOOT,"The Simpsons - Homer"],[xh.TICK,"Benjamin Bohec"],[xh.WHISTLE,"Benjamin Bohec"]]);function vx(e){let n,i,r,s,o,a,p,f,m,g,v,y,T,E,b,x,A,S,w,R,C,O;return r=new Et({}),o=new vt({props:{subtitle:"Credits"}}),f=new vt({props:{subtitle:"Team"}}),g=new kt({props:{text:e[0],center:!0}}),y=new vt({props:{subtitle:"Sounds"}}),E=new kt({props:{text:e[1],center:!0}}),x=new vt({props:{subtitle:"Musics"}}),S=new kt({props:{text:e[2],center:!0}}),C=new it({props:{onClick:e[3],text:"Menu Principal!"}}),{c(){n=c("main"),i=c("div"),H(r.$$.fragment),s=d(),H(o.$$.fragment),a=d(),p=c("div"),H(f.$$.fragment),m=d(),H(g.$$.fragment),v=d(),H(y.$$.fragment),T=d(),H(E.$$.fragment),b=d(),H(x.$$.fragment),A=d(),H(S.$$.fragment),w=d(),R=c("div"),H(C.$$.fragment),_(i,"class","flex flex-col w-full items-center"),_(p,"class","flex flex-col w-full items-center"),_(R,"class","flex flex-col w-full items-center"),_(n,"class","bg-dark-background h-full w-full flex flex-col justify-evenly")},m(t,e){u(t,n,e),h(n,i),$(r,i,null),h(i,s),$(o,i,null),h(n,a),h(n,p),$(f,p,null),h(p,m),$(g,p,null),h(p,v),$(y,p,null),h(p,T),$(E,p,null),h(p,b),$(x,p,null),h(p,A),$(S,p,null),h(n,w),h(n,R),$(C,R,null),O=!0},p:t,i(t){O||(V(r.$$.fragment,t),V(o.$$.fragment,t),V(f.$$.fragment,t),V(g.$$.fragment,t),V(y.$$.fragment,t),V(E.$$.fragment,t),V(x.$$.fragment,t),V(S.$$.fragment,t),V(C.$$.fragment,t),O=!0)},o(t){X(r.$$.fragment,t),X(o.$$.fragment,t),X(f.$$.fragment,t),X(g.$$.fragment,t),X(y.$$.fragment,t),X(E.$$.fragment,t),X(x.$$.fragment,t),X(S.$$.fragment,t),X(C.$$.fragment,t),O=!1},d(t){t&&l(n),Y(r),Y(o),Y(f),Y(g),Y(y),Y(E),Y(x),Y(S),Y(C)}}}function yx(t){return["Lead Developer - Benjamin Bohec",new Array(...gx).map((([t,e])=>`${t} - ${e}`)).join("<br>"),"Main Music - Ken Hamm - Buckbreak",()=>St.set(new tt(Z.MAIN_MENU))]}class Tx extends q{constructor(t){super(),z(this,t,yx,vx,s,{})}}function Ex(e){let n;return{c(){n=c("div"),_(n,"id",bx),_(n,"class","flex flex-row w-full h-full items-center justify-center")},m(t,e){u(t,n,e)},p:t,i:t,o:t,d(t){t&&l(n)}}}const bx="pixi";function xx(t){const e=()=>{const t=document.getElementById(bx),e=document.getElementById("cleavageHud"),n=document.getElementById("commandHud");t&&e&&n&&dx.changeResolution({width:window.innerWidth,height:window.innerHeight-e.clientHeight-n.clientHeight})};let n;return A((()=>{const t=document.getElementById(bx);t&&(dx.addingViewToDom(t).then((()=>e())),new ResizeObserver((t=>{n&&clearTimeout(n),n=setTimeout((()=>e()),100)})).observe(t))})),[]}class Ax extends q{constructor(t){super(),z(this,t,xx,Ex,s,{})}}function Sx(t){let e,n;return e=new vt({props:{subtitle:"Préparation du nouveau clivage"}}),{c(){H(e.$$.fragment)},m(t,i){$(e,t,i),n=!0},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){X(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function wx(t){let e,n;return e=new vt({props:{subtitle:`${t[1]}/${t[0]} joueurs ont clivés`}}),{c(){H(e.$$.fragment)},m(t,i){$(e,t,i),n=!0},p(t,n){const i={};3&n&&(i.subtitle=`${t[1]}/${t[0]} joueurs ont clivés`),e.$set(i)},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){X(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Rx(t){let e,n,i,r=t[2]===At.NEW_CLEAVAGE&&Sx(),s=t[2]===At.CLEAVING&&wx(t);return{c(){e=c("div"),r&&r.c(),n=d(),s&&s.c(),_(e,"class","flex flex-col w-full")},m(t,o){u(t,e,o),r&&r.m(e,null),h(e,n),s&&s.m(e,null),i=!0},p(t,[i]){t[2]===At.NEW_CLEAVAGE?r?4&i&&V(r,1):(r=Sx(),r.c(),V(r,1),r.m(e,n)):r&&(B(),X(r,1,1,(()=>{r=null})),k()),t[2]===At.CLEAVING?s?(s.p(t,i),4&i&&V(s,1)):(s=wx(t),s.c(),V(s,1),s.m(e,null)):s&&(B(),X(s,1,1,(()=>{s=null})),k())},i(t){i||(V(r),V(s),i=!0)},o(t){X(r),X(s),i=!1},d(t){t&&l(e),r&&r.d(),s&&s.d()}}}function Cx(t,e,n){let i;o(t,Pt,(t=>n(2,i=t)));let r,{cleaveLeftChoice:s}=e,{cleaveRightChoice:a}=e,{players:h}=e;return x((()=>{n(1,r=s.players.length+a.players.length)})),t.$$set=t=>{"cleaveLeftChoice"in t&&n(3,s=t.cleaveLeftChoice),"cleaveRightChoice"in t&&n(4,a=t.cleaveRightChoice),"players"in t&&n(0,h=t.players)},[h,r,i,s,a]}class Ox extends q{constructor(t){super(),z(this,t,Cx,Rx,s,{cleaveLeftChoice:3,cleaveRightChoice:4,players:0})}}function Ix(t){let e,n,i="Left"===t[1]&&Px(t),r="Right"===t[1]&&Nx(t);return{c(){i&&i.c(),e=d(),r&&r.c(),n=f()},m(t,s){i&&i.m(t,s),u(t,e,s),r&&r.m(t,s),u(t,n,s)},p(t,s){"Left"===t[1]?i?i.p(t,s):(i=Px(t),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null),"Right"===t[1]?r?r.p(t,s):(r=Nx(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(t){i&&i.d(t),t&&l(e),r&&r.d(t),t&&l(n)}}}function Px(t){let e,n,i,r;return{c(){e=p(t[2]),n=d(),i=p(t[3]),r=p("%")},m(t,s){u(t,e,s),u(t,n,s),u(t,i,s),u(t,r,s)},p(t,n){4&n&&v(e,t[2]),8&n&&v(i,t[3])},d(t){t&&l(e),t&&l(n),t&&l(i),t&&l(r)}}}function Nx(t){let e,n,i;return{c(){e=p(t[3]),n=p("% "),i=p(t[2])},m(t,r){u(t,e,r),u(t,n,r),u(t,i,r)},p(t,n){8&n&&v(e,t[3]),4&n&&v(i,t[2])},d(t){t&&l(e),t&&l(n),t&&l(i)}}}function Mx(t){let e;return{c(){e=p(t[2])},m(t,n){u(t,e,n)},p(t,n){4&n&&v(e,t[2])},d(t){t&&l(e)}}}function Dx(e){let n,i,r,s=e[4]===At.CLEAVING&&Ix(e),o=e[4]===At.NEW_CLEAVAGE&&Mx(e);return{c(){n=c("p"),s&&s.c(),i=d(),o&&o.c(),_(n,"class",r="p-2 font-sans font-bold "+(e[5]<33?"":e[5]<66?"rotate-3":"-rotate-3")+" break-all text-5xl text-center "+("Red"===e[0]?"text-cleave-left":"text-cleave-right"))},m(t,e){u(t,n,e),s&&s.m(n,null),h(n,i),o&&o.m(n,null)},p(t,[e]){t[4]===At.CLEAVING?s?s.p(t,e):(s=Ix(t),s.c(),s.m(n,i)):s&&(s.d(1),s=null),t[4]===At.NEW_CLEAVAGE?o?o.p(t,e):(o=Mx(t),o.c(),o.m(n,null)):o&&(o.d(1),o=null),1&e&&r!==(r="p-2 font-sans font-bold "+(t[5]<33?"":t[5]<66?"rotate-3":"-rotate-3")+" break-all text-5xl text-center "+("Red"===t[0]?"text-cleave-left":"text-cleave-right"))&&_(n,"class",r)},i:t,o:t,d(t){t&&l(n),s&&s.d(),o&&o.d()}}}function Lx(t,e,n){let i;o(t,Pt,(t=>n(4,i=t)));let{color:r}=e,{choiceType:s}=e,{choiceName:a}=e,{choicePercentageText:h}=e;const u=100*Math.random();return t.$$set=t=>{"color"in t&&n(0,r=t.color),"choiceType"in t&&n(1,s=t.choiceType),"choiceName"in t&&n(2,a=t.choiceName),"choicePercentageText"in t&&n(3,h=t.choicePercentageText)},[r,s,a,h,i,u]}class Fx extends q{constructor(t){super(),z(this,t,Lx,Dx,s,{color:0,choiceType:1,choiceName:2,choicePercentageText:3})}}function Ux(t){let e,n,i;return n=new Fx({props:{choiceName:t[0],choicePercentageText:t[3],choiceType:t[2],color:t[1]}}),{c(){e=c("div"),H(n.$$.fragment),_(e,"class","flex flex-col w-full")},m(t,r){u(t,e,r),$(n,e,null),i=!0},p(t,[e]){const i={};1&e&&(i.choiceName=t[0]),8&e&&(i.choicePercentageText=t[3]),4&e&&(i.choiceType=t[2]),2&e&&(i.color=t[1]),n.$set(i)},i(t){i||(V(n.$$.fragment,t),i=!0)},o(t){X(n.$$.fragment,t),i=!1},d(t){t&&l(e),Y(n)}}}function Gx(t,e,n){let i,{text:r=""}=e,{cleave:s}=e,{totalCleave:o}=e,{color:a}=e,{choiceType:h}=e;return x((()=>{const t=0===o?0:s/o*100;n(3,i=t%1==0?t.toString():(Math.round(100*t)/100).toFixed(2))})),t.$$set=t=>{"text"in t&&n(0,r=t.text),"cleave"in t&&n(4,s=t.cleave),"totalCleave"in t&&n(5,o=t.totalCleave),"color"in t&&n(1,a=t.color),"choiceType"in t&&n(2,h=t.choiceType)},[r,a,h,i,s,o]}class Bx extends q{constructor(t){super(),z(this,t,Gx,Ux,s,{text:0,cleave:4,totalCleave:5,color:1,choiceType:2})}}function kx(t){let e,n,i,r,s,o,a,p,f;function m(e){t[4](e)}let g={choiceType:"Left",color:"Red",cleave:t[0].players.length,totalCleave:t[3]};function v(e){t[5](e)}void 0!==t[0].name&&(g.text=t[0].name),n=new Bx({props:g}),w.push((()=>j(n,"text",m))),s=new Ox({props:{players:t[2],cleaveLeftChoice:t[0],cleaveRightChoice:t[1]}});let y={choiceType:"Right",color:"Blue",cleave:t[1].players.length,totalCleave:t[3]};return void 0!==t[1].name&&(y.text=t[1].name),a=new Bx({props:y}),w.push((()=>j(a,"text",v))),{c(){e=c("div"),H(n.$$.fragment),r=d(),H(s.$$.fragment),o=d(),H(a.$$.fragment),_(e,"class","flex w-full flex-row")},m(t,i){u(t,e,i),$(n,e,null),h(e,r),$(s,e,null),h(e,o),$(a,e,null),f=!0},p(t,[e]){const r={};1&e&&(r.cleave=t[0].players.length),8&e&&(r.totalCleave=t[3]),!i&&1&e&&(i=!0,r.text=t[0].name,N((()=>i=!1))),n.$set(r);const o={};4&e&&(o.players=t[2]),1&e&&(o.cleaveLeftChoice=t[0]),2&e&&(o.cleaveRightChoice=t[1]),s.$set(o);const h={};2&e&&(h.cleave=t[1].players.length),8&e&&(h.totalCleave=t[3]),!p&&2&e&&(p=!0,h.text=t[1].name,N((()=>p=!1))),a.$set(h)},i(t){f||(V(n.$$.fragment,t),V(s.$$.fragment,t),V(a.$$.fragment,t),f=!0)},o(t){X(n.$$.fragment,t),X(s.$$.fragment,t),X(a.$$.fragment,t),f=!1},d(t){t&&l(e),Y(n),Y(s),Y(a)}}}function Vx(t,e,n){let i,{cleaveLeftChoice:r}=e,{cleaveRightChoice:s}=e,{players:o}=e;return x((()=>{n(3,i=r.players.length+s.players.length)})),t.$$set=t=>{"cleaveLeftChoice"in t&&n(0,r=t.cleaveLeftChoice),"cleaveRightChoice"in t&&n(1,s=t.cleaveRightChoice),"players"in t&&n(2,o=t.players)},[r,s,o,i,function(e){t.$$.not_equal(r.name,e)&&(r.name=e,n(0,r))},function(e){t.$$.not_equal(s.name,e)&&(s.name=e,n(1,s))}]}class Xx extends q{constructor(t){super(),z(this,t,Vx,kx,s,{cleaveLeftChoice:0,cleaveRightChoice:1,players:2})}}function jx(e){let n,i,r,s;return n=new Et({}),r=new vt({props:{subtitle:"Préparation du nouveau clivage"}}),{c(){H(n.$$.fragment),i=d(),H(r.$$.fragment)},m(t,e){$(n,t,e),u(t,i,e),$(r,t,e),s=!0},p:t,i(t){s||(V(n.$$.fragment,t),V(r.$$.fragment,t),s=!0)},o(t){X(n.$$.fragment,t),X(r.$$.fragment,t),s=!1},d(t){Y(n,t),t&&l(i),Y(r,t)}}}function Hx(t){let e,n,i,r;return e=new Et({props:{title:t[0].title,rotate:!1}}),i=new Xx({props:{cleaveLeftChoice:t[0].leftChoice,cleaveRightChoice:t[0].rightChoice,players:t[0].players.length}}),{c(){H(e.$$.fragment),n=d(),H(i.$$.fragment)},m(t,s){$(e,t,s),u(t,n,s),$(i,t,s),r=!0},p(t,n){const r={};1&n&&(r.title=t[0].title),e.$set(r);const s={};1&n&&(s.cleaveLeftChoice=t[0].leftChoice),1&n&&(s.cleaveRightChoice=t[0].rightChoice),1&n&&(s.players=t[0].players.length),i.$set(s)},i(t){r||(V(e.$$.fragment,t),V(i.$$.fragment,t),r=!0)},o(t){X(e.$$.fragment,t),X(i.$$.fragment,t),r=!1},d(t){Y(e,t),t&&l(n),Y(i,t)}}}function $x(t){let e,n,i,r;const s=[Hx,jx],o=[];function a(t,e){return t[0]?0:1}return n=a(t),i=o[n]=s[n](t),{c(){e=c("div"),i.c(),_(e,"id","cleavageHud"),_(e,"class","flex flex-col px-2 pt-2 pb-1 w-full items-center")},m(t,i){u(t,e,i),o[n].m(e,null),r=!0},p(t,[r]){let h=n;n=a(t),n===h?o[n].p(t,r):(B(),X(o[h],1,1,(()=>{o[h]=null})),k(),i=o[n],i?i.p(t,r):(i=o[n]=s[n](t),i.c()),V(i,1),i.m(e,null))},i(t){r||(V(i),r=!0)},o(t){X(i),r=!1},d(t){t&&l(e),o[n].d()}}}function Yx(t,e,n){let i;return o(t,wt,(t=>n(0,i=t))),[i]}class Wx extends q{constructor(t){super(),z(this,t,Yx,$x,s,{})}}class zx extends J{constructor(){super(...arguments),this.eventType=K.CANCEL_CLEAVAGE}}class qx extends J{constructor(t){super(),this.autoplayMinutes=t,this.eventType=K.START_AUTOPLAY}}class Zx extends J{constructor(){super(...arguments),this.eventType=K.STOP_AUTOPLAY}}function Kx(e){let n,i,r,s;return{c(){n=c("input"),_(n,"class",i="p-1 m-2 w-1/3 "+(e[4]?"text-2xl":"text-xl")+" "+(e[5]<33?"":e[5]<66?"rotate-3":"-rotate-3")+" rounded-xl border-low-emphasis focus:border-medium-emphasis focus:ring-1 focus:ring-medium-emphasis text-no-emphasis placeholder-no-emphasis border-2 bg-dark-background font-sans text-center"),_(n,"type","number"),_(n,"min","0"),_(n,"id",e[2]),_(n,"name",e[3]),n.required=!0,_(n,"placeholder",e[1])},m(t,i){u(t,n,i),y(n,e[0]),r||(s=m(n,"input",e[6]),r=!0)},p(t,[e]){16&e&&i!==(i="p-1 m-2 w-1/3 "+(t[4]?"text-2xl":"text-xl")+" "+(t[5]<33?"":t[5]<66?"rotate-3":"-rotate-3")+" rounded-xl border-low-emphasis focus:border-medium-emphasis focus:ring-1 focus:ring-medium-emphasis text-no-emphasis placeholder-no-emphasis border-2 bg-dark-background font-sans text-center")&&_(n,"class",i),4&e&&_(n,"id",t[2]),8&e&&_(n,"name",t[3]),2&e&&_(n,"placeholder",t[1]),1&e&&g(n.value)!==t[0]&&y(n,t[0])},i:t,o:t,d(t){t&&l(n),r=!1,s()}}}function Jx(t,e,n){let{inputValue:i}=e,{placeholder:r}=e,{id:s}=e,{name:o}=e,{mainInput:a=!1}=e;const h=100*Math.random();return t.$$set=t=>{"inputValue"in t&&n(0,i=t.inputValue),"placeholder"in t&&n(1,r=t.placeholder),"id"in t&&n(2,s=t.id),"name"in t&&n(3,o=t.name),"mainInput"in t&&n(4,a=t.mainInput)},[i,r,s,o,a,h,function(){i=g(this.value),n(0,i)}]}class Qx extends q{constructor(t){super(),z(this,t,Jx,Kx,s,{inputValue:0,placeholder:1,id:2,name:3,mainInput:4})}}function tA(t){let e,n,i,r,s;function o(e){t[4](e)}let a={id:"autoPlayTime",name:"autoPlayTime",placeholder:"Auto play time"};return void 0!==t[0]&&(a.inputValue=t[0]),e=new Qx({props:a}),w.push((()=>j(e,"inputValue",o))),r=new it({props:{onClick:t[2],text:"Start Auto Play!"}}),{c(){H(e.$$.fragment),i=d(),H(r.$$.fragment)},m(t,n){$(e,t,n),u(t,i,n),$(r,t,n),s=!0},p(t,i){const r={};!n&&1&i&&(n=!0,r.inputValue=t[0],N((()=>n=!1))),e.$set(r)},i(t){s||(V(e.$$.fragment,t),V(r.$$.fragment,t),s=!0)},o(t){X(e.$$.fragment,t),X(r.$$.fragment,t),s=!1},d(t){Y(e,t),t&&l(i),Y(r,t)}}}function eA(e){let n,i;return n=new it({props:{onClick:e[3],text:"Stop Auto Play!"}}),{c(){H(n.$$.fragment)},m(t,e){$(n,t,e),i=!0},p:t,i(t){i||(V(n.$$.fragment,t),i=!0)},o(t){X(n.$$.fragment,t),i=!1},d(t){Y(n,t)}}}function nA(t){let e,n,i,r;const s=[eA,tA],o=[];function a(t,e){return t[1]?0:1}return n=a(t),i=o[n]=s[n](t),{c(){e=c("div"),i.c(),_(e,"class","flex flex-row items-end justify-end")},m(t,i){u(t,e,i),o[n].m(e,null),r=!0},p(t,[r]){let h=n;n=a(t),n===h?o[n].p(t,r):(B(),X(o[h],1,1,(()=>{o[h]=null})),k(),i=o[n],i?i.p(t,r):(i=o[n]=s[n](t),i.c()),V(i,1),i.m(e,null))},i(t){r||(V(i),r=!0)},o(t){X(i),r=!1},d(t){t&&l(e),o[n].d()}}}function iA(t,e,n){let i;o(t,It,(t=>n(1,i=t)));let r=3;const s=t=>St.set(t);return[r,i,()=>s(new qx(r)),()=>s(new Zx),function(t){r=t,n(0,r)}]}class rA extends q{constructor(t){super(),z(this,t,iA,nA,s,{})}}function sA(e){let n,i,r,s,o,a,h,p;return s=new it({props:{onClick:e[4],text:"Nouveau clivage!"}}),h=new rA({}),{c(){n=c("div"),i=d(),r=c("div"),H(s.$$.fragment),o=d(),a=c("div"),H(h.$$.fragment),_(n,"class","flex flex-col w-full items-start"),_(r,"class","flex flex-col w-full items-center"),_(a,"class","flex flex-col w-full items-end justify-end")},m(t,e){u(t,n,e),u(t,i,e),u(t,r,e),$(s,r,null),u(t,o,e),u(t,a,e),$(h,a,null),p=!0},p:t,i(t){p||(V(s.$$.fragment,t),V(h.$$.fragment,t),p=!0)},o(t){X(s.$$.fragment,t),X(h.$$.fragment,t),p=!1},d(t){t&&l(n),t&&l(i),t&&l(r),Y(s),t&&l(o),t&&l(a),Y(h)}}}function oA(t){let e,n,i,r,s,o,a,p,f,m,g,v;n=new it({props:{onClick:t[7],text:"Menu Principal!"}});let y=!t[2]&&aA(t);const T=[uA,hA],E=[];function b(t,e){return t[0].title.length>0&&t[0].leftChoice.name.length>0&&t[0].rightChoice.name.length>0?0:1}return a=b(t),p=E[a]=T[a](t),g=new rA({}),{c(){e=c("div"),H(n.$$.fragment),i=d(),r=c("div"),y&&y.c(),s=d(),o=c("div"),p.c(),f=d(),m=c("div"),H(g.$$.fragment),_(e,"class","flex flex-col w-full items-start justify-end"),_(o,"class","flex flex-row w-full items-center justify-center"),_(r,"class","flex flex-col w-full items-center"),_(m,"class","flex flex-col w-full items-end justify-end")},m(t,l){u(t,e,l),$(n,e,null),u(t,i,l),u(t,r,l),y&&y.m(r,null),h(r,s),h(r,o),E[a].m(o,null),u(t,f,l),u(t,m,l),$(g,m,null),v=!0},p(t,e){t[2]?y&&(B(),X(y,1,1,(()=>{y=null})),k()):y?(y.p(t,e),4&e&&V(y,1)):(y=aA(t),y.c(),V(y,1),y.m(r,s));let n=a;a=b(t),a===n?E[a].p(t,e):(B(),X(E[n],1,1,(()=>{E[n]=null})),k(),p=E[a],p?p.p(t,e):(p=E[a]=T[a](t),p.c()),V(p,1),p.m(o,null))},i(t){v||(V(n.$$.fragment,t),V(y),V(p),V(g.$$.fragment,t),v=!0)},o(t){X(n.$$.fragment,t),X(y),X(p),X(g.$$.fragment,t),v=!1},d(t){t&&l(e),Y(n),t&&l(i),t&&l(r),y&&y.d(),E[a].d(),t&&l(f),t&&l(m),Y(g)}}}function aA(t){let e,n,i,r,s,o,a,p,f,m;function g(e){t[8](e)}let v={id:"title",name:"title",type:"textarea",mainInput:!0,placeholder:"On clive sur quoi?"};function y(e){t[9](e)}void 0!==t[0].title&&(v.inputValue=t[0].title),e=new lt({props:v}),w.push((()=>j(e,"inputValue",g)));let T={id:"leftChoice",name:"leftChoice",placeholder:"Choix?"};function E(e){t[10](e)}void 0!==t[0].leftChoice.name&&(T.inputValue=t[0].leftChoice.name),s=new lt({props:T}),w.push((()=>j(s,"inputValue",y)));let b={id:"rightChoice",name:"rightChoice",placeholder:"Choix?"};return void 0!==t[0].rightChoice.name&&(b.inputValue=t[0].rightChoice.name),p=new lt({props:b}),w.push((()=>j(p,"inputValue",E))),{c(){H(e.$$.fragment),i=d(),r=c("div"),H(s.$$.fragment),a=d(),H(p.$$.fragment),_(r,"class","flex flex-row items-center")},m(t,n){$(e,t,n),u(t,i,n),u(t,r,n),$(s,r,null),h(r,a),$(p,r,null),m=!0},p(t,i){const r={};!n&&1&i&&(n=!0,r.inputValue=t[0].title,N((()=>n=!1))),e.$set(r);const a={};!o&&1&i&&(o=!0,a.inputValue=t[0].leftChoice.name,N((()=>o=!1))),s.$set(a);const h={};!f&&1&i&&(f=!0,h.inputValue=t[0].rightChoice.name,N((()=>f=!1))),p.$set(h)},i(t){m||(V(e.$$.fragment,t),V(s.$$.fragment,t),V(p.$$.fragment,t),m=!0)},o(t){X(e.$$.fragment,t),X(s.$$.fragment,t),X(p.$$.fragment,t),m=!1},d(t){Y(e,t),t&&l(i),t&&l(r),Y(s),Y(p)}}}function hA(e){let n,i;return n=new it({props:{onClick:e[6],size:"large",text:"🎲"}}),{c(){H(n.$$.fragment)},m(t,e){$(n,t,e),i=!0},p:t,i(t){i||(V(n.$$.fragment,t),i=!0)},o(t){X(n.$$.fragment,t),i=!1},d(t){Y(n,t)}}}function uA(e){let n,i,r,s,o,a;return n=new it({props:{onClick:e[3],text:"Let'z go!",wfull:!0}}),r=new it({props:{onClick:e[6],size:"large",text:"🎲"}}),o=new it({props:{onClick:e[5],text:"heu... non 😅",wfull:!0}}),{c(){H(n.$$.fragment),i=d(),H(r.$$.fragment),s=d(),H(o.$$.fragment)},m(t,e){$(n,t,e),u(t,i,e),$(r,t,e),u(t,s,e),$(o,t,e),a=!0},p:t,i(t){a||(V(n.$$.fragment,t),V(r.$$.fragment,t),V(o.$$.fragment,t),a=!0)},o(t){X(n.$$.fragment,t),X(r.$$.fragment,t),X(o.$$.fragment,t),a=!1},d(t){Y(n,t),t&&l(i),Y(r,t),t&&l(s),Y(o,t)}}}function lA(t){let e,n,i,r=t[1]===At.CLEAVING&&sA(t),s=t[1]===At.NEW_CLEAVAGE&&oA(t);return{c(){e=c("div"),r&&r.c(),n=d(),s&&s.c(),_(e,"id","commandHud"),_(e,"class","flex flex-row w-full px-2 pb-2 pt-1")},m(t,o){u(t,e,o),r&&r.m(e,null),h(e,n),s&&s.m(e,null),i=!0},p(t,[i]){t[1]===At.CLEAVING?r?(r.p(t,i),2&i&&V(r,1)):(r=sA(t),r.c(),V(r,1),r.m(e,n)):r&&(B(),X(r,1,1,(()=>{r=null})),k()),t[1]===At.NEW_CLEAVAGE?s?(s.p(t,i),2&i&&V(s,1)):(s=oA(t),s.c(),V(s,1),s.m(e,null)):s&&(B(),X(s,1,1,(()=>{s=null})),k())},i(t){i||(V(r),V(s),i=!0)},o(t){X(r),X(s),i=!1},d(t){t&&l(e),r&&r.d(),s&&s.d()}}}function cA(t,e,n){let i,r,s,h;o(t,St,(t=>n(11,i=t))),o(t,Pt,(t=>n(1,r=t))),o(t,wt,(t=>n(2,s=t)));const u=()=>new Th({title:"",leftChoice:{name:"Gôche",players:[]},rightChoice:{name:"Drouate",players:[]},players:[]}),l=t=>{n(0,h=u()),St.set(t)};return wt.subscribe((t=>{console.log("UPDATED CURRENT CLEAVAGE STORE"),n(0,h=t||u())})),[h,r,s,()=>l(new tu(h.title,h.leftChoice.name,h.rightChoice.name)),()=>a(St,i=new $t,i),()=>l(new zx),()=>l(new vu),()=>l(new tt(Z.MAIN_MENU)),function(e){t.$$.not_equal(h.title,e)&&(h.title=e,n(0,h))},function(e){t.$$.not_equal(h.leftChoice.name,e)&&(h.leftChoice.name=e,n(0,h))},function(e){t.$$.not_equal(h.rightChoice.name,e)&&(h.rightChoice.name=e,n(0,h))}]}class pA extends q{constructor(t){super(),z(this,t,cA,lA,s,{})}}class dA extends J{constructor(){super(...arguments),this.eventType=K.VIDEO_EXTRACT_STOP}}function fA(e){let n,i;return{c(){n=c("div"),i=c("div"),_(i,"id",mA),_(i,"class","svelte-cj40qq"),_(n,"class","flex flex-row w-full h-full items-center justify-center p-5")},m(t,e){u(t,n,e),h(n,i)},p:t,i:t,o:t,d(t){t&&l(n)}}}const mA="youtube";function _A(t,e,n){let i,r,s;o(t,St,(t=>n(1,i=t))),o(t,Mt,(t=>n(2,r=t))),o(t,Nt,(t=>n(3,s=t)));let h;const u={onReady(t){console.log("YT Player On Ready"),h=setTimeout((()=>c(t.target)),5e3),s&&l(s,t.target)},onStateChange(t){console.log(`YT Player On State Change ${t.data}`),t.data===YT.PlayerState.UNSTARTED&&(h&&clearTimeout(h),t.target.setVolume(r),t.target.playVideo()),t.data===YT.PlayerState.ENDED&&c(t.target)},onPlaybackQualityChange(t){console.log(`YT Player On Playback Quality Change ${t.data}`)},onPlaybackRateChange(t){console.log(`YT Player On Playback Rate Change ${t.data}`)},onError(t){console.log(`YT Player On Error : ${t.data}`),setTimeout((()=>c(t.target)),2e3)},onApiChange(t){console.log("YT Player On API Change")}},l=(t,e)=>{const n={videoId:t.youtubeVideoId,startSeconds:t.startExtractSeconds,endSeconds:t.endExtractSeconds};console.log(`Load video '${JSON.stringify(n)}'`),e.loadVideoById(n)},c=t=>{console.log("YT Player On Stop"),t.destroy(),a(St,i=new dA,i)},p={autoplay:0,controls:1,disablekb:1,fs:0,modestbranding:1},d=()=>new YT.Player(mA,{height:"100%",width:"100%",playerVars:p,events:u});return A((()=>{const t="https://www.youtube.com/iframe_api";(t=>[...document.getElementsByTagName("script")].some((e=>e.src===t)))(t)?d():((t,e)=>{console.log("loadYoutTubeScript");const n=document.createElement("script");n.src=t;const i=document.getElementsByTagName("script")[0];if(!i.parentNode)throw new Error(`Parent node of ${i.tagName} not found.`);i.parentNode.insertBefore(n,i),window.onYouTubeIframeAPIReady=e})(t,d)})),[]}class gA extends q{constructor(t){super(),z(this,t,_A,fA,s,{})}}function vA(t){let e,n,i,r,s,o;return e=new Wx({}),i=new Ax({}),s=new pA({}),{c(){H(e.$$.fragment),n=d(),H(i.$$.fragment),r=d(),H(s.$$.fragment)},m(t,a){$(e,t,a),u(t,n,a),$(i,t,a),u(t,r,a),$(s,t,a),o=!0},i(t){o||(V(e.$$.fragment,t),V(i.$$.fragment,t),V(s.$$.fragment,t),o=!0)},o(t){X(e.$$.fragment,t),X(i.$$.fragment,t),X(s.$$.fragment,t),o=!1},d(t){Y(e,t),t&&l(n),Y(i,t),t&&l(r),Y(s,t)}}}function yA(t){let e,n;return e=new gA({}),{c(){H(e.$$.fragment)},m(t,i){$(e,t,i),n=!0},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){X(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function TA(t){let e,n,i,r;const s=[yA,vA],o=[];function a(t,e){return t[0]===At.PLAY_VIDEO?0:1}return n=a(t),i=o[n]=s[n](t),{c(){e=c("main"),i.c(),_(e,"class","bg-dark-background h-full w-full flex flex-col justify-between")},m(t,i){u(t,e,i),o[n].m(e,null),r=!0},p(t,[r]){let h=n;n=a(t),n!==h&&(B(),X(o[h],1,1,(()=>{o[h]=null})),k(),i=o[n],i||(i=o[n]=s[n](t),i.c()),V(i,1),i.m(e,null))},i(t){r||(V(i),r=!0)},o(t){X(i),r=!1},d(t){t&&l(e),o[n].d()}}}function EA(t,e,n){let i;return o(t,Pt,(t=>n(0,i=t))),[i]}class bA extends q{constructor(t){super(),z(this,t,EA,TA,s,{})}}function xA(e){let n,i;return n=new jt({}),{c(){H(n.$$.fragment)},m(t,e){$(n,t,e),i=!0},p:t,i(t){i||(V(n.$$.fragment,t),i=!0)},o(t){X(n.$$.fragment,t),i=!1},d(t){Y(n,t)}}}function AA(e){let n,i;return n=new Tx({}),{c(){H(n.$$.fragment)},m(t,e){$(n,t,e),i=!0},p:t,i(t){i||(V(n.$$.fragment,t),i=!0)},o(t){X(n.$$.fragment,t),i=!1},d(t){Y(n,t)}}}function SA(e){let n,i;return n=new ie({}),{c(){H(n.$$.fragment)},m(t,e){$(n,t,e),i=!0},p:t,i(t){i||(V(n.$$.fragment,t),i=!0)},o(t){X(n.$$.fragment,t),i=!1},d(t){Y(n,t)}}}function wA(e){let n,i;return n=new _x({}),{c(){H(n.$$.fragment)},m(t,e){$(n,t,e),i=!0},p:t,i(t){i||(V(n.$$.fragment,t),i=!0)},o(t){X(n.$$.fragment,t),i=!1},d(t){Y(n,t)}}}function RA(e){let n,i;return n=new zt({}),{c(){H(n.$$.fragment)},m(t,e){$(n,t,e),i=!0},p:t,i(t){i||(V(n.$$.fragment,t),i=!0)},o(t){X(n.$$.fragment,t),i=!1},d(t){Y(n,t)}}}function CA(e){let n,i;return n=new bA({}),{c(){H(n.$$.fragment)},m(t,e){$(n,t,e),i=!0},p:t,i(t){i||(V(n.$$.fragment,t),i=!0)},o(t){X(n.$$.fragment,t),i=!1},d(t){Y(n,t)}}}function OA(e){let n,i;return n=new Ut({}),{c(){H(n.$$.fragment)},m(t,e){$(n,t,e),i=!0},p:t,i(t){i||(V(n.$$.fragment,t),i=!0)},o(t){X(n.$$.fragment,t),i=!1},d(t){Y(n,t)}}}function IA(e){let n,i,r,s;const o=[DA,MA,NA,PA],a=[];return~(n=function(t,e){return t[1]===Z.CONNECT_CHAT?0:t[1]===Z.GAME?1:t[1]===Z.SETTINGS?2:t[1]===Z.ABOUT?3:-1}(e))&&(i=a[n]=o[n](e)),{c(){i&&i.c(),r=f()},m(t,e){~n&&a[n].m(t,e),u(t,r,e),s=!0},p:t,i(t){s||(V(i),s=!0)},o(t){X(i),s=!1},d(t){~n&&a[n].d(t),t&&l(r)}}}function PA(t){let e,n;return e=new jt({}),{c(){H(e.$$.fragment)},m(t,i){$(e,t,i),n=!0},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){X(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function NA(t){let e,n;return e=new ie({}),{c(){H(e.$$.fragment)},m(t,i){$(e,t,i),n=!0},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){X(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function MA(t){let e,n;return e=new bA({}),{c(){H(e.$$.fragment)},m(t,i){$(e,t,i),n=!0},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){X(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function DA(t){let e,n;return e=new Ut({}),{c(){H(e.$$.fragment)},m(t,i){$(e,t,i),n=!0},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){X(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function LA(t){let e,n,i,r;const s=[IA,OA,CA,RA,wA,SA,AA,xA],o=[];function a(t,e){return t[1]?0:t[0]===Z.CONNECT_CHAT?1:t[0]===Z.GAME?2:t[0]===Z.MAIN_MENU?3:t[0]===Z.INTRO?4:t[0]===Z.SETTINGS?5:t[0]===Z.CREDITS?6:t[0]===Z.ABOUT?7:-1}return~(e=a(t))&&(n=o[e]=s[e](t)),{c(){n&&n.c(),i=f()},m(t,n){~e&&o[e].m(t,n),u(t,i,n),r=!0},p(t,[r]){let h=e;e=a(t),e===h?~e&&o[e].p(t,r):(n&&(B(),X(o[h],1,1,(()=>{o[h]=null})),k()),~e?(n=o[e],n?n.p(t,r):(n=o[e]=s[e](t),n.c()),V(n,1),n.m(i.parentNode,i)):n=null)},i(t){r||(V(n),r=!0)},o(t){X(n),r=!1},d(t){~e&&o[e].d(t),t&&l(i)}}}function FA(t,e,n){let i,r,s;var h;return o(t,St,(t=>n(2,i=t))),o(t,Rt,(t=>n(0,r=t))),Rt.set(Z.INTRO),h=()=>a(St,i=new Ht,i),b().$$.on_destroy.push(h),[r,s]}return new class extends q{constructor(t){super(),z(this,t,FA,LA,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
